
<html>
<head>
    <meta charset="utf-8">
    <style>
        @page {
            size: A4;
            margin: 1in;
            @bottom-center {
                content: "Page " counter(page);
                font-size: 8pt;
                color: #555;
            }
            @top-center {
                content: "CSES Problem Set";
                font-size: 9pt;
                color: #000;
            }
        }
        body {
            font-family: sans-serif;
            font-size: 9pt;
            color: #000;
        }
        h1 {
            color: #333;
            font-size: 12pt;
            margin-bottom: 10px;
        }
        ul {
            font-size: 9pt;
        }
        .problem {
            font-size: 8pt;
            max-height: 45vh;
            overflow: hidden;
        }
        .solution-space {
            margin-top: 180px;
            height: 50vh;
            border-top: 1px dashed #aaa;
        }
        .blank-page {
            height: 100vh;
        }
        svg {
            vertical-align: middle;
            height: 1em;
        }
        a {
            text-decoration: none;
            color: blue;
        }
    </style>
</head>
<body>
<h1>Table of Contents</h1><ul><li><a href="#problem1">1. Weird Algorithm</a></li><li><a href="#problem2">2. Missing Number</a></li><li><a href="#problem3">3. Repetitions</a></li><li><a href="#problem4">4. Increasing Array</a></li><li><a href="#problem5">5. Permutations</a></li><li><a href="#problem6">6. Number Spiral</a></li><li><a href="#problem7">7. Two Knights</a></li><li><a href="#problem8">8. Two Sets</a></li><li><a href="#problem9">9. Bit Strings</a></li><li><a href="#problem10">10. Trailing Zeros</a></li><li><a href="#problem11">11. Coin Piles</a></li><li><a href="#problem12">12. Palindrome Reorder</a></li><li><a href="#problem13">13. Gray Code</a></li><li><a href="#problem14">14. Tower of Hanoi</a></li><li><a href="#problem15">15. Creating Strings</a></li><li><a href="#problem16">16. Apple Division</a></li><li><a href="#problem17">17. Chessboard and Queens</a></li><li><a href="#problem18">18. Digit Queries</a></li><li><a href="#problem19">19. Grid Paths</a></li><li><a href="#problem20">20. Distinct Numbers</a></li><li><a href="#problem21">21. Apartments</a></li><li><a href="#problem22">22. Ferris Wheel</a></li><li><a href="#problem23">23. Concert Tickets</a></li><li><a href="#problem24">24. Restaurant Customers</a></li><li><a href="#problem25">25. Movie Festival</a></li><li><a href="#problem26">26. Sum of Two Values</a></li><li><a href="#problem27">27. Maximum Subarray Sum</a></li><li><a href="#problem28">28. Stick Lengths</a></li><li><a href="#problem29">29. Missing Coin Sum</a></li><li><a href="#problem30">30. Collecting Numbers</a></li><li><a href="#problem31">31. Collecting Numbers II</a></li><li><a href="#problem32">32. Playlist</a></li><li><a href="#problem33">33. Towers</a></li><li><a href="#problem34">34. Traffic Lights</a></li><li><a href="#problem35">35. Josephus Problem I</a></li><li><a href="#problem36">36. Josephus Problem II</a></li><li><a href="#problem37">37. Nested Ranges Check</a></li><li><a href="#problem38">38. Nested Ranges Count</a></li><li><a href="#problem39">39. Room Allocation</a></li><li><a href="#problem40">40. Factory Machines</a></li><li><a href="#problem41">41. Tasks and Deadlines</a></li><li><a href="#problem42">42. Reading Books</a></li><li><a href="#problem43">43. Sum of Three Values</a></li><li><a href="#problem44">44. Sum of Four Values</a></li><li><a href="#problem45">45. Nearest Smaller Values</a></li><li><a href="#problem46">46. Subarray Sums I</a></li><li><a href="#problem47">47. Subarray Sums II</a></li><li><a href="#problem48">48. Subarray Divisibility</a></li><li><a href="#problem49">49. Subarray Distinct Values</a></li><li><a href="#problem50">50. Array Division</a></li><li><a href="#problem51">51. Sliding Window Median</a></li><li><a href="#problem52">52. Sliding Window Cost</a></li><li><a href="#problem53">53. Movie Festival II</a></li><li><a href="#problem54">54. Maximum Subarray Sum II</a></li><li><a href="#problem55">55. Dice Combinations</a></li><li><a href="#problem56">56. Minimizing Coins</a></li><li><a href="#problem57">57. Coin Combinations I</a></li><li><a href="#problem58">58. Coin Combinations II</a></li><li><a href="#problem59">59. Removing Digits</a></li><li><a href="#problem60">60. Grid Paths</a></li><li><a href="#problem61">61. Book Shop</a></li><li><a href="#problem62">62. Array Description</a></li><li><a href="#problem63">63. Counting Towers</a></li><li><a href="#problem64">64. Edit Distance</a></li><li><a href="#problem65">65. Rectangle Cutting</a></li><li><a href="#problem66">66. Money Sums</a></li><li><a href="#problem67">67. Removal Game</a></li><li><a href="#problem68">68. Two Sets II</a></li><li><a href="#problem69">69. Increasing Subsequence</a></li><li><a href="#problem70">70. Projects</a></li><li><a href="#problem71">71. Elevator Rides</a></li><li><a href="#problem72">72. Counting Tilings</a></li><li><a href="#problem73">73. Counting Numbers</a></li><li><a href="#problem74">74. Counting Rooms</a></li><li><a href="#problem75">75. Labyrinth</a></li><li><a href="#problem76">76. Building Roads</a></li><li><a href="#problem77">77. Message Route</a></li><li><a href="#problem78">78. Building Teams</a></li><li><a href="#problem79">79. Round Trip</a></li><li><a href="#problem80">80. Monsters</a></li><li><a href="#problem81">81. Shortest Routes I</a></li><li><a href="#problem82">82. Shortest Routes II</a></li><li><a href="#problem83">83. High Score</a></li><li><a href="#problem84">84. Flight Discount</a></li><li><a href="#problem85">85. Cycle Finding</a></li><li><a href="#problem86">86. Flight Routes</a></li><li><a href="#problem87">87. Round Trip II</a></li><li><a href="#problem88">88. Course Schedule</a></li><li><a href="#problem89">89. Longest Flight Route</a></li><li><a href="#problem90">90. Game Routes</a></li><li><a href="#problem91">91. Investigation</a></li><li><a href="#problem92">92. Planets Queries I</a></li><li><a href="#problem93">93. Planets Queries II</a></li><li><a href="#problem94">94. Planets Cycles</a></li><li><a href="#problem95">95. Road Reparation</a></li><li><a href="#problem96">96. Road Construction</a></li><li><a href="#problem97">97. Flight Routes Check</a></li><li><a href="#problem98">98. Planets and Kingdoms</a></li><li><a href="#problem99">99. Giant Pizza</a></li><li><a href="#problem100">100. Coin Collector</a></li><li><a href="#problem101">101. Mail Delivery</a></li><li><a href="#problem102">102. De Bruijn Sequence</a></li><li><a href="#problem103">103. Teleporters Path</a></li><li><a href="#problem104">104. Hamiltonian Flights</a></li><li><a href="#problem105">105. Knight's Tour</a></li><li><a href="#problem106">106. Download Speed</a></li><li><a href="#problem107">107. Police Chase</a></li><li><a href="#problem108">108. School Dance</a></li><li><a href="#problem109">109. Distinct Routes</a></li><li><a href="#problem110">110. Static Range Sum Queries</a></li><li><a href="#problem111">111. Static Range Minimum Queries</a></li><li><a href="#problem112">112. Dynamic Range Sum Queries</a></li><li><a href="#problem113">113. Dynamic Range Minimum Queries</a></li><li><a href="#problem114">114. Range Xor Queries</a></li><li><a href="#problem115">115. Range Update Queries</a></li><li><a href="#problem116">116. Forest Queries</a></li><li><a href="#problem117">117. Hotel Queries</a></li><li><a href="#problem118">118. List Removals</a></li><li><a href="#problem119">119. Salary Queries</a></li><li><a href="#problem120">120. Prefix Sum Queries</a></li><li><a href="#problem121">121. Pizzeria Queries</a></li><li><a href="#problem122">122. Subarray Sum Queries</a></li><li><a href="#problem123">123. Distinct Values Queries</a></li><li><a href="#problem124">124. Increasing Array Queries</a></li><li><a href="#problem125">125. Forest Queries II</a></li><li><a href="#problem126">126. Range Updates and Sums</a></li><li><a href="#problem127">127. Polynomial Queries</a></li><li><a href="#problem128">128. Range Queries and Copies</a></li><li><a href="#problem129">129. Subordinates</a></li><li><a href="#problem130">130. Tree Matching</a></li><li><a href="#problem131">131. Tree Diameter</a></li><li><a href="#problem132">132. Tree Distances I</a></li><li><a href="#problem133">133. Tree Distances II</a></li><li><a href="#problem134">134. Company Queries I</a></li><li><a href="#problem135">135. Company Queries II</a></li><li><a href="#problem136">136. Distance Queries</a></li><li><a href="#problem137">137. Counting Paths</a></li><li><a href="#problem138">138. Subtree Queries</a></li><li><a href="#problem139">139. Path Queries</a></li><li><a href="#problem140">140. Path Queries II</a></li><li><a href="#problem141">141. Distinct Colors</a></li><li><a href="#problem142">142. Finding a Centroid</a></li><li><a href="#problem143">143. Fixed-Length Paths I</a></li><li><a href="#problem144">144. Fixed-Length Paths II</a></li><li><a href="#problem145">145. Josephus Queries</a></li><li><a href="#problem146">146. Exponentiation</a></li><li><a href="#problem147">147. Exponentiation II</a></li><li><a href="#problem148">148. Counting Divisors</a></li><li><a href="#problem149">149. Common Divisors</a></li><li><a href="#problem150">150. Sum of Divisors</a></li><li><a href="#problem151">151. Divisor Analysis</a></li><li><a href="#problem152">152. Prime Multiples</a></li><li><a href="#problem153">153. Counting Coprime Pairs</a></li><li><a href="#problem154">154. Binomial Coefficients</a></li><li><a href="#problem155">155. Creating Strings II</a></li><li><a href="#problem156">156. Distributing Apples</a></li><li><a href="#problem157">157. Christmas Party</a></li><li><a href="#problem158">158. Bracket Sequences I</a></li><li><a href="#problem159">159. Bracket Sequences II</a></li><li><a href="#problem160">160. Counting Necklaces</a></li><li><a href="#problem161">161. Counting Grids</a></li><li><a href="#problem162">162. Fibonacci Numbers</a></li><li><a href="#problem163">163. Throwing Dice</a></li><li><a href="#problem164">164. Graph Paths I</a></li><li><a href="#problem165">165. Graph Paths II</a></li><li><a href="#problem166">166. Dice Probability</a></li><li><a href="#problem167">167. Moving Robots</a></li><li><a href="#problem168">168. Candy Lottery</a></li><li><a href="#problem169">169. Inversion Probability</a></li><li><a href="#problem170">170. Stick Game</a></li><li><a href="#problem171">171. Nim Game I</a></li><li><a href="#problem172">172. Nim Game II</a></li><li><a href="#problem173">173. Stair Game</a></li><li><a href="#problem174">174. Grundy's Game</a></li><li><a href="#problem175">175. Another Game</a></li><li><a href="#problem176">176. Word Combinations</a></li><li><a href="#problem177">177. String Matching</a></li><li><a href="#problem178">178. Finding Borders</a></li><li><a href="#problem179">179. Finding Periods</a></li><li><a href="#problem180">180. Minimal Rotation</a></li><li><a href="#problem181">181. Longest Palindrome</a></li><li><a href="#problem182">182. Required Substring</a></li><li><a href="#problem183">183. Palindrome Queries</a></li><li><a href="#problem184">184. Finding Patterns</a></li><li><a href="#problem185">185. Counting Patterns</a></li><li><a href="#problem186">186. Pattern Positions</a></li><li><a href="#problem187">187. Distinct Substrings</a></li><li><a href="#problem188">188. Repeating Substring</a></li><li><a href="#problem189">189. String Functions</a></li><li><a href="#problem190">190. Substring Order I</a></li><li><a href="#problem191">191. Substring Order II</a></li><li><a href="#problem192">192. Substring Distribution</a></li><li><a href="#problem193">193. Point Location Test</a></li><li><a href="#problem194">194. Line Segment Intersection</a></li><li><a href="#problem195">195. Polygon Area</a></li><li><a href="#problem196">196. Point in Polygon</a></li><li><a href="#problem197">197. Polygon Lattice Points</a></li><li><a href="#problem198">198. Minimum Euclidean Distance</a></li><li><a href="#problem199">199. Convex Hull</a></li><li><a href="#problem200">200. Meet in the Middle</a></li><li><a href="#problem201">201. Hamming Distance</a></li><li><a href="#problem202">202. Beautiful Subgrids</a></li><li><a href="#problem203">203. Reachable Nodes</a></li><li><a href="#problem204">204. Reachability Queries</a></li><li><a href="#problem205">205. Cut and Paste</a></li><li><a href="#problem206">206. Substring Reversals</a></li><li><a href="#problem207">207. Reversals and Sums</a></li><li><a href="#problem208">208. Necessary Roads</a></li><li><a href="#problem209">209. Necessary Cities</a></li><li><a href="#problem210">210. Eulerian Subgraphs</a></li><li><a href="#problem211">211. Monster Game I</a></li><li><a href="#problem212">212. Monster Game II</a></li><li><a href="#problem213">213. Subarray Squares</a></li><li><a href="#problem214">214. Houses and Schools</a></li><li><a href="#problem215">215. Knuth Division</a></li><li><a href="#problem216">216. Apples and Bananas</a></li><li><a href="#problem217">217. One Bit Positions</a></li><li><a href="#problem218">218. Signal Processing</a></li><li><a href="#problem219">219. New Roads Queries</a></li><li><a href="#problem220">220. Dynamic Connectivity</a></li><li><a href="#problem221">221. Parcel Delivery</a></li><li><a href="#problem222">222. Task Assignment</a></li><li><a href="#problem223">223. Distinct Routes II</a></li><li><a href="#problem224">224. Shortest Subsequence</a></li><li><a href="#problem225">225. Counting Bits</a></li><li><a href="#problem226">226. Swap Game</a></li><li><a href="#problem227">227. Prüfer Code</a></li><li><a href="#problem228">228. Acyclic Graph Edges</a></li><li><a href="#problem229">229. Strongly Connected Edges</a></li><li><a href="#problem230">230. Even Outdegree Edges</a></li><li><a href="#problem231">231. Multiplication Table</a></li><li><a href="#problem232">232. Advertisement</a></li><li><a href="#problem233">233. Special Substrings</a></li><li><a href="#problem234">234. Permutation Inversions</a></li><li><a href="#problem235">235. Maximum Xor Subarray</a></li><li><a href="#problem236">236. Movie Festival Queries</a></li><li><a href="#problem237">237. Chess Tournament</a></li><li><a href="#problem238">238. Tree Traversals</a></li><li><a href="#problem239">239. Network Renovation</a></li><li><a href="#problem240">240. Graph Girth</a></li><li><a href="#problem241">241. Intersection Points</a></li><li><a href="#problem242">242. Inverse Inversions</a></li><li><a href="#problem243">243. Monotone Subsequences</a></li><li><a href="#problem244">244. String Reorder</a></li><li><a href="#problem245">245. Stack Weights</a></li><li><a href="#problem246">246. Pyramid Array</a></li><li><a href="#problem247">247. Increasing Subsequence II</a></li><li><a href="#problem248">248. String Removals</a></li><li><a href="#problem249">249. Bit Inversions</a></li><li><a href="#problem250">250. Xor Pyramid</a></li><li><a href="#problem251">251. Writing Numbers</a></li><li><a href="#problem252">252. String Transform</a></li><li><a href="#problem253">253. Letter Pair Move Game</a></li><li><a href="#problem254">254. Maximum Building I</a></li><li><a href="#problem255">255. Sorting Methods</a></li><li><a href="#problem256">256. Cyclic Array</a></li><li><a href="#problem257">257. List of Sums</a></li><li><a href="#problem258">258. Increasing Array II</a></li><li><a href="#problem259">259. Food Division</a></li><li><a href="#problem260">260. Bit Problem</a></li><li><a href="#problem261">261. Swap Round Sorting</a></li><li><a href="#problem262">262. Binary Subsequences</a></li><li><a href="#problem263">263. Tree Isomorphism I</a></li><li><a href="#problem264">264. Counting Sequences</a></li><li><a href="#problem265">265. Critical Cities</a></li><li><a href="#problem266">266. School Excursion</a></li><li><a href="#problem267">267. Coin Grid</a></li><li><a href="#problem268">268. Robot Path</a></li><li><a href="#problem269">269. Programmers and Artists</a></li><li><a href="#problem270">270. Course Schedule II</a></li><li><a href="#problem271">271. Removing Digits II</a></li><li><a href="#problem272">272. Coin Arrangement</a></li><li><a href="#problem273">273. Counting Bishops</a></li><li><a href="#problem274">274. Grid Puzzle I</a></li><li><a href="#problem275">275. Grid Puzzle II</a></li><li><a href="#problem276">276. Empty String</a></li><li><a href="#problem277">277. Grid Paths</a></li><li><a href="#problem278">278. Bit Substrings</a></li><li><a href="#problem279">279. Reversal Sorting</a></li><li><a href="#problem280">280. Counting Reorders</a></li><li><a href="#problem281">281. Book Shop II</a></li><li><a href="#problem282">282. Network Breakdown</a></li><li><a href="#problem283">283. Visiting Cities</a></li><li><a href="#problem284">284. Missing Coin Sum Queries</a></li><li><a href="#problem285">285. Number Grid</a></li><li><a href="#problem286">286. Maximum Building II</a></li><li><a href="#problem287">287. Filling Trominos</a></li><li><a href="#problem288">288. Stick Divisions</a></li><li><a href="#problem289">289. Coding Company</a></li><li><a href="#problem290">290. Flight Route Requests</a></li><li><a href="#problem291">291. Two Stacks Sorting</a></li><li><a href="#problem292">292. Tree Isomorphism II</a></li><li><a href="#problem293">293. Forbidden Cities</a></li><li><a href="#problem294">294. Area of Rectangles</a></li><li><a href="#problem295">295. Grid Completion</a></li><li><a href="#problem296">296. Creating Offices</a></li><li><a href="#problem297">297. Permutations II</a></li><li><a href="#problem298">298. Functional Graph Distribution</a></li><li><a href="#problem299">299. New Flight Routes</a></li><li><a href="#problem300">300. Grid Path Construction</a></li></ul>
    <a name="problem1"></a>
    <h1>Problem 1: Weird Algorithm</h1>
    <div class="problem"><div class="content">
<title>CSES - Weird Algorithm</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1068"/>
<div class="md"><p>Consider an algorithm that takes as input a positive integer <span class="math math-inline">n</span>. If <span class="math math-inline">n</span> is even, the algorithm divides it by two, and if <span class="math math-inline">n</span> is odd, the algorithm multiplies it by three and adds one. The algorithm repeats this, until <span class="math math-inline">n</span> is one. For example, the sequence for <span class="math math-inline">n=3</span> is as follows:
<span class="math math-display"> 3 \rightarrow 10 \rightarrow 5 \rightarrow 16 \rightarrow 8 \rightarrow 4 \rightarrow 2 \rightarrow 1</span>
Your task is to simulate the execution of the algorithm for a given value of <span class="math math-inline">n</span>.</p>
<h1 id="input">Input</h1>
<p>The only input line contains an integer <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print a line that contains all values of <span class="math math-inline">n</span> during the algorithm.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
</pre>
<p>Output:</p>
<pre>3 10 5 16 8 4 2 1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem2"></a>
    <h1>Problem 2: Missing Number</h1>
    <div class="problem"><div class="content">
<title>CSES - Repetitions</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1069"/>
<div class="md"><p>You are given a DNA sequence: a string consisting of characters A, C, G, and T. Your task is to find the longest repetition in the sequence. This is a maximum-length substring containing only one type of character.</p>
<h1 id="input">Input</h1>
<p>The only input line contains a string of <span class="math math-inline">n</span> characters.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the length of the longest repetition.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>ATTCGGGA
</pre>
<p>Output:</p>
<pre>3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem3"></a>
    <h1>Problem 3: Repetitions</h1>
    <div class="problem"><div class="content">
<title>CSES - Permutations</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1070"/>
<div class="md"><p>A permutation of integers <span class="math math-inline">1,2,\ldots,n</span> is called <em>beautiful</em> if there are no adjacent elements whose difference is <span class="math math-inline">1</span>.</p>
<p>Given <span class="math math-inline">n</span>, construct a beautiful permutation if such a permutation exists.</p>
<h1 id="input">Input</h1>
<p>The only input line contains an integer <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print a beautiful permutation of integers <span class="math math-inline">1,2,\ldots,n</span>. If there are several solutions, you may print any of them. If there are no solutions, print "NO SOLUTION".</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
</ul>
<h1 id="example1">Example 1</h1>
<p>Input:</p>
<pre>5
</pre>
<p>Output:</p>
<pre>4 2 5 3 1
</pre><h1 id="example2">Example 2</h1>
<p>Input:</p>
<pre>3
</pre>
<p>Output:</p>
<pre>NO SOLUTION
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem4"></a>
    <h1>Problem 4: Increasing Array</h1>
    <div class="problem"><div class="content">
<title>CSES - Number Spiral</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1071"/>
<div class="md"><p>A number spiral is an infinite grid whose upper-left square has number 1. Here are the first five layers of the spiral:
<center><img alt="" class="invertible" src="/file/bba36f2601b99c7edc15865aa2a49e680a271075f30e86aa0e4e18d00a779c21"/></center>
Your task is to find out the number in row <span class="math math-inline">y</span> and column <span class="math math-inline">x</span>.</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">t</span>: the number of tests.</p>
<p>After this, there are <span class="math math-inline">t</span> lines, each containing integers <span class="math math-inline">y</span> and <span class="math math-inline">x</span>.</p>
<h1 id="output">Output</h1>
<p>For each test, print the number in row <span class="math math-inline">y</span> and column <span class="math math-inline">x</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le t \le 10^5</span></li>
<li><span class="math math-inline">1 \le y,x \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
2 3
1 1
4 2
</pre>
<p>Output:</p>
<pre>8
1
15
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem5"></a>
    <h1>Problem 5: Permutations</h1>
    <div class="problem"><div class="content">
<title>CSES - Two Knights</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1072"/>
<div class="md"><p>Your task is to count for <span class="math math-inline">k=1,2,\ldots,n</span> the number of ways two knights can be placed on a <span class="math math-inline">k \times k</span> chessboard so that they do not attack each other.</p>
<h1 id="input">Input</h1>
<p>The only input line contains an integer <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">n</span> integers: the results.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10000</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8
</pre>
<p>Output:</p>
<pre>0
6
28
96
252
550
1056
1848
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem6"></a>
    <h1>Problem 6: Number Spiral</h1>
    <div class="problem"><div class="content">
<title>CSES - Towers</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1073"/>
<div class="md"><p>You are given <span class="math math-inline">n</span> cubes in a certain order, and your task is to build towers using them. Whenever two cubes are one on top of the other, the upper cube must be smaller than the lower cube.</p>
<p>You must process the cubes in the given order. You can always either place the cube on top of an existing tower, or begin a new tower. What is the minimum possible number of towers?</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">n</span>: the number of cubes.</p>
<p>The next line contains <span class="math math-inline">n</span> integers <span class="math math-inline">k_1,k_2,\ldots,k_n</span>: the sizes of the cubes.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum number of towers.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le k_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
3 8 2 1 5
</pre>
<p>Output:</p>
<pre>2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem7"></a>
    <h1>Problem 7: Two Knights</h1>
    <div class="problem"><div class="content">
<title>CSES - Stick Lengths</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1074"/>
<div class="md"><p>There are <span class="math math-inline">n</span> sticks with some lengths. Your task is to modify the sticks so that each stick has the same length.</p>
<p>You can either lengthen and shorten each stick. Both operations cost <span class="math math-inline">x</span> where <span class="math math-inline">x</span> is the difference between the new and original length.</p>
<p>What is the minimum total cost?</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">n</span>: the number of sticks.</p>
<p>Then there are <span class="math math-inline">n</span> integers: <span class="math math-inline">p_1,p_2,\ldots,p_n</span>: the lengths of the sticks.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum total cost.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le p_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
2 3 1 5 2
</pre>
<p>Output:</p>
<pre>5
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem8"></a>
    <h1>Problem 8: Two Sets</h1>
    <div class="problem"><div class="content">
<title>CSES - Permutations II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1075"/>
<div class="md"><p>A permutation of integers <span class="math math-inline">1,2,\ldots,n</span> is called <em>beautiful</em> if there are no adjacent elements whose difference is <span class="math math-inline">1</span>.</p>
<p>Given <span class="math math-inline">n</span>, your task is to count the number of beautiful permutations.</p>
<h1 id="input">Input</h1>
<p>The only input line contains an integer <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print the number of beautiful permutations of <span class="math math-inline">1,2,\ldots,n</span> modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 1000</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
</pre>
<p>Output:</p>
<pre>14
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem9"></a>
    <h1>Problem 9: Bit Strings</h1>
    <div class="problem"><div class="content">
<title>CSES - Sliding Window Median</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1076"/>
<div class="md"><p>You are given an array of <span class="math math-inline">n</span> integers. Your task is to calculate the median of each window of <span class="math math-inline">k</span> elements, from left to right.</p>
<p>The median is the middle element when the elements are sorted. If the number of elements is even, there are two possible medians and we assume that the median is the smaller of them.</p>
<h1 id="input">Input</h1>
<p>The first line contains two integers <span class="math math-inline">n</span> and <span class="math math-inline">k</span>: the number of elements and the size of the window.</p>
<p>Then there are <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\ldots,x_n</span>: the contents of the array.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">n-k+1</span> values: the medians.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le k \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8 3
2 4 3 5 8 1 2 1
</pre>
<p>Output:</p>
<pre>3 4 5 5 2 1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem10"></a>
    <h1>Problem 10: Trailing Zeros</h1>
    <div class="problem"><div class="content">
<title>CSES - Sliding Window Cost</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1077"/>
<div class="md"><p>You are given an array of <span class="math math-inline">n</span> integers. Your task is to calculate for each window of <span class="math math-inline">k</span> elements, from left to right, the minimum total cost of making all elements equal.</p>
<p>You can increase or decrease each element with cost <span class="math math-inline">x</span> where <span class="math math-inline">x</span> is the difference between the new and the original value. The total cost is the sum of such costs.</p>
<h1 id="input">Input</h1>
<p>The first line contains two integers <span class="math math-inline">n</span> and <span class="math math-inline">k</span>: the number of elements and the size of the window.</p>
<p>Then there are <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\ldots,x_n</span>: the contents of the array.</p>
<h1 id="output">Output</h1>
<p>Output <span class="math math-inline">n-k+1</span> values: the costs.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le k \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8 3
2 4 3 5 8 1 2 1
</pre>
<p>Output:</p>
<pre>2 2 5 7 7 1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem11"></a>
    <h1>Problem 11: Coin Piles</h1>
    <div class="problem"><div class="content">
<title>CSES - Grid Paths</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1078"/>
<div class="md"><p>Consider an <span class="math math-inline">n \times n</span> grid whose top-left square is <span class="math math-inline">(1,1)</span> and bottom-right square is <span class="math math-inline">(n,n)</span>.</p>
<p>Your task is to move from the top-left square to the bottom-right square. On each step you may move one square right or down. In addition, there are <span class="math math-inline">m</span> traps in the grid. You cannot move to a square with a trap.</p>
<p>What is the total number of possible paths?</p>
<h1 id="input">Input</h1>
<p>The first input line contains two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the size of the grid and the number of traps.</p>
<p>After this, there are <span class="math math-inline">m</span> lines describing the traps. Each such line contains two integers <span class="math math-inline">y</span> and <span class="math math-inline">x</span>: the location of a trap.</p>
<p>You can assume that there are no traps in the top-left and bottom-right square.</p>
<h1 id="output">Output</h1>
<p>Print the number of paths modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
<li><span class="math math-inline">1 \le m \le 1000</span></li>
<li><span class="math math-inline">1 \le y,x \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3 1
2 2
</pre>
<p>Output:</p>
<pre>2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem12"></a>
    <h1>Problem 12: Palindrome Reorder</h1>
    <div class="problem"><div class="content">
<title>CSES - Binomial Coefficients</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1079"/>
<div class="md"><p>Your task is to calculate <span class="math math-inline">n</span> binomial coefficients modulo <span class="math math-inline">10^9+7</span>.</p>
<p>A binomial coefficient <span class="math math-inline">{a \choose b}</span> can be calculated using the formula <span class="math math-inline">\frac{a!}{b!(a-b)!}</span>. We assume that <span class="math math-inline">a</span> and <span class="math math-inline">b</span> are integers and <span class="math math-inline">0 \le b \le a</span>.</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">n</span>: the number of calculations.</p>
<p>After this, there are <span class="math math-inline">n</span> lines, each of which contains two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>Print each binomial coefficient modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">0 \le b \le a \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
5 3
8 1
9 5
</pre>
<p>Output:</p>
<pre>10
8
126
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem13"></a>
    <h1>Problem 13: Gray Code</h1>
    <div class="problem"><div class="content">
<title>CSES - Empty String</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1080"/>
<div class="md"><p>You are given a string consisting of <span class="math math-inline">n</span> characters between a and z.</p>
<p>On each turn, you may remove any two adjacent characters that are equal. Your goal is to construct an empty string by removing all the characters.</p>
<p>In how many ways can you do this?</p>
<h1 id="input">Input</h1>
<p>The only input line has a string of length <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of ways modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 500</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>aabccb
</pre>
<p>Output:</p>
<pre>3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem14"></a>
    <h1>Problem 14: Tower of Hanoi</h1>
    <div class="problem"><div class="content">
<title>CSES - Common Divisors</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1081"/>
<div class="md"><p>You are given an array of <span class="math math-inline">n</span> positive integers. Your task is to find two integers such that their greatest common divisor is as large as possible.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the size of the array.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\ldots,x_n</span>: the contents of the array.</p>
<h1 id="output">Output</h1>
<p>Print the maximum greatest common divisor.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">2 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
3 14 15 7 9
</pre>
<p>Output:</p>
<pre>7
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem15"></a>
    <h1>Problem 15: Creating Strings</h1>
    <div class="problem"><div class="content">
<title>CSES - Sum of Divisors</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1082"/>
<div class="md"><p>Let <span class="math math-inline">\sigma(n)</span> denote the sum of divisors of an integer <span class="math math-inline">n</span>. For example, <span class="math math-inline">\sigma(12)=1+2+3+4+6+12=28</span>.</p>
<p>Your task is to calculate the sum <span class="math math-inline">\sum_{i=1}^n \sigma(i)</span> modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="input">Input</h1>
<p>The only input line has an integer <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">\sum_{i=1}^n \sigma(i)</span> modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^{12}</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
</pre>
<p>Output:</p>
<pre>21
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem16"></a>
    <h1>Problem 16: Apple Division</h1>
    <div class="problem"><div class="content">
<title>CSES - Missing Number</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1083"/>
<div class="md"><p>You are given all numbers between <span class="math math-inline">1,2,\ldots,n</span> except one. Your task is to find the missing number.</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">n</span>.</p>
<p>The second line contains <span class="math math-inline">n-1</span> numbers. Each number is distinct and between <span class="math math-inline">1</span> and <span class="math math-inline">n</span> (inclusive).</p>
<h1 id="output">Output</h1>
<p>Print the missing number.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">2 \le n \le 2 \cdot 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
2 3 1 5
</pre>
<p>Output:</p>
<pre>4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem17"></a>
    <h1>Problem 17: Chessboard and Queens</h1>
    <div class="problem"><div class="content">
<title>CSES - Apartments</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1084"/>
<div class="md"><p>There are <span class="math math-inline">n</span> applicants and <span class="math math-inline">m</span> free apartments. Your task is to distribute the apartments so that as many applicants as possible will get an apartment.</p>
<p>Each applicant has a desired apartment size, and they will accept any apartment whose size is close enough to the desired size.</p>
<h1 id="input">Input</h1>
<p>The first input line has three integers <span class="math math-inline">n</span>, <span class="math math-inline">m</span>, and <span class="math math-inline">k</span>: the number of applicants, the number of apartments, and the maximum allowed difference.</p>
<p>The next line contains <span class="math math-inline">n</span> integers <span class="math math-inline">a_1, a_2, \ldots, a_n</span>: the desired apartment size of each applicant. If the desired size of an applicant is <span class="math math-inline">x</span>, they will accept any apartment whose size is between <span class="math math-inline">x-k</span> and <span class="math math-inline">x+k</span>.</p>
<p>The last line contains <span class="math math-inline">m</span> integers <span class="math math-inline">b_1, b_2, \ldots, b_m</span>: the size of each apartment.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of applicants who will get an apartment.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n, m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">0 \le k \le 10^9</span></li>
<li><span class="math math-inline">1 \le a_i, b_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 3 5
60 45 80 60
30 60 75
</pre>
<p>Output:</p>
<pre>2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem18"></a>
    <h1>Problem 18: Digit Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - Array Division</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1085"/>
<div class="md"><p>You are given an array containing <span class="math math-inline">n</span> positive integers.</p>
<p>Your task is to divide the array into <span class="math math-inline">k</span> subarrays so that the maximum sum in a subarray is as small as possible.</p>
<h1 id="input">Input</h1>
<p>The first input line contains two integers <span class="math math-inline">n</span> and <span class="math math-inline">k</span>: the size of the array and the number of subarrays in the division.</p>
<p>The next line contains <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\ldots,x_n</span>: the contents of the array.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the maximum sum in a subarray in the optimal division.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le k \le n</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3
2 4 7 3 5
</pre>
<p>Output:</p>
<pre>8
</pre>
<p>Explanation: An optimal division is <span class="math math-inline">[2,4],[7],[3,5]</span> where the sums of the subarrays are <span class="math math-inline">6,7,8</span>. The largest sum is the last sum <span class="math math-inline">8</span>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem19"></a>
    <h1>Problem 19: Grid Paths</h1>
    <div class="problem"><div class="content">
<title>CSES - Writing Numbers</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1086"/>
<div class="md"><p>You would like to write a list of positive integers <span class="math math-inline">1,2,3,\ldots</span> using your computer. However, you can press each key <span class="math math-inline">0</span>–<span class="math math-inline">9</span> at most <span class="math math-inline">n</span> times during the process.</p>
<p>What is the last number you can write?</p>
<h1 id="input">Input</h1>
<p>The only input line contains the value of <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print the last number you can write.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^{18}</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
</pre>
<p>Output:</p>
<pre>12
</pre>
<p>Explanation: You can write the numbers <span class="math math-inline">1,2,\ldots,12</span>. This requires that you press key <span class="math math-inline">1</span> five times, so you cannot write the number <span class="math math-inline">13</span>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem20"></a>
    <h1>Problem 20: Distinct Numbers</h1>
    <div class="problem"><div class="content">
<title>CSES - Shortest Subsequence</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1087"/>
<div class="md"><p>You are given a DNA sequence consisting of characters A, C, G, and T.</p>
<p>Your task is to find the shortest DNA sequence that is not a subsequence of the original sequence.</p>
<h1 id="input">Input</h1>
<p>The only input line contains a DNA sequence with <span class="math math-inline">n</span> characters.</p>
<h1 id="output">Output</h1>
<p>Print the shortest DNA sequence that is not a subsequence of the original sequence. If there are several solutions, you may print any of them.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>ACGTACGT
</pre>
<p>Output:</p>
<pre>AAA
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem21"></a>
    <h1>Problem 21: Apartments</h1>
    <div class="problem"><div class="content">
<title>CSES - Ferris Wheel</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1090"/>
<div class="md"><p>There are <span class="math math-inline">n</span> children who want to go to a Ferris wheel, and your task is to find a gondola for each child.</p>
<p>Each gondola may have one or two children in it, and in addition, the total weight in a gondola may not exceed <span class="math math-inline">x</span>. You know the weight of every child.</p>
<p>What is the minimum number of gondolas needed for the children?</p>
<h1 id="input">Input</h1>
<p>The first input line contains two integers <span class="math math-inline">n</span> and <span class="math math-inline">x</span>: the number of children and the maximum allowed weight.</p>
<p>The next line contains <span class="math math-inline">n</span> integers <span class="math math-inline">p_1,p_2,\ldots,p_n</span>: the weight of each child.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum number of gondolas.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x \le 10^9</span></li>
<li><span class="math math-inline">1 \le p_i \le x</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 10
7 2 3 9
</pre>
<p>Output:</p>
<pre>3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem22"></a>
    <h1>Problem 22: Ferris Wheel</h1>
    <div class="problem"><div class="content">
<title>CSES - Concert Tickets</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1091"/>
<div class="md"><p>There are <span class="math math-inline">n</span> concert tickets available, each with a certain price. Then, <span class="math math-inline">m</span> customers arrive, one after another.</p>
<p>Each customer announces the maximum price they are willing to pay for a ticket, and after this, they will get a ticket with the nearest possible price such that it does not exceed the maximum price.</p>
<h1 id="input">Input</h1>
<p>The first input line contains integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of tickets and the number of customers.</p>
<p>The next line contains <span class="math math-inline">n</span> integers <span class="math math-inline">h_1,h_2,\ldots,h_n</span>: the price of each ticket.</p>
<p>The last line contains <span class="math math-inline">m</span> integers <span class="math math-inline">t_1,t_2,\ldots,t_m</span>: the maximum price for each customer in the order they arrive.</p>
<h1 id="output">Output</h1>
<p>Print, for each customer, the price that they will pay for their ticket. After this, the ticket cannot be purchased again.</p>
<p>If a customer cannot get any ticket, print <span class="math math-inline">-1</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n, m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le h_i, t_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3
5 3 7 8 5
4 8 3
</pre>
<p>Output:</p>
<pre>3
8
-1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem23"></a>
    <h1>Problem 23: Concert Tickets</h1>
    <div class="problem"><div class="content">
<title>CSES - Two Sets</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1092"/>
<div class="md"><p>Your task is to divide the numbers <span class="math math-inline">1,2,\ldots,n</span> into two sets of equal sum.</p>
<h1 id="input">Input</h1>
<p>The only input line contains an integer <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print "YES", if the division is possible, and "NO" otherwise.</p>
<p>After this, if the division is possible, print an example of how to create the sets. First, print the number of elements in the first set followed by the elements themselves in a separate line, and then, print the second set in a similar way.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
</ul>
<h1 id="example1">Example 1</h1>
<p>Input:</p>
<pre>7
</pre>
<p>Output:</p>
<pre>YES
4
1 2 4 7
3
3 5 6
</pre><h1 id="example2">Example 2</h1>
<p>Input:</p>
<pre>6
</pre>
<p>Output:</p>
<pre>NO
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem24"></a>
    <h1>Problem 24: Restaurant Customers</h1>
    <div class="problem"><div class="content">
<title>CSES - Two Sets II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1093"/>
<div class="md"><p>Your task is to count the number of ways numbers <span class="math math-inline">1,2,\ldots,n</span> can be divided into two sets of equal sum.</p>
<p>For example, if <span class="math math-inline">n=7</span>, there are four solutions:</p>
<ul>
<li><span class="math math-inline">\{1,3,4,6\}</span> and <span class="math math-inline">\{2,5,7\}</span></li>
<li><span class="math math-inline">\{1,2,5,6\}</span> and <span class="math math-inline">\{3,4,7\}</span></li>
<li><span class="math math-inline">\{1,2,4,7\}</span> and <span class="math math-inline">\{3,5,6\}</span></li>
<li><span class="math math-inline">\{1,6,7\}</span> and <span class="math math-inline">\{2,3,4,5\}</span></li>
</ul>
<h1 id="input">Input</h1>
<p>The only input line contains an integer <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print the answer modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 500</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>7
</pre>
<p>Output:</p>
<pre>4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem25"></a>
    <h1>Problem 25: Movie Festival</h1>
    <div class="problem"><div class="content">
<title>CSES - Increasing Array</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1094"/>
<div class="md"><p>You are given an array of <span class="math math-inline">n</span> integers. You want to modify the array so that it is increasing, i.e., every element is at least as large as the previous element.</p>
<p>On each move, you may increase the value of any element by one. What is the minimum number of moves required?</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">n</span>: the size of the array.</p>
<p>Then, the second line contains <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\ldots,x_n</span>: the contents of the array.</p>
<h1 id="output">Output</h1>
<p>Print the minimum number of moves.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
3 2 5 1 7
</pre>
<p>Output:</p>
<pre>5
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem26"></a>
    <h1>Problem 26: Sum of Two Values</h1>
    <div class="problem"><div class="content">
<title>CSES - Exponentiation</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1095"/>
<div class="md"><p>Your task is to efficiently calculate values <span class="math math-inline">a^b</span> modulo <span class="math math-inline">10^9+7</span>.</p>
<p>Note that in this task we assume that <span class="math math-inline">0^0=1</span>.</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">n</span>: the number of calculations.</p>
<p>After this, there are <span class="math math-inline">n</span> lines, each containing two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>Print each value <span class="math math-inline">a^b</span> modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">0 \le a,b \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
3 4
2 8
123 123
</pre>
<p>Output:</p>
<pre>81
256
921450052
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem27"></a>
    <h1>Problem 27: Maximum Subarray Sum</h1>
    <div class="problem"><div class="content">
<title>CSES - Throwing Dice</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1096"/>
<div class="md"><p>Your task is to calculate the number of ways to get a sum <span class="math math-inline">n</span> by throwing dice. Each throw yields an integer between <span class="math math-inline">1 \ldots 6</span>.</p>
<p>For example, if <span class="math math-inline">n=10</span>, some possible ways are <span class="math math-inline">3+3+4</span>, <span class="math math-inline">1+4+1+4</span> and <span class="math math-inline">1+1+6+1+1</span>.</p>
<h1 id="input">Input</h1>
<p>The only input line contains an integer <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print the number of ways modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^{18}</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8
</pre>
<p>Output:</p>
<pre>125
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem28"></a>
    <h1>Problem 28: Stick Lengths</h1>
    <div class="problem"><div class="content">
<title>CSES - Removal Game</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1097"/>
<div class="md"><p>There is a list of <span class="math math-inline">n</span> numbers and two players who move alternately. On each move, a player removes either the first or last number from the list, and their score increases by that number. Both players try to maximize their scores.</p>
<p>What is the maximum possible score for the first player when both players play optimally?</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">n</span>: the size of the list.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\ldots,x_n</span>: the contents of the list.</p>
<h1 id="output">Output</h1>
<p>Print the maximum possible score for the first player.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 5000</span></li>
<li><span class="math math-inline">-10^9 \le x_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4
4 5 1 3
</pre>
<p>Output:</p>
<pre>8
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem29"></a>
    <h1>Problem 29: Missing Coin Sum</h1>
    <div class="problem"><div class="content">
<title>CSES - Nim Game II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1098"/>
<div class="md"><p>There are <span class="math math-inline">n</span> heaps of sticks and two players who move alternately. On each move, a player chooses a non-empty heap and removes <span class="math math-inline">1</span>, <span class="math math-inline">2</span>, or <span class="math math-inline">3</span> sticks. The player who removes the last stick wins the game.</p>
<p>Your task is to find out who wins if both players play optimally.</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">t</span>: the number of tests. After this, <span class="math math-inline">t</span> test cases are described:</p>
<p>The first line contains an integer <span class="math math-inline">n</span>: the number of heaps.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\ldots,x_n</span>: the number of sticks in each heap.</p>
<h1 id="output">Output</h1>
<p>For each test case, print "first" if the first player wins the game and "second" if the second player wins the game.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le t \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
<li>the sum of all <span class="math math-inline">n</span> is at most <span class="math math-inline">2 \cdot 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
4
5 7 2 5
2
4 1
3
4 4 4
</pre>
<p>Output:</p>
<pre>first
first
second
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem30"></a>
    <h1>Problem 30: Collecting Numbers</h1>
    <div class="problem"><div class="content">
<title>CSES - Stair Game</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1099"/>
<div class="md"><p>There is a staircase consisting of <span class="math math-inline">n</span> stairs, numbered <span class="math math-inline">1,2,\ldots,n</span>. Initially, each stair has some number of balls.</p>
<p>There are two players who move alternately. On each move, a player chooses a stair <span class="math math-inline">k</span> where <span class="math math-inline">k \neq 1</span> and it has at least one ball. Then, the player moves any number of balls from stair <span class="math math-inline">k</span> to stair <span class="math math-inline">k-1</span>. The player who moves last wins the game.</p>
<p>Your task is to find out who wins the game when both players play optimally.</p>
<p>Note that if there are no possible moves at all, the second player wins.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">t</span>: the number of tests. After this, <span class="math math-inline">t</span> test cases are described:</p>
<p>The first line contains an integer <span class="math math-inline">n</span>: the number of stairs.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">p_1,p_2,\ldots,p_n</span>: the initial number of balls on each stair.</p>
<h1 id="output">Output</h1>
<p>For each test, print "first" if the first player wins the game and "second" if the second player wins the game.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le t \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">0 \le p_i \le 10^9</span></li>
<li>the sum of all <span class="math math-inline">n</span> is at most <span class="math math-inline">2 \cdot 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
3
0 2 1
4
1 1 1 1
2
5 3
</pre>
<p>Output:</p>
<pre>first
second
first
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem31"></a>
    <h1>Problem 31: Collecting Numbers II</h1>
    <div class="problem"><div class="content">
<title>CSES - Minimal Rotation</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1110"/>
<div class="md"><p>A rotation of a string can be generated by moving characters one after another from beginning to end. For example, the rotations of <code>acab</code> are <code>acab</code>, <code>caba</code>, <code>abac</code>, and <code>baca</code>.</p>
<p>Your task is to determine the lexicographically minimal rotation of a string.</p>
<h1 id="input">Input</h1>
<p>The only input line contains a string of length <span class="math math-inline">n</span>. Each character is one of a–z.</p>
<h1 id="output">Output</h1>
<p>Print the lexicographically minimal rotation.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>acab
</pre>
<p>Output:</p>
<pre>abac
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem32"></a>
    <h1>Problem 32: Playlist</h1>
    <div class="problem"><div class="content">
<title>CSES - Longest Palindrome</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1111"/>
<div class="md"><p>Given a string, your task is to determine the longest palindromic substring of the string. For example, the longest palindrome in <code>aybabtu</code> is <code>bab</code>.</p>
<h1 id="input">Input</h1>
<p>The only input line contains a string of length <span class="math math-inline">n</span>. Each character is one of a–z.</p>
<h1 id="output">Output</h1>
<p>Print the longest palindrome in the string. If there are several solutions, you may print any of them.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>aybabtu
</pre>
<p>Output:</p>
<pre>bab
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem33"></a>
    <h1>Problem 33: Towers</h1>
    <div class="problem"><div class="content">
<title>CSES - Required Substring</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1112"/>
<div class="md"><p>Your task is to calculate the number of strings of length <span class="math math-inline">n</span> having a given pattern of length <span class="math math-inline">m</span> as their substring. All strings consist of characters A–Z.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the length of the final string.</p>
<p>The second line has a pattern of length <span class="math math-inline">m</span>.</p>
<h1 id="output">Output</h1>
<p>Print the number of strings modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 1000</span></li>
<li><span class="math math-inline">1 \le m \le 100</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>6
ABCDB
</pre>
<p>Output:</p>
<pre>52
</pre>
<p>Explanation: The final string will be of the form ABCDB<span class="math math-inline">x</span> or <span class="math math-inline">x</span>ABCDB where <span class="math math-inline">x</span> is any character between A–Z.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem34"></a>
    <h1>Problem 34: Traffic Lights</h1>
    <div class="problem"><div class="content">
<title>CSES - String Transform</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1113"/>
<div class="md"><p>Consider the following string transformation:</p>
<ol>
<li>append the character # to the string (we assume that # is lexicographically smaller than all other characters of the string)</li>
<li>generate all rotations of the string</li>
<li>sort the rotations in increasing order</li>
<li>based on this order, construct a new string that contains the last character of each rotation</li>
</ol>
<p>For example, the string <code>babc</code> becomes <code>babc#</code>. Then, the sorted list of rotations is <code>#babc</code>, <code>abc#b</code>, <code>babc#</code>, <code>bc#ba</code>, and <code>c#bab</code>. This yields a string <code>cb#ab</code>.</p>
<h1 id="input">Input</h1>
<p>The only input line contains the transformed string of length <span class="math math-inline">n+1</span>. Each character of the original string is one of a–z.</p>
<h1 id="output">Output</h1>
<p>Print the original string of length <span class="math math-inline">n</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>cb#ab
</pre>
<p>Output:</p>
<pre>babc
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem35"></a>
    <h1>Problem 35: Josephus Problem I</h1>
    <div class="problem"><div class="content">
<title>CSES - Tree Matching</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1130"/>
<div class="md"><p>You are given a tree consisting of <span class="math math-inline">n</span> nodes.</p>
<p>A <em>matching</em> is a set of edges where each node is an endpoint of at most one edge. What is the maximum number of edges in a matching?</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">n</span>: the number of nodes. The nodes are numbered <span class="math math-inline">1,2,\ldots,n</span>.</p>
<p>Then there are <span class="math math-inline">n-1</span> lines describing the edges. Each line contains two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the maximum number of pairs.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
1 2
1 3
3 4
3 5
</pre>
<p>Output:</p>
<pre>2
</pre>
<p>Explanation: One possible matching is <span class="math math-inline">(1,2)</span> and <span class="math math-inline">(3,4)</span>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem36"></a>
    <h1>Problem 36: Josephus Problem II</h1>
    <div class="problem"><div class="content">
<title>CSES - Tree Diameter</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1131"/>
<div class="md"><p>You are given a tree consisting of <span class="math math-inline">n</span> nodes.</p>
<p>The <em>diameter</em> of a tree is the maximum distance between two nodes. Your task is to determine the diameter of the tree.</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">n</span>: the number of nodes. The nodes are numbered <span class="math math-inline">1,2,\ldots,n</span>.</p>
<p>Then there are <span class="math math-inline">n-1</span> lines describing the edges. Each line contains two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the diameter of the tree.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
1 2
1 3
3 4
3 5
</pre>
<p>Output:</p>
<pre>3
</pre>
<p>Explanation: The diameter corresponds to the path <span class="math math-inline">2 \rightarrow 1 \rightarrow 3 \rightarrow 5</span>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem37"></a>
    <h1>Problem 37: Nested Ranges Check</h1>
    <div class="problem"><div class="content">
<title>CSES - Tree Distances I</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1132"/>
<div class="md"><p>You are given a tree consisting of <span class="math math-inline">n</span> nodes.</p>
<p>Your task is to determine for each node the maximum distance to another node.</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">n</span>: the number of nodes. The nodes are numbered <span class="math math-inline">1,2,\ldots,n</span>.</p>
<p>Then there are <span class="math math-inline">n-1</span> lines describing the edges. Each line contains two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">n</span> integers: for each node <span class="math math-inline">1,2,\ldots,n</span>, the maximum distance to another node.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
1 2
1 3
3 4
3 5
</pre>
<p>Output:</p>
<pre>2 3 2 3 3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem38"></a>
    <h1>Problem 38: Nested Ranges Count</h1>
    <div class="problem"><div class="content">
<title>CSES - Tree Distances II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1133"/>
<div class="md"><p>You are given a tree consisting of <span class="math math-inline">n</span> nodes.</p>
<p>Your task is to determine for each node the sum of the distances from the node to all other nodes.</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">n</span>: the number of nodes. The nodes are numbered <span class="math math-inline">1,2,\ldots,n</span>.</p>
<p>Then there are <span class="math math-inline">n-1</span> lines describing the edges. Each line contains two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">n</span> integers: for each node <span class="math math-inline">1,2,\ldots,n</span>, the sum of the distances.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
1 2
1 3
3 4
3 5
</pre>
<p>Output:</p>
<pre>6 9 5 8 8
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem39"></a>
    <h1>Problem 39: Room Allocation</h1>
    <div class="problem"><div class="content">
<title>CSES - Prüfer Code</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1134"/>
<div class="md"><p>A <em>Prüfer code</em> of a tree of <span class="math math-inline">n</span> nodes is a sequence of <span class="math math-inline">n-2</span> integers that uniquely specifies the structure of the tree.</p>
<p>The code is constructed as follows: As long as there are at least three nodes left, find a leaf with the smallest label, add the label of its only neighbor to the code, and remove the leaf from the tree.</p>
<p>Given a Prüfer code of a tree, your task is to construct the original tree.</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">n</span>: the number of nodes. The nodes are numbered <span class="math math-inline">1,2,\ldots,n</span>.</p>
<p>The second line contains <span class="math math-inline">n-2</span> integers: the Prüfer code.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">n-1</span> lines describing the edges of the tree. Each line has to contain two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>. You can print the edges in any order.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">3 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
2 2 4
</pre>
<p>Output:</p>
<pre>1 2
2 3
2 4
4 5
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem40"></a>
    <h1>Problem 40: Factory Machines</h1>
    <div class="problem"><div class="content">
<title>CSES - Distance Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1135"/>
<div class="md"><p>You are given a tree consisting of <span class="math math-inline">n</span> nodes.</p>
<p>Your task is to process <span class="math math-inline">q</span> queries of the form: what is the distance between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>?</p>
<h1 id="input">Input</h1>
<p>The first input line contains two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the number of nodes and queries. The nodes are numbered <span class="math math-inline">1,2,\ldots,n</span>.</p>
<p>Then there are <span class="math math-inline">n-1</span> lines describing the edges. Each line contains two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. Each line contains two integer <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: what is the distance between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>?</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">q</span> integers: the answer to each query.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n, q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3
1 2
1 3
3 4
3 5
1 3
2 5
1 4
</pre>
<p>Output:</p>
<pre>1
3
2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem41"></a>
    <h1>Problem 41: Tasks and Deadlines</h1>
    <div class="problem"><div class="content">
<title>CSES - Counting Paths</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1136"/>
<div class="md"><p>You are given a tree consisting of <span class="math math-inline">n</span> nodes, and <span class="math math-inline">m</span> paths in the tree.</p>
<p>Your task is to calculate for each node the number of paths containing that node.</p>
<h1 id="input">Input</h1>
<p>The first input line contains integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of nodes and paths. The nodes are numbered <span class="math math-inline">1,2,\ldots,n</span>.</p>
<p>Then there are <span class="math math-inline">n-1</span> lines describing the edges. Each line contains two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<p>Finally, there are <span class="math math-inline">m</span> lines describing the paths. Each line contains two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is a path between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">n</span> integers: for each node <span class="math math-inline">1,2,\ldots,n</span>, the number of paths containing that node.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n, m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3
1 2
1 3
3 4
3 5
1 3
2 5
1 4
</pre>
<p>Output:</p>
<pre>3 1 3 1 1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem42"></a>
    <h1>Problem 42: Reading Books</h1>
    <div class="problem"><div class="content">
<title>CSES - Subtree Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1137"/>
<div class="md"><p>You are given a rooted tree consisting of <span class="math math-inline">n</span> nodes. The nodes are numbered <span class="math math-inline">1,2,\ldots,n</span>, and node <span class="math math-inline">1</span> is the root. Each node has a value.</p>
<p>Your task is to process following types of queries:</p>
<ol>
<li>change the value of node <span class="math math-inline">s</span> to <span class="math math-inline">x</span></li>
<li>calculate the sum of values in the subtree of node <span class="math math-inline">s</span></li>
</ol>
<h1 id="input">Input</h1>
<p>The first input line contains two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the number of nodes and queries. The nodes are numbered <span class="math math-inline">1,2,\ldots,n</span>.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">v_1,v_2,\ldots,v_n</span>: the value of each node.</p>
<p>Then there are <span class="math math-inline">n-1</span> lines describing the edges. Each line contans two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. Each query is either of the form "1 <span class="math math-inline">s</span> <span class="math math-inline">x</span>" or "2 <span class="math math-inline">s</span>".</p>
<h1 id="output">Output</h1>
<p>Print the answer to each query of type 2.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n, q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b, s \le n</span></li>
<li><span class="math math-inline">1 \le v_i, x \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3
4 2 5 2 1
1 2
1 3
3 4
3 5
2 3
1 5 3
2 3
</pre>
<p>Output:</p>
<pre>8
10
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem43"></a>
    <h1>Problem 43: Sum of Three Values</h1>
    <div class="problem"><div class="content">
<title>CSES - Path Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1138"/>
<div class="md"><p>You are given a rooted tree consisting of <span class="math math-inline">n</span> nodes. The nodes are numbered <span class="math math-inline">1,2,\ldots,n</span>, and node <span class="math math-inline">1</span> is the root. Each node has a value.</p>
<p>Your task is to process following types of queries:</p>
<ol>
<li>change the value of node <span class="math math-inline">s</span> to <span class="math math-inline">x</span></li>
<li>calculate the sum of values on the path from the root to node <span class="math math-inline">s</span></li>
</ol>
<h1 id="input">Input</h1>
<p>The first input line contains two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the number of nodes and queries. The nodes are numbered <span class="math math-inline">1,2,\ldots,n</span>.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">v_1,v_2,\ldots,v_n</span>: the value of each node.</p>
<p>Then there are <span class="math math-inline">n-1</span> lines describing the edges. Each line contains two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. Each query is either of the form "1 <span class="math math-inline">s</span> <span class="math math-inline">x</span>" or "2 <span class="math math-inline">s</span>".</p>
<h1 id="output">Output</h1>
<p>Print the answer to each query of type 2.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n, q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b, s \le n</span></li>
<li><span class="math math-inline">1 \le v_i, x \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3
4 2 5 2 1
1 2
1 3
3 4
3 5
2 4
1 3 2
2 4
</pre>
<p>Output:</p>
<pre>11
8
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem44"></a>
    <h1>Problem 44: Sum of Four Values</h1>
    <div class="problem"><div class="content">
<title>CSES - Distinct Colors</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1139"/>
<div class="md"><p>You are given a rooted tree consisting of <span class="math math-inline">n</span> nodes. The nodes are numbered <span class="math math-inline">1,2,\ldots,n</span>, and node <span class="math math-inline">1</span> is the root. Each node has a color.</p>
<p>Your task is to determine for each node the number of distinct colors in the subtree of the node.</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">n</span>: the number of nodes. The nodes are numbered <span class="math math-inline">1,2,\ldots,n</span>.</p>
<p>The next line consists of <span class="math math-inline">n</span> integers <span class="math math-inline">c_1,c_2,\ldots,c_n</span>: the color of each node.</p>
<p>Then there are <span class="math math-inline">n-1</span> lines describing the edges. Each line contains two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">n</span> integers: for each node <span class="math math-inline">1,2,\ldots,n</span>, the number of distinct colors.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
<li><span class="math math-inline">1 \le c_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
2 3 2 2 1
1 2
1 3
3 4
3 5
</pre>
<p>Output:</p>
<pre>3 1 2 1 1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem45"></a>
    <h1>Problem 45: Nearest Smaller Values</h1>
    <div class="problem"><div class="content">
<title>CSES - Projects</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1140"/>
<div class="md"><p>There are <span class="math math-inline">n</span> projects you can attend. For each project, you know its starting and ending days and the amount of money you would get as reward. You can only attend one project during a day.</p>
<p>What is the maximum amount of money you can earn?</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">n</span>: the number of projects.</p>
<p>After this, there are <span class="math math-inline">n</span> lines. Each such line has three integers <span class="math math-inline">a_i</span>, <span class="math math-inline">b_i</span>, and <span class="math math-inline">p_i</span>: the starting day, the ending day, and the reward.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the maximum amount of money you can earn.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a_i \le b_i \le 10^9</span></li>
<li><span class="math math-inline">1 \le p_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4
2 4 4
3 6 6
6 8 2
5 7 3
</pre>
<p>Output:</p>
<pre>7
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem46"></a>
    <h1>Problem 46: Subarray Sums I</h1>
    <div class="problem"><div class="content">
<title>CSES - Playlist</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1141"/>
<div class="md"><p>You are given a playlist of a radio station since its establishment. The playlist has a total of <span class="math math-inline">n</span> songs.</p>
<p>What is the longest sequence of successive songs where each song is unique?</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">n</span>: the number of songs.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">k_1,k_2,\ldots,k_n</span>: the id number of each song.</p>
<h1 id="output">Output</h1>
<p>Print the length of the longest sequence of unique songs.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le k_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8
1 2 1 3 2 7 4 2
</pre>
<p>Output:</p>
<pre>5
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem47"></a>
    <h1>Problem 47: Subarray Sums II</h1>
    <div class="problem"><div class="content">
<title>CSES - Advertisement</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1142"/>
<div class="md"><p>A fence consists of <span class="math math-inline">n</span> vertical boards. The width of each board is 1 and their heights may vary.</p>
<p>You want to attach a rectangular advertisement to the fence. What is the maximum area of such an advertisement?</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">n</span>: the width of the fence.</p>
<p>After this, there are <span class="math math-inline">n</span> integers <span class="math math-inline">k_1,k_2,\ldots,k_n</span>: the height of each board.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the maximum area of an advertisement.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le k_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8
4 1 5 3 3 2 4 1
</pre>
<p>Output:</p>
<pre>10
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem48"></a>
    <h1>Problem 48: Subarray Divisibility</h1>
    <div class="problem"><div class="content">
<title>CSES - Hotel Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1143"/>
<div class="md"><p>There are <span class="math math-inline">n</span> hotels on a street. For each hotel you know the number of free rooms. Your task is to assign hotel rooms for groups of tourists. All members of a group want to stay in the same hotel.</p>
<p>The groups will come to you one after another, and you know for each group the number of rooms it requires. You always assign a group to the first hotel having enough rooms. After this, the number of free rooms in the hotel decreases.</p>
<h1 id="input">Input</h1>
<p>The first input line contains two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of hotels and the number of groups. The hotels are numbered <span class="math math-inline">1,2,\ldots,n</span>.</p>
<p>The next line contains <span class="math math-inline">n</span> integers <span class="math math-inline">h_1,h_2,\ldots,h_n</span>: the number of free rooms in each hotel.</p>
<p>The last line contains <span class="math math-inline">m</span> integers <span class="math math-inline">r_1,r_2,\ldots,r_m</span>: the number of rooms each group requires.</p>
<h1 id="output">Output</h1>
<p>Print the assigned hotel for each group. If a group cannot be assigned a hotel, print 0 instead.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le h_i \le 10^9</span></li>
<li><span class="math math-inline">1 \le r_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8 5
3 2 4 1 5 5 2 6
4 4 7 1 1
</pre>
<p>Output:</p>
<pre>3 5 0 1 1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem49"></a>
    <h1>Problem 49: Subarray Distinct Values</h1>
    <div class="problem"><div class="content">
<title>CSES - Salary Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1144"/>
<div class="md"><p>A company has <span class="math math-inline">n</span> employees with certain salaries. Your task is to keep track of the salaries and process queries.</p>
<h1 id="input">Input</h1>
<p>The first input line contains two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the number of employees and queries. The employees are numbered <span class="math math-inline">1,2,\ldots,n</span>.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">p_1,p_2,\ldots,p_n</span>: each employee's salary.</p>
<p>After this, there are <span class="math math-inline">q</span> lines describing the queries. Each line has one of the following forms:</p>
<ul>
<li><code>!</code> <span class="math math-inline">k</span> <span class="math math-inline">x</span>: change the salary of employee <span class="math math-inline">k</span> to <span class="math math-inline">x</span></li>
<li><code>?</code> <span class="math math-inline">a</span> <span class="math math-inline">b</span>: count the number of employees whose salary is between <span class="math math-inline">a \ldots b</span></li>
</ul>
<h1 id="output">Output</h1>
<p>Print the answer to each <code>?</code> query.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n, q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le p_i \le 10^9</span></li>
<li><span class="math math-inline">1 \le k \le n</span></li>
<li><span class="math math-inline">1 \le x \le 10^9</span></li>
<li><span class="math math-inline">1 \le a \le b \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3
3 7 2 2 5
? 2 3
! 3 6
? 2 3
</pre>
<p>Output:</p>
<pre>3
2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem50"></a>
    <h1>Problem 50: Array Division</h1>
    <div class="problem"><div class="content">
<title>CSES - Increasing Subsequence</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1145"/>
<div class="md"><p>You are given an array containing <span class="math math-inline">n</span> integers. Your task is to determine the longest increasing subsequence in the array, i.e., the longest subsequence where every element is larger than the previous one.</p>
<p>A subsequence is a sequence that can be derived from the array by deleting some elements without changing the order of the remaining elements.</p>
<h1 id="input">Input</h1>
<p>The first line contains an integer <span class="math math-inline">n</span>: the size of the array.</p>
<p>After this there are <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\ldots,x_n</span>: the contents of the array.</p>
<h1 id="output">Output</h1>
<p>Print the length of the longest increasing subsequence.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8
7 3 5 3 6 2 9 8
</pre>
<p>Output:</p>
<pre>4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem51"></a>
    <h1>Problem 51: Sliding Window Median</h1>
    <div class="problem"><div class="content">
<title>CSES - Counting Bits</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1146"/>
<div class="md"><p>Your task is to count the number of one bits in the binary representations of integers between <span class="math math-inline">1</span> and <span class="math math-inline">n</span>.</p>
<h1 id="input">Input</h1>
<p>The only input line has an integer <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print the number of one bits in the binary representations of integers between <span class="math math-inline">1</span> and <span class="math math-inline">n</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^{15}</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>7
</pre>
<p>Output:</p>
<pre>12
</pre>
<p>Explanation: The binary representations of <span class="math math-inline">1 \ldots 7</span> are 1, 10, 11, 100, 101, 110, and 111, so there are a total of 12 one bits.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem52"></a>
    <h1>Problem 52: Sliding Window Cost</h1>
    <div class="problem"><div class="content">
<title>CSES - Maximum Building I</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1147"/>
<div class="md"><p>You are given a map of a forest where some squares are empty and some squares have trees.</p>
<p>What is the maximum area of a rectangular building that can be placed in the forest so that no trees must be cut down?</p>
<h1 id="input">Input</h1>
<p>The first input line contains integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the size of the forest.</p>
<p>After this, the forest is described. Each square is empty (<code>.</code>) or has trees (<code>*</code>).</p>
<h1 id="input">Input</h1>
<p>Print the maximum area of a rectangular building.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,m \le 1000</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 7
...*.*.
.*.....
.......
......*
</pre>
<p>Output:</p>
<pre>12
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem53"></a>
    <h1>Problem 53: Movie Festival II</h1>
    <div class="problem"><div class="content">
<title>CSES - Maximum Building II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1148"/>
<div class="md"><p>You are given a map of a forest where some squares are empty and some squares have trees.</p>
<p>You want to place a rectangular building in the forest so that no trees need to be cut down. For each building size, your task is to calculate the number of ways you can do this.</p>
<h1 id="input">Input</h1>
<p>The first input line contains integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the size of the forest.</p>
<p>After this, the forest is described. Each square is empty (<code>.</code>) or has trees (<code>*</code>).</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">n</span> lines each containing <span class="math math-inline">m</span> integers.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,m \le 1000</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 7
...*.*.
.*.....
.......
......*
</pre>
<p>Output:</p>
<pre>24 17 13 9 6 3 1 
16 9 7 5 3 1 0 
9 3 2 1 0 0 0 
3 0 0 0 0 0 0
</pre>
<p>Explanation: For example, there are <span class="math math-inline">5</span> possible places for a building of size <span class="math math-inline">2 \times 4</span>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem54"></a>
    <h1>Problem 54: Maximum Subarray Sum II</h1>
    <div class="problem"><div class="content">
<title>CSES - String Removals</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1149"/>
<div class="md"><p>You are given a string. You can remove any number of characters from it, but you cannot change the order of the remaining characters.</p>
<p>How many different strings can you generate?</p>
<h1 id="input">Input</h1>
<p>The first input line contains a string of size <span class="math math-inline">n</span>. Each character is one of a–z.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of strings modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 5 \cdot 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>aybabtu
</pre>
<p>Output:</p>
<pre>103
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem55"></a>
    <h1>Problem 55: Dice Combinations</h1>
    <div class="problem"><div class="content">
<title>CSES - Number Grid</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1157"/>
<div class="md"><p>Consider a two-dimensional grid whose rows and columns are <span class="math math-inline">1</span>-indexed. Each square contains the smallest nonnegative integer that does not appear to the left on the same row or above on the same column.</p>
<p>Your task is to calculate the value at square <span class="math math-inline">(y,x)</span>.</p>
<h1 id="input">Input</h1>
<p>The only input line contains two integers <span class="math math-inline">y</span> and <span class="math math-inline">x</span>.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the value at square <span class="math math-inline">(y,x)</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le y,x \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3 5
</pre>
<p>Output:</p>
<pre>6
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem56"></a>
    <h1>Problem 56: Minimizing Coins</h1>
    <div class="problem"><div class="content">
<title>CSES - Book Shop</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1158"/>
<div class="md"><p>You are in a book shop which sells <span class="math math-inline">n</span> different books. You know the price and number of pages of each book.</p>
<p>You have decided that the total price of your purchases will be at most <span class="math math-inline">x</span>. What is the maximum number of pages you can buy? You can buy each book at most once.</p>
<h1 id="input">Input</h1>
<p>The first input line contains two integers <span class="math math-inline">n</span> and <span class="math math-inline">x</span>: the number of books and the maximum total price.</p>
<p>The next line contains <span class="math math-inline">n</span> integers <span class="math math-inline">h_1,h_2,\ldots,h_n</span>: the price of each book.</p>
<p>The last line contains <span class="math math-inline">n</span> integers <span class="math math-inline">s_1,s_2,\ldots,s_n</span>: the number of pages of each book.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the maximum number of pages.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 1000</span></li>
<li><span class="math math-inline">1 \le x \le 10^5</span></li>
<li><span class="math math-inline">1 \le h_i, s_i \le 1000</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 10
4 8 5 3
5 12 8 1
</pre>
<p>Output:</p>
<pre>13
</pre>
<p>Explanation: You can buy books 1 and 3. Their price is <span class="math math-inline">4+5=9</span> and the number of pages is <span class="math math-inline">5+8=13</span>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem57"></a>
    <h1>Problem 57: Coin Combinations I</h1>
    <div class="problem"><div class="content">
<title>CSES - Book Shop II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1159"/>
<div class="md"><p>You are in a book shop which sells <span class="math math-inline">n</span> different books. You know the price, the number of pages and the number of copies of each book.</p>
<p>You have decided that the total price of your purchases will be at most <span class="math math-inline">x</span>. What is the maximum number of pages you can buy? You can buy several copies of the same book.</p>
<h1 id="input">Input</h1>
<p>The first input line contains two integers <span class="math math-inline">n</span> and <span class="math math-inline">x</span>: the number of book and the maximum total price.</p>
<p>The next line contains <span class="math math-inline">n</span> integers <span class="math math-inline">h_1,h_2,\ldots,h_n</span>: the price of each book.</p>
<p>The next line contains <span class="math math-inline">n</span> integers <span class="math math-inline">s_1,s_2,\ldots,s_n</span>: the number of pages of each book.</p>
<p>The last line contains <span class="math math-inline">n</span> integers <span class="math math-inline">k_1,k_2,\ldots,k_n</span>: the number of copies of each book.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the maximum number of pages.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 100</span></li>
<li><span class="math math-inline">1 \le x \le 10^5</span></li>
<li><span class="math math-inline">1 \le h_i, s_i, k_i \le 1000</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3 10
2 6 3
8 5 4
3 5 2
</pre>
<p>Output:</p>
<pre>28
</pre>
<p>Explanation: You can buy three copies of book 1 and one copy of book 3. The price is <span class="math math-inline">3 \cdot 2 + 3 = 9</span> and the number of pages is <span class="math math-inline">3 \cdot 8 + 4 = 28</span>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem58"></a>
    <h1>Problem 58: Coin Combinations II</h1>
    <div class="problem"><div class="content">
<title>CSES - Planets Queries II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1160"/>
<div class="md"><p>You are playing a game consisting of n planets. Each planet has a teleporter to another planet (or the planet itself).</p>
<p>You have to process <span class="math math-inline">q</span> queries of the form: You are now on planet <span class="math math-inline">a</span> and want to reach planet <span class="math math-inline">b</span>. What is the minimum number of teleportations?</p>
<h1 id="input">Input</h1>
<p>The first input line contains two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the number of planets and queries. The planets are numbered <span class="math math-inline">1,2,\ldots,n</span>.</p>
<p>The second line contains <span class="math math-inline">n</span> integers <span class="math math-inline">t_1,t_2,\ldots,t_n</span>: for each planet, the destination of the teleporter.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: you are now on planet <span class="math math-inline">a</span> and want to reach planet <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>For each query, print the minimum number of teleportations. If it is not possible to reach the destination, print <span class="math math-inline">-1</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n, q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3
2 3 2 3 2
1 2
1 3
1 4
</pre>
<p>Output:</p>
<pre>1
2
-1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem59"></a>
    <h1>Problem 59: Removing Digits</h1>
    <div class="problem"><div class="content">
<title>CSES - Stick Divisions</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1161"/>
<div class="md"><p>You have a stick of length <span class="math math-inline">x</span> and you want to divide it into <span class="math math-inline">n</span> sticks, with given lengths, whose total length is <span class="math math-inline">x</span>.</p>
<p>On each move you can take any stick and divide it into two sticks. The cost of such an operation is the length of the original stick.</p>
<p>What is the minimum cost needed to create the sticks?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">x</span> and <span class="math math-inline">n</span>: the length of the stick and the number of sticks in the division.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">d_1,d_2,\ldots,d_n</span>: the length of each stick in the division.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum cost of the division.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le x \le 10^9</span></li>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">\sum d_i = x</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8 3
2 3 3
</pre>
<p>Output:</p>
<pre>13
</pre>
<p>Explanation: You first divide the stick of length <span class="math math-inline">8</span> into sticks of length <span class="math math-inline">3</span> and <span class="math math-inline">5</span> (cost <span class="math math-inline">8</span>). After this, you divide the stick of length <span class="math math-inline">5</span> into sticks of length <span class="math math-inline">2</span> and <span class="math math-inline">3</span> (cost <span class="math math-inline">5</span>). The total cost is <span class="math math-inline">8+5=13</span>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem60"></a>
    <h1>Problem 60: Grid Paths</h1>
    <div class="problem"><div class="content">
<title>CSES - Sorting Methods</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1162"/>
<div class="md"><p>Here are some possible methods using which we can sort the elements of an array in increasing order:</p>
<ol>
<li>At each step, choose two adjacent elements and swap them.</li>
<li>At each step, choose any two elements and swap them.</li>
<li>At each step, choose any element and move it to another position.</li>
<li>At each step, choose any element and move it to the front of the array.</li>
</ol>
<p>Given a permutation of numbers <span class="math math-inline">1,2,\ldots,n</span>, calculate the minimum number of steps to sort the array using the above methods.</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">n</span>.</p>
<p>The second line contains <span class="math math-inline">n</span> integers describing the permutation.</p>
<h1 id="output">Output</h1>
<p>Print four numbers: the minimum number of steps using each method.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8
7 8 2 6 5 1 3 4
</pre>
<p>Output:</p>
<pre>20 6 5 6
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem61"></a>
    <h1>Problem 61: Book Shop</h1>
    <div class="problem"><div class="content">
<title>CSES - Traffic Lights</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1163"/>
<div class="md"><p>There is a street of length <span class="math math-inline">x</span> whose positions are numbered <span class="math math-inline">0,1,\ldots,x</span>. Initially there are no traffic lights, but <span class="math math-inline">n</span> sets of traffic lights are added to the street one after another.</p>
<p>Your task is to calculate the length of the longest passage without traffic lights after each addition.</p>
<h1 id="input">Input</h1>
<p>The first input line contains two integers <span class="math math-inline">x</span> and <span class="math math-inline">n</span>: the length of the street and the number of sets of traffic lights.</p>
<p>Then, the next line contains <span class="math math-inline">n</span> integers <span class="math math-inline">p_1,p_2,\ldots,p_n</span>: the position of each set of traffic lights. Each position is distinct.</p>
<h1 id="output">Output</h1>
<p>Print the length of the longest passage without traffic lights after each addition.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le x \le 10^9</span></li>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">0 &lt; p_i &lt; x</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8 3
3 6 2
</pre>
<p>Output:</p>
<pre>5 3 3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem62"></a>
    <h1>Problem 62: Array Description</h1>
    <div class="problem"><div class="content">
<title>CSES - Room Allocation</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1164"/>
<div class="md"><p>There is a large hotel, and <span class="math math-inline">n</span> customers will arrive soon. Each customer wants to have a single room.</p>
<p>You know each customer's arrival and departure day. Two customers can stay in the same room if the departure day of the first customer is earlier than the arrival day of the second customer.</p>
<p>What is the minimum number of rooms that are needed to accommodate all customers? And how can the rooms be allocated?</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">n</span>: the number of customers.</p>
<p>Then there are <span class="math math-inline">n</span> lines, each of which describes one customer. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: the arrival and departure day.</p>
<h1 id="output">Output</h1>
<p>Print first an integer <span class="math math-inline">k</span>: the minimum number of rooms required.</p>
<p>After that, print a line that contains the room number of each customer in the same order as in the input. The rooms are numbered <span class="math math-inline">1,2,\ldots,k</span>. You can print any valid solution.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a \le b \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
1 2
2 4
4 4
</pre>
<p>Output:</p>
<pre>2
1 2 1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem63"></a>
    <h1>Problem 63: Counting Towers</h1>
    <div class="problem"><div class="content">
<title>CSES - Bit Inversions</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1188"/>
<div class="md"><p>There is a bit string consisting of <span class="math math-inline">n</span> bits. Then, there are some changes that invert one given bit. Your task is to report, after each change, the length of the longest substring whose each bit is the same.</p>
<h1 id="input">Input</h1>
<p>The first input line has a bit string consisting of <span class="math math-inline">n</span> bits. The bits are numbered <span class="math math-inline">1,2,\ldots,n</span>.</p>
<p>The next line contains an integer <span class="math math-inline">m</span>: the number of changes.</p>
<p>The last line contains <span class="math math-inline">m</span> integers <span class="math math-inline">x_1,x_2,\ldots,x_m</span> describing the changes.</p>
<h1 id="output">Output</h1>
<p>After each change, print the length of the longest substring whose each bit is the same.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>001011
3
3 2 5
</pre>
<p>Output:</p>
<pre>4 2 3
</pre>
<p>Explanation: The bit string first becomes <code>000011</code>, then <code>010011</code>, and finally <code>010001</code>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem64"></a>
    <h1>Problem 64: Edit Distance</h1>
    <div class="problem"><div class="content">
<title>CSES - Food Division</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1189"/>
<div class="md"><p>There are <span class="math math-inline">n</span> children around a round table. For each child, you know the amount of food they currently have and the amount of food they want. The total amount of food in the table is correct.</p>
<p>At each step, a child can give one unit of food to his or her neighbour. What is the minimum number of steps needed?</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">n</span>: the number of children.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">a_1,a_2,\ldots,a_n</span>: the current amount of food for each child.</p>
<p>The last line has <span class="math math-inline">n</span> integers <span class="math math-inline">b_1,b_2,\ldots,b_n</span>: the required amount of food for each child.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum number of steps.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">0 \le a_i, b_i \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
3 5 0
2 4 2
</pre>
<p>Output:</p>
<pre>2
</pre>
<p>Explanation: Child 1 gives one unit of food to child 3, and child 2 gives one unit of food to child 3.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem65"></a>
    <h1>Problem 65: Rectangle Cutting</h1>
    <div class="problem"><div class="content">
<title>CSES - Subarray Sum Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1190"/>
<div class="md"><p>There is an array consisting of <span class="math math-inline">n</span> integers. Some values of the array will be updated, and after each update, your task is to report the maximum subarray sum in the array.</p>
<h1 id="input">Input</h1>
<p>The first input line contains integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the size of the array and the number of updates. The array is indexed <span class="math math-inline">1,2,\ldots,n</span>.</p>
<p>The next line has <span class="math math-inline">n</span> integers: <span class="math math-inline">x_1,x_2,\ldots,x_n</span>: the initial contents of the array.</p>
<p>Then there are <span class="math math-inline">m</span> lines describing the changes. Each line has two integers <span class="math math-inline">k</span> and <span class="math math-inline">x</span>: the value at position <span class="math math-inline">k</span> becomes <span class="math math-inline">x</span>.</p>
<h1 id="output">Output</h1>
<p>After each update, print the maximum subarray sum. Empty subarrays (with sum <span class="math math-inline">0</span>) are allowed.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n, m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">-10^9 \le x_i \le 10^9</span></li>
<li><span class="math math-inline">1 \le k \le n</span></li>
<li><span class="math math-inline">-10^9 \le x \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3
1 2 -3 5 -1
2 6
3 1
2 -2
</pre>
<p>Output:</p>
<pre>9
13
6
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem66"></a>
    <h1>Problem 66: Money Sums</h1>
    <div class="problem"><div class="content">
<title>CSES - Cyclic Array</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1191"/>
<div class="md"><p>You are given a cyclic array consisting of <span class="math math-inline">n</span> values. Each element has two neighbors; the elements at positions <span class="math math-inline">n</span> and <span class="math math-inline">1</span> are also considered neighbors.</p>
<p>Your task is to divide the array into subarrays so that the sum of each subarray is at most <span class="math math-inline">k</span>. What is the minimum number of subarrays?</p>
<h1 id="input">Input</h1>
<p>The first input line contains integers <span class="math math-inline">n</span> and <span class="math math-inline">k</span>.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\ldots,x_n</span>: the contents of the array.</p>
<p>There is always at least one division (i.e., no value in the array is larger than <span class="math math-inline">k</span>).</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum number of subarrays.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
<li><span class="math math-inline">1 \le k \le 10^{18}</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8 5
2 2 2 1 3 1 2 1
</pre>
<p>Output:</p>
<pre>3
</pre>
<p>Explanation: We can create three subarrays: <span class="math math-inline">[2,2,1]</span>, <span class="math math-inline">[3,1]</span>, and <span class="math math-inline">[2,1,2]</span> (remember that the array is cyclic).</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem67"></a>
    <h1>Problem 67: Removal Game</h1>
    <div class="problem"><div class="content">
<title>CSES - Counting Rooms</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1192"/>
<div class="md"><p>You are given a map of a building, and your task is to count the number of its rooms. The size of the map is <span class="math math-inline">n \times m</span> squares, and each square is either floor or wall. You can walk left, right, up, and down through the floor squares.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the height and width of the map.</p>
<p>Then there are <span class="math math-inline">n</span> lines of <span class="math math-inline">m</span> characters describing the map. Each character is either <code>.</code> (floor) or <code>#</code> (wall).</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of rooms.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,m \le 1000</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 8
########
#..#...#
####.#.#
#..#...#
########
</pre>
<p>Output:</p>
<pre>3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem68"></a>
    <h1>Problem 68: Two Sets II</h1>
    <div class="problem"><div class="content">
<title>CSES - Labyrinth</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1193"/>
<div class="md"><p>You are given a map of a labyrinth, and your task is to find a path from start to end. You can walk left, right, up and down.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the height and width of the map.</p>
<p>Then there are <span class="math math-inline">n</span> lines of <span class="math math-inline">m</span> characters describing the labyrinth. Each character is <code>.</code> (floor), <code>#</code> (wall), <code>A</code> (start), or <code>B</code> (end). There is exactly one <code>A</code> and one <code>B</code> in the input.</p>
<h1 id="output">Output</h1>
<p>First print "YES", if there is a path, and "NO" otherwise.</p>
<p>If there is a path, print the length of the shortest such path and its description as a string consisting of characters <code>L</code> (left), <code>R</code> (right), <code>U</code> (up), and <code>D</code> (down). You can print any valid solution.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,m \le 1000</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 8
########
#.A#...#
#.##.#B#
#......#
########
</pre>
<p>Output:</p>
<pre>YES
9
LDDRRRRRU
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem69"></a>
    <h1>Problem 69: Increasing Subsequence</h1>
    <div class="problem"><div class="content">
<title>CSES - Monsters</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1194"/>
<div class="md"><p>You and some monsters are in a labyrinth. When taking a step to some direction in the labyrinth, each monster may simultaneously take one as well. Your goal is to reach one of the boundary squares without ever sharing a square with a monster.</p>
<p>Your task is to find out if your goal is possible, and if it is, print a path that you can follow. Your plan has to work in any situation; even if the monsters know your path beforehand.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the height and width of the map.</p>
<p>After this there are <span class="math math-inline">n</span> lines of <span class="math math-inline">m</span> characters describing the map. Each character is <code>.</code> (floor), <code>#</code> (wall), <code>A</code> (start), or <code>M</code> (monster). There is exactly one <code>A</code> in the input.</p>
<h1 id="output">Output</h1>
<p>First print "YES" if your goal is possible, and "NO" otherwise.</p>
<p>If your goal is possible, also print an example of a valid path (the length of the path and its description using characters <code>D</code>, <code>U</code>, <code>L</code>, and <code>R</code>). You can print any path, as long as its length is at most <span class="math math-inline">n \cdot m</span> steps.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,m \le 1000</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 8
########
#M..A..#
#.#.M#.#
#M#..#..
#.######
</pre>
<p>Output:</p>
<pre>YES
5
RRDDR
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem70"></a>
    <h1>Problem 70: Projects</h1>
    <div class="problem"><div class="content">
<title>CSES - Flight Discount</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1195"/>
<div class="md"><p>Your task is to find a minimum-price flight route from Syrjälä to Metsälä. You have one discount coupon, using which you can halve the price of any single flight during the route. However, you can only use the coupon once.</p>
<p>When you use the discount coupon for a flight whose price is <span class="math math-inline">x</span>, its price becomes <span class="math math-inline">\lfloor x/2 \rfloor</span> (it is rounded down to an integer).</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of cities and flight connections. The cities are numbered <span class="math math-inline">1,2,\ldots,n</span>. City 1 is Syrjälä, and city <span class="math math-inline">n</span> is Metsälä.</p>
<p>After this there are <span class="math math-inline">m</span> lines describing the flights. Each line has three integers <span class="math math-inline">a</span>, <span class="math math-inline">b</span>, and <span class="math math-inline">c</span>: a flight begins at city <span class="math math-inline">a</span>, ends at city <span class="math math-inline">b</span>, and its price is <span class="math math-inline">c</span>. Each flight is unidirectional.</p>
<p>You can assume that it is always possible to get from Syrjälä to Metsälä.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the price of the cheapest route from Syrjälä to Metsälä.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">2 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
<li><span class="math math-inline">1 \le c \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3 4
1 2 3
2 3 1
1 3 7
2 1 5
</pre>
<p>Output:</p>
<pre>2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem71"></a>
    <h1>Problem 71: Elevator Rides</h1>
    <div class="problem"><div class="content">
<title>CSES - Flight Routes</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1196"/>
<div class="md"><p>Your task is to find the <span class="math math-inline">k</span> shortest flight routes from Syrjälä to Metsälä. A route can visit the same city several times.</p>
<p>Note that there can be several routes with the same price and each of them should be considered (see the example).</p>
<h1 id="input">Input</h1>
<p>The first input line has three integers <span class="math math-inline">n</span>, <span class="math math-inline">m</span>, and <span class="math math-inline">k</span>: the number of cities, the number of flights, and the parameter <span class="math math-inline">k</span>. The cities are numbered <span class="math math-inline">1,2,\ldots,n</span>. City 1 is Syrjälä, and city <span class="math math-inline">n</span> is Metsälä.</p>
<p>After this, the input has <span class="math math-inline">m</span> lines describing the flights. Each line has three integers <span class="math math-inline">a</span>, <span class="math math-inline">b</span>, and <span class="math math-inline">c</span>: a flight begins at city <span class="math math-inline">a</span>, ends at city <span class="math math-inline">b</span>, and its price is <span class="math math-inline">c</span>. All flights are one-way flights.</p>
<p>You may assume that there are at least <span class="math math-inline">k</span> distinct routes from Syrjälä to Metsälä.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">k</span> integers: the prices of the <span class="math math-inline">k</span> cheapest routes sorted according to their prices.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">2 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
<li><span class="math math-inline">1 \le c \le 10^9</span></li>
<li><span class="math math-inline">1 \le k \le 10</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 6 3
1 2 1
1 3 3
2 3 2
2 4 6
3 2 8
3 4 1
</pre>
<p>Output:</p>
<pre>4 4 7
</pre>
<p>Explanation: The cheapest routes are <span class="math math-inline">1 \rightarrow 3 \rightarrow 4</span> (price <span class="math math-inline">4</span>), <span class="math math-inline">1 \rightarrow 2 \rightarrow 3 \rightarrow 4</span> (price <span class="math math-inline">4</span>) and <span class="math math-inline">1 \rightarrow 2 \rightarrow 4</span> (price <span class="math math-inline">7</span>).</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem72"></a>
    <h1>Problem 72: Counting Tilings</h1>
    <div class="problem"><div class="content">
<title>CSES - Cycle Finding</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1197"/>
<div class="md"><p>You are given a directed graph, and your task is to find out if it contains a negative cycle, and also give an example of such a cycle.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of nodes and edges. The nodes are numbered <span class="math math-inline">1,2,\ldots,n</span>.</p>
<p>After this, the input has <span class="math math-inline">m</span> lines describing the edges. Each line has three integers <span class="math math-inline">a</span>, <span class="math math-inline">b</span>, and <span class="math math-inline">c</span>: there is an edge from node <span class="math math-inline">a</span> to node <span class="math math-inline">b</span> whose length is <span class="math math-inline">c</span>.</p>
<h1 id="output">Output</h1>
<p>If the graph contains a negative cycle, print first "YES", and then the nodes in the cycle in their correct order. If there are several negative cycles, you can print any of them. If there are no negative cycles, print "NO".</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2500</span></li>
<li><span class="math math-inline">1 \le m \le 5000</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
<li><span class="math math-inline">-10^9 \le c \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 5
1 2 1
2 4 1
3 1 1
4 1 -3
4 3 -2
</pre>
<p>Output:</p>
<pre>YES
1 2 4 1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem73"></a>
    <h1>Problem 73: Counting Numbers</h1>
    <div class="problem"><div class="content">
<title>CSES - Investigation</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1202"/>
<div class="md"><p>You are going to travel from Syrjälä to Lehmälä by plane. You would like to find answers to the following questions:</p>
<ul>
<li>what is the minimum price of such a route?</li>
<li>how many minimum-price routes are there? (modulo <span class="math math-inline">10^9+7)</span></li>
<li>what is the minimum number of flights in a minimum-price route?</li>
<li>what is the maximum number of flights in a minimum-price route?</li>
</ul>
<h1 id="input">Input</h1>
<p>The first input line contains two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of cities and the number of flights. The cities are numbered <span class="math math-inline">1,2,\ldots,n</span>. City 1 is Syrjälä, and city <span class="math math-inline">n</span> is Lehmälä.</p>
<p>After this, there are <span class="math math-inline">m</span> lines describing the flights. Each line has three integers <span class="math math-inline">a</span>, <span class="math math-inline">b</span>, and <span class="math math-inline">c</span>: there is a flight from city <span class="math math-inline">a</span> to city <span class="math math-inline">b</span> with price <span class="math math-inline">c</span>. All flights are one-way flights.</p>
<p>You may assume that there is a route from Syrjälä to Lehmälä.</p>
<h1 id="output">Output</h1>
<p>Print four integers according to the problem statement.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
<li><span class="math math-inline">1 \le c \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 5
1 4 5
1 2 4
2 4 5
1 3 2
3 4 3
</pre>
<p>Output:</p>
<pre>5 2 1 2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem74"></a>
    <h1>Problem 74: Counting Rooms</h1>
    <div class="problem"><div class="content">
<title>CSES - Visiting Cities</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1203"/>
<div class="md"><p>You want to travel from Syrjälä to Lehmälä by plane using a minimum-price route. Which cities will you certainly visit?</p>
<h1 id="input">Input</h1>
<p>The first input line contains two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of cities and the number of flights. The cities are numbered <span class="math math-inline">1,2,\ldots,n</span>. City 1 is Syrjälä, and city <span class="math math-inline">n</span> is Lehmälä.</p>
<p>After this, there are <span class="math math-inline">m</span> lines describing the flights. Each line has three integers <span class="math math-inline">a</span>, <span class="math math-inline">b</span>, and <span class="math math-inline">c</span>: there is a flight from city <span class="math math-inline">a</span> to city <span class="math math-inline">b</span> with price <span class="math math-inline">c</span>. All flights are one-way flights.</p>
<p>You may assume that there is a route from Syrjälä to Lehmälä.</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math math-inline">k</span>: the number of cities that are certainly in the route. After this, print the <span class="math math-inline">k</span> cities sorted in increasing order.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
<li><span class="math math-inline">1 \le c \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 6
1 2 3
1 3 4
2 3 1
2 4 5
3 4 1
4 5 8
</pre>
<p>Output:</p>
<pre>4
1 3 4 5
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem75"></a>
    <h1>Problem 75: Labyrinth</h1>
    <div class="problem"><div class="content">
<title>CSES - Bit Strings</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1617"/>
<div class="md"><p>Your task is to calculate the number of bit strings of length <span class="math math-inline">n</span>.</p>
<p>For example, if <span class="math math-inline">n=3</span>, the correct answer is <span class="math math-inline">8</span>, because the possible bit strings are 000, 001, 010, 011, 100, 101, 110, and 111.</p>
<h1 id="input">Input</h1>
<p>The only input line has an integer <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print the result modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
</pre>
<p>Output:</p>
<pre>8
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem76"></a>
    <h1>Problem 76: Building Roads</h1>
    <div class="problem"><div class="content">
<title>CSES - Trailing Zeros</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1618"/>
<div class="md"><p>Your task is to calculate the number of trailing zeros in the factorial <span class="math math-inline">n!</span>.</p>
<p>For example, <span class="math math-inline">20!=2432902008176640000</span> and it has <span class="math math-inline">4</span> trailing zeros.</p>
<h1 id="input">Input</h1>
<p>The only input line has an integer <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print the number of trailing zeros in <span class="math math-inline">n!</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>20
</pre>
<p>Output:</p>
<pre>4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem77"></a>
    <h1>Problem 77: Message Route</h1>
    <div class="problem"><div class="content">
<title>CSES - Restaurant Customers</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1619"/>
<div class="md"><p>You are given the arrival and leaving times of <span class="math math-inline">n</span> customers in a restaurant.</p>
<p>What was the maximum number of customers in the restaurant at any time?</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of customers.</p>
<p>After this, there are <span class="math math-inline">n</span> lines that describe the customers. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: the arrival and leaving times of a customer.</p>
<p>You may assume that all arrival and leaving times are distinct.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the maximum number of customers.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a &lt; b \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
5 8
2 4
3 9
</pre>
<p>Output:</p>
<pre>2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem78"></a>
    <h1>Problem 78: Building Teams</h1>
    <div class="problem"><div class="content">
<title>CSES - Factory Machines</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1620"/>
<div class="md"><p>A factory has <span class="math math-inline">n</span> machines which can be used to make products. Your goal is to make a total of <span class="math math-inline">t</span> products.</p>
<p>For each machine, you know the number of seconds it needs to make a single product. The machines can work simultaneously, and you can freely decide their schedule.</p>
<p>What is the shortest time needed to make <span class="math math-inline">t</span> products?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">t</span>: the number of machines and products.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">k_1,k_2,\dots,k_n</span>: the time needed to make a product using each machine.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum time needed to make <span class="math math-inline">t</span> products.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le t \le 10^9</span></li>
<li><span class="math math-inline">1 \le k_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3 7
3 2 5
</pre>
<p>Output:</p>
<pre>8
</pre>
<p>Explanation: Machine 1 makes two products, machine 2 makes four products and machine 3 makes one product.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem79"></a>
    <h1>Problem 79: Round Trip</h1>
    <div class="problem"><div class="content">
<title>CSES - Distinct Numbers</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1621"/>
<div class="md"><p>You are given a list of <span class="math math-inline">n</span> integers, and your task is to calculate the number of <em>distinct</em> values in the list.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of values.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>.</p>
<h1 id="output">Output</h1>
<p>Print one integers: the number of distinct values.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
2 3 2 2 3
</pre>
<p>Output:</p>
<pre>2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem80"></a>
    <h1>Problem 80: Monsters</h1>
    <div class="problem"><div class="content">
<title>CSES - Creating Strings</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1622"/>
<div class="md"><p>Given a string, your task is to generate all different strings that can be created using its characters.</p>
<h1 id="input">Input</h1>
<p>The only input line has a string of length <span class="math math-inline">n</span>. Each character is between a–z.</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math math-inline">k</span>: the number of strings. Then print <span class="math math-inline">k</span> lines: the strings in alphabetical order.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 8</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>aabac
</pre>
<p>Output:</p>
<pre>20
aaabc
aaacb
aabac
aabca
aacab
aacba
abaac
abaca
abcaa
acaab
acaba
acbaa
baaac
baaca
bacaa
bcaaa
caaab
caaba
cabaa
cbaaa
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem81"></a>
    <h1>Problem 81: Shortest Routes I</h1>
    <div class="problem"><div class="content">
<title>CSES - Apple Division</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1623"/>
<div class="md"><p>There are <span class="math math-inline">n</span> apples with known weights. Your task is to divide the apples into two groups so that the difference between the weights of the groups is minimal.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of apples.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">p_1,p_2,\dots,p_n</span>: the weight of each apple.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum difference between the weights of the groups.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 20</span></li>
<li><span class="math math-inline">1 \le p_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
3 2 7 4 1
</pre>
<p>Output:</p>
<pre>1
</pre>
<p>Explanation: Group 1 has weights 2, 3 and 4 (total weight 9), and group 2 has weights 1 and 7 (total weight 8).</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem82"></a>
    <h1>Problem 82: Shortest Routes II</h1>
    <div class="problem"><div class="content">
<title>CSES - Chessboard and Queens</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1624"/>
<div class="md"><p>Your task is to place eight queens on a chessboard so that no two queens are attacking each other. As an additional challenge, each square is either free or reserved, and you can only place queens on the free squares. However, the reserved squares do not prevent queens from attacking each other.</p>
<p>How many possible ways are there to place the queens?</p>
<h1 id="input">Input</h1>
<p>The input has eight lines, and each of them has eight characters. Each square is either free (<code>.</code>) or reserved (<code>*</code>).</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of ways you can place the queens.</p>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>........
........
..*.....
........
........
.....**.
...*....
........
</pre>
<p>Output:</p>
<pre>65
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem83"></a>
    <h1>Problem 83: High Score</h1>
    <div class="problem"><div class="content">
<title>CSES - Grid Paths</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1625"/>
<div class="md"><p>There are <span class="math math-inline">88418</span> paths in a <span class="math math-inline">7 \times 7</span> grid from the upper-left square to the lower-left square. Each path corresponds to a <span class="math math-inline">48</span>-character description consisting of characters <code>D</code> (down), <code>U</code> (up), <code>L</code> (left) and <code>R</code> (right).</p>
<p>For example, the path
<center><img alt="" class="invertible" src="/file/3624b569007eb03818b6611755f1bdbe4cdbd0a8334baf9fedc5365914bdd661"/></center>
corresponds to the description <code>DRURRRRRDDDLUULDDDLDRRURDDLLLLLURULURRUULDLLDDDD</code>.</p>
<p>You are given a description of a path which may also contain characters <code>?</code> (any direction). Your task is to calculate the number of paths that match the description.</p>
<h1 id="input">Input</h1>
<p>The only input line has a <span class="math math-inline">48</span>-character string of characters <code>?</code>, <code>D</code>, <code>U</code>, <code>L</code> and <code>R</code>.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the total number of paths.</p>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>??????R??????U??????????????????????????LD????D?
</pre>
<p>Output:</p>
<pre>201
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem84"></a>
    <h1>Problem 84: Flight Discount</h1>
    <div class="problem"><div class="content">
<title>CSES - Meet in the Middle</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1628"/>
<div class="md"><p>You are given an array of <span class="math math-inline">n</span> numbers. In how many ways can you choose a subset of the numbers with sum <span class="math math-inline">x</span>?</p>
<h1 id="input">Input</h1>
<p>The first input line has two numbers <span class="math math-inline">n</span> and <span class="math math-inline">x</span>: the array size and the required sum.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">t_1,t_2,\dots,t_n</span>: the numbers in the array.</p>
<h1 id="output">Output</h1>
<p>Print the number of ways you can create the sum <span class="math math-inline">x</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 40</span></li>
<li><span class="math math-inline">1 \le x \le 10^9</span></li>
<li><span class="math math-inline">1 \le t_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 5
1 2 3 2
</pre>
<p>Output:</p>
<pre>3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem85"></a>
    <h1>Problem 85: Cycle Finding</h1>
    <div class="problem"><div class="content">
<title>CSES - Movie Festival</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1629"/>
<div class="md"><p>In a movie festival <span class="math math-inline">n</span> movies will be shown. You know the starting and ending time of each movie. What is the maximum number of movies you can watch entirely?</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of movies.</p>
<p>After this, there are <span class="math math-inline">n</span> lines that describe the movies. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: the starting and ending times of a movie.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the maximum number of movies.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a &lt; b \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
3 5
4 9
5 8
</pre>
<p>Output:</p>
<pre>2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem86"></a>
    <h1>Problem 86: Flight Routes</h1>
    <div class="problem"><div class="content">
<title>CSES - Tasks and Deadlines</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1630"/>
<div class="md"><p>You have to process <span class="math math-inline">n</span> tasks. Each task has a duration and a deadline, and you will process the tasks in some order one after another. Your reward for a task is <span class="math math-inline">d-f</span> where <span class="math math-inline">d</span> is its deadline and <span class="math math-inline">f</span> is your finishing time. (The starting time is <span class="math math-inline">0</span>, and you have to process all tasks even if a task would yield negative reward.)</p>
<p>What is your maximum reward if you act optimally?</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of tasks.</p>
<p>After this, there are <span class="math math-inline">n</span> lines that describe the tasks. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">d</span>: the duration and deadline of the task.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the maximum reward.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,d \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
6 10
8 15
5 12
</pre>
<p>Output:</p>
<pre>2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem87"></a>
    <h1>Problem 87: Round Trip II</h1>
    <div class="problem"><div class="content">
<title>CSES - Reading Books</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1631"/>
<div class="md"><p>There are <span class="math math-inline">n</span> books, and Kotivalo and Justiina are going to read them all. For each book, you know the time it takes to read it.</p>
<p>They both read each book from beginning to end, and they cannot read a book at the same time. What is the minimum total time required?</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of books.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">t_1,t_2,\dots,t_n</span>: the time required to read each book.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum total time.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le t_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
2 8 3
</pre>
<p>Output:</p>
<pre>16
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem88"></a>
    <h1>Problem 88: Course Schedule</h1>
    <div class="problem"><div class="content">
<title>CSES - Movie Festival II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1632"/>
<div class="md"><p>In a movie festival, <span class="math math-inline">n</span> movies will be shown. Syrjälä's movie club consists of <span class="math math-inline">k</span> members, who will be all attending the festival.</p>
<p>You know the starting and ending time of each movie. What is the maximum total number of movies the club members can watch entirely if they act optimally?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">k</span>: the number of movies and club members.</p>
<p>After this, there are <span class="math math-inline">n</span> lines that describe the movies. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: the starting and ending time of a movie.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the maximum total number of movies.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le k \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a &lt; b \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 2
1 5
8 10
3 6
2 5
6 9
</pre>
<p>Output:</p>
<pre>4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem89"></a>
    <h1>Problem 89: Longest Flight Route</h1>
    <div class="problem"><div class="content">
<title>CSES - Dice Combinations</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1633"/>
<div class="md"><p>Your task is to count the number of ways to construct sum <span class="math math-inline">n</span> by throwing a dice one or more times. Each throw produces an outcome between <span class="math math-inline">1</span> and  <span class="math math-inline">6</span>.</p>
<p>For example, if <span class="math math-inline">n=3</span>, there are <span class="math math-inline">4</span> ways:</p>
<ul>
<li><span class="math math-inline">1+1+1</span></li>
<li><span class="math math-inline">1+2</span></li>
<li><span class="math math-inline">2+1</span></li>
<li><span class="math math-inline">3</span></li>
</ul>
<h1 id="input">Input</h1>
<p>The only input line has an integer <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print the number of ways modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
</pre>
<p>Output:</p>
<pre>4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem90"></a>
    <h1>Problem 90: Game Routes</h1>
    <div class="problem"><div class="content">
<title>CSES - Minimizing Coins</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1634"/>
<div class="md"><p>Consider a money system consisting of <span class="math math-inline">n</span> coins. Each coin has a positive integer value. Your task is to produce a sum of money <span class="math math-inline">x</span> using the available coins in such a way that the number of coins is minimal.</p>
<p>For example, if the coins are <span class="math math-inline">\{1,5,7\}</span> and the desired sum is <span class="math math-inline">11</span>, an optimal solution is <span class="math math-inline">5+5+1</span> which requires <span class="math math-inline">3</span> coins.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">x</span>: the number of coins and the desired sum of money.</p>
<p>The second line has <span class="math math-inline">n</span> distinct integers <span class="math math-inline">c_1,c_2,\dots,c_n</span>: the value of each coin.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum number of coins. If it is not possible to produce the desired sum, print <span class="math math-inline">-1</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 100</span></li>
<li><span class="math math-inline">1 \le x \le 10^6</span></li>
<li><span class="math math-inline">1 \le c_i \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3 11
1 5 7
</pre>
<p>Output:</p>
<pre>3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem91"></a>
    <h1>Problem 91: Investigation</h1>
    <div class="problem"><div class="content">
<title>CSES - Coin Combinations I</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1635"/>
<div class="md"><p>Consider a money system consisting of <span class="math math-inline">n</span> coins. Each coin has a positive integer value. Your task is to calculate the number of distinct ways you can produce a money sum <span class="math math-inline">x</span> using the available coins.</p>
<p>For example, if the coins are <span class="math math-inline">\{2,3,5\}</span> and the desired sum is <span class="math math-inline">9</span>, there are <span class="math math-inline">8</span> ways:</p>
<ul>
<li><span class="math math-inline">2+2+5</span></li>
<li><span class="math math-inline">2+5+2</span></li>
<li><span class="math math-inline">5+2+2</span></li>
<li><span class="math math-inline">3+3+3</span></li>
<li><span class="math math-inline">2+2+2+3</span></li>
<li><span class="math math-inline">2+2+3+2</span></li>
<li><span class="math math-inline">2+3+2+2</span></li>
<li><span class="math math-inline">3+2+2+2</span></li>
</ul>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">x</span>: the number of coins and the desired sum of money.</p>
<p>The second line has <span class="math math-inline">n</span> distinct integers <span class="math math-inline">c_1,c_2,\dots,c_n</span>: the value of each coin.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of ways modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 100</span></li>
<li><span class="math math-inline">1 \le x \le 10^6</span></li>
<li><span class="math math-inline">1 \le c_i \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3 9
2 3 5
</pre>
<p>Output:</p>
<pre>8
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem92"></a>
    <h1>Problem 92: Planets Queries I</h1>
    <div class="problem"><div class="content">
<title>CSES - Coin Combinations II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1636"/>
<div class="md"><p>Consider a money system consisting of <span class="math math-inline">n</span> coins. Each coin has a positive integer value. Your task is to calculate the number of distinct <em>ordered</em> ways you can produce a money sum <span class="math math-inline">x</span> using the available coins.</p>
<p>For example, if the coins are <span class="math math-inline">\{2,3,5\}</span> and the desired sum is <span class="math math-inline">9</span>, there are <span class="math math-inline">3</span> ways:</p>
<ul>
<li><span class="math math-inline">2+2+5</span></li>
<li><span class="math math-inline">3+3+3</span></li>
<li><span class="math math-inline">2+2+2+3</span></li>
</ul>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">x</span>: the number of coins and the desired sum of money.</p>
<p>The second line has <span class="math math-inline">n</span> distinct integers <span class="math math-inline">c_1,c_2,\dots,c_n</span>: the value of each coin.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of ways modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 100</span></li>
<li><span class="math math-inline">1 \le x \le 10^6</span></li>
<li><span class="math math-inline">1 \le c_i \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3 9
2 3 5
</pre>
<p>Output:</p>
<pre>3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem93"></a>
    <h1>Problem 93: Planets Queries II</h1>
    <div class="problem"><div class="content">
<title>CSES - Removing Digits</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1637"/>
<div class="md"><p>You are given an integer <span class="math math-inline">n</span>. On each step, you may subtract one of the digits from the number.</p>
<p>How many steps are required to make the number equal to <span class="math math-inline">0</span>?</p>
<h1 id="input">Input</h1>
<p>The only input line has an integer <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum number of steps.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>27
</pre>
<p>Output:</p>
<pre>5
</pre>
<p>Explanation: An optimal solution is <span class="math math-inline">27 \rightarrow 20 \rightarrow 18 \rightarrow 10 \rightarrow 9 \rightarrow 0</span>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem94"></a>
    <h1>Problem 94: Planets Cycles</h1>
    <div class="problem"><div class="content">
<title>CSES - Grid Paths</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1638"/>
<div class="md"><p>Consider an <span class="math math-inline">n \times n</span> grid whose squares may have traps. It is not allowed to move to a square with a trap.</p>
<p>Your task is to calculate the number of paths from the upper-left square to the lower-right square. You can only move right or down.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the size of the grid.</p>
<p>After this, there are <span class="math math-inline">n</span> lines that describe the grid. Each line has <span class="math math-inline">n</span> characters: <code>.</code> denotes an empty cell, and <code>*</code> denotes a trap.</p>
<h1 id="output">Output</h1>
<p>Print the number of paths modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 1000</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4
....
.*..
...*
*...
</pre>
<p>Output:</p>
<pre>3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem95"></a>
    <h1>Problem 95: Road Reparation</h1>
    <div class="problem"><div class="content">
<title>CSES - Edit Distance</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1639"/>
<div class="md"><p>The <em>edit distance</em> between two strings is the minimum number of operations required to transform one string into the other.</p>
<p>The allowed operations are:</p>
<ul>
<li>Add one character to the string.</li>
<li>Remove one character from the string.</li>
<li>Replace one character in the string.</li>
</ul>
<p>For example, the edit distance between LOVE and MOVIE is 2, because you can first replace L with M, and then add I.</p>
<p>Your task is to calculate the edit distance between two strings.</p>
<h1 id="input">Input</h1>
<p>The first input line has a string that contains <span class="math math-inline">n</span> characters between A–Z.</p>
<p>The second input line has a string that contains <span class="math math-inline">m</span> characters between A–Z.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the edit distance between the strings.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,m \le 5000</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>LOVE
MOVIE
</pre>
<p>Output:</p>
<pre>2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem96"></a>
    <h1>Problem 96: Road Construction</h1>
    <div class="problem"><div class="content">
<title>CSES - Sum of Two Values</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1640"/>
<div class="md"><p>You are given an array of <span class="math math-inline">n</span> integers, and your task is to find two values (at distinct positions) whose sum is <span class="math math-inline">x</span>.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">x</span>: the array size and the target sum.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">a_1,a_2,\dots,a_n</span>: the array values.</p>
<h1 id="output">Output</h1>
<p>Print two integers: the positions of the values. If there are several solutions, you may print any of them. If there are no solutions, print <code>IMPOSSIBLE</code>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x,a_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 8
2 7 5 1
</pre>
<p>Output:</p>
<pre>2 4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem97"></a>
    <h1>Problem 97: Flight Routes Check</h1>
    <div class="problem"><div class="content">
<title>CSES - Sum of Three Values</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1641"/>
<div class="md"><p>You are given an array of <span class="math math-inline">n</span> integers, and your task is to find three values (at distinct positions) whose sum is <span class="math math-inline">x</span>.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">x</span>: the array size and the target sum.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">a_1,a_2,\dots,a_n</span>: the array values.</p>
<h1 id="output">Output</h1>
<p>Print three integers: the positions of the values. If there are several solutions, you may print any of them. If there are no solutions, print <code>IMPOSSIBLE</code>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 5000</span></li>
<li><span class="math math-inline">1 \le x,a_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 8
2 7 5 1
</pre>
<p>Output:</p>
<pre>1 3 4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem98"></a>
    <h1>Problem 98: Planets and Kingdoms</h1>
    <div class="problem"><div class="content">
<title>CSES - Sum of Four Values</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1642"/>
<div class="md"><p>You are given an array of <span class="math math-inline">n</span> integers, and your task is to find four values (at distinct positions) whose sum is <span class="math math-inline">x</span>.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">x</span>: the array size and the target sum.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">a_1,a_2,\dots,a_n</span>: the array values.</p>
<h1 id="output">Output</h1>
<p>Print four integers: the positions of the values. If there are several solutions, you may print any of them. If there are no solutions, print <code>IMPOSSIBLE</code>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 1000</span></li>
<li><span class="math math-inline">1 \le x,a_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8 15
3 2 5 8 1 3 2 3
</pre>
<p>Output:</p>
<pre>2 4 6 7
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem99"></a>
    <h1>Problem 99: Giant Pizza</h1>
    <div class="problem"><div class="content">
<title>CSES - Maximum Subarray Sum</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1643"/>
<div class="md"><p>Given an array of <span class="math math-inline">n</span> integers, your task is to find the maximum sum of values in a contiguous, nonempty subarray.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the size of the array.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the array values.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the maximum subarray sum.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">-10^9 \le x_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8
-1 3 -2 5 3 -5 2 2
</pre>
<p>Output:</p>
<pre>9
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem100"></a>
    <h1>Problem 100: Coin Collector</h1>
    <div class="problem"><div class="content">
<title>CSES - Maximum Subarray Sum II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1644"/>
<div class="md"><p>Given an array of <span class="math math-inline">n</span> integers, your task is to find the maximum sum of values in a contiguous subarray with length between <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<h1 id="input">Input</h1>
<p>The first input line has three integers <span class="math math-inline">n</span>, <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: the size of the array and the minimum and maximum subarray length.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the array values.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the maximum subarray sum.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a \le b \le n</span></li>
<li><span class="math math-inline">-10^9 \le x_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8 1 2
-1 3 -2 5 3 -5 2 2
</pre>
<p>Output:</p>
<pre>8
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem101"></a>
    <h1>Problem 101: Mail Delivery</h1>
    <div class="problem"><div class="content">
<title>CSES - Nearest Smaller Values</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1645"/>
<div class="md"><p>Given an array of <span class="math math-inline">n</span> integers, your task is to find for each array position the nearest position to its left having a smaller value.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the size of the array.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the array values.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">n</span> integers: for each array position the nearest position with a smaller value. If there is no such position, print <span class="math math-inline">0</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8
2 5 1 4 8 3 2 5
</pre>
<p>Output:</p>
<pre>0 1 0 3 4 3 3 7
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem102"></a>
    <h1>Problem 102: De Bruijn Sequence</h1>
    <div class="problem"><div class="content">
<title>CSES - Static Range Sum Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1646"/>
<div class="md"><p>Given an array of <span class="math math-inline">n</span> integers, your task is to process <span class="math math-inline">q</span> queries of the form: what is the sum of values in range <span class="math math-inline">[a,b]</span>?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the number of values and queries.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the array values.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: what is the sum of values in range <span class="math math-inline">[a,b]</span>?</p>
<h1 id="output">Output</h1>
<p>Print the result of each query.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
<li><span class="math math-inline">1 \le a \le b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8 4
3 2 4 5 1 1 5 3
2 4
5 6
1 8
3 3
</pre>
<p>Output:</p>
<pre>11
2
24
4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem103"></a>
    <h1>Problem 103: Teleporters Path</h1>
    <div class="problem"><div class="content">
<title>CSES - Static Range Minimum Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1647"/>
<div class="md"><p>Given an array of <span class="math math-inline">n</span> integers, your task is to process <span class="math math-inline">q</span> queries of the form: what is the minimum value in range <span class="math math-inline">[a,b]</span>?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the number of values and queries.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the array values.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: what is the minimum value in range <span class="math math-inline">[a,b]</span>?</p>
<h1 id="output">Output</h1>
<p>Print the result of each query.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
<li><span class="math math-inline">1 \le a \le b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8 4
3 2 4 5 1 1 5 3
2 4
5 6
1 8
3 3
</pre>
<p>Output:</p>
<pre>2
1
1
4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem104"></a>
    <h1>Problem 104: Hamiltonian Flights</h1>
    <div class="problem"><div class="content">
<title>CSES - Dynamic Range Sum Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1648"/>
<div class="md"><p>Given an array of <span class="math math-inline">n</span> integers, your task is to process <span class="math math-inline">q</span> queries of the following types:</p>
<ol>
<li>update the value at position <span class="math math-inline">k</span> to <span class="math math-inline">u</span></li>
<li>what is the sum of values in range <span class="math math-inline">[a,b]</span>?</li>
</ol>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the number of values and queries.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the array values.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. Each line has three integers: either "<span class="math math-inline">1</span> <span class="math math-inline">k</span> <span class="math math-inline">u</span>" or "<span class="math math-inline">2</span> <span class="math math-inline">a</span> <span class="math math-inline">b</span>".</p>
<h1 id="output">Output</h1>
<p>Print the result of each query of type 2.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i, u \le 10^9</span></li>
<li><span class="math math-inline">1 \le k \le n</span></li>
<li><span class="math math-inline">1 \le a \le b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8 4
3 2 4 5 1 1 5 3
2 1 4
2 5 6
1 3 1
2 1 4
</pre>
<p>Output:</p>
<pre>14
2
11
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem105"></a>
    <h1>Problem 105: Knight's Tour</h1>
    <div class="problem"><div class="content">
<title>CSES - Dynamic Range Minimum Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1649"/>
<div class="md"><p>Given an array of <span class="math math-inline">n</span> integers, your task is to process <span class="math math-inline">q</span> queries of the following types:</p>
<ol>
<li>update the value at position <span class="math math-inline">k</span> to <span class="math math-inline">u</span></li>
<li>what is the minimum value in range <span class="math math-inline">[a,b]</span>?</li>
</ol>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the number of values and queries.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the array values.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. Each line has three integers: either "<span class="math math-inline">1</span> <span class="math math-inline">k</span> <span class="math math-inline">u</span>" or "<span class="math math-inline">2</span> <span class="math math-inline">a</span> <span class="math math-inline">b</span>".</p>
<h1 id="output">Output</h1>
<p>Print the result of each query of type 2.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i, u \le 10^9</span></li>
<li><span class="math math-inline">1 \le k \le n</span></li>
<li><span class="math math-inline">1 \le a \le b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8 4
3 2 4 5 1 1 5 3
2 1 4
2 5 6
1 2 3
2 1 4
</pre>
<p>Output:</p>
<pre>2
1
3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem106"></a>
    <h1>Problem 106: Download Speed</h1>
    <div class="problem"><div class="content">
<title>CSES - Range Xor Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1650"/>
<div class="md"><p>Given an array of <span class="math math-inline">n</span> integers, your task is to process <span class="math math-inline">q</span> queries of the form: what is the xor sum of values in range <span class="math math-inline">[a,b]</span>?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the number of values and queries.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the array values.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: what is the xor sum of values in range <span class="math math-inline">[a,b]</span>?</p>
<h1 id="output">Output</h1>
<p>Print the result of each query.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
<li><span class="math math-inline">1 \le a \le b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8 4
3 2 4 5 1 1 5 3
2 4
5 6
1 8
3 3
</pre>
<p>Output:</p>
<pre>3
0
6
4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem107"></a>
    <h1>Problem 107: Police Chase</h1>
    <div class="problem"><div class="content">
<title>CSES - Range Update Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1651"/>
<div class="md"><p>Given an array of <span class="math math-inline">n</span> integers, your task is to process <span class="math math-inline">q</span> queries of the following types:</p>
<ol>
<li>increase each value in range <span class="math math-inline">[a,b]</span> by <span class="math math-inline">u</span></li>
<li>what is the value at position <span class="math math-inline">k</span>?</li>
</ol>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the number of values and queries.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the array values.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. Each line has three integers: either "<span class="math math-inline">1</span> <span class="math math-inline">a</span> <span class="math math-inline">b</span> <span class="math math-inline">u</span>" or "<span class="math math-inline">2</span> <span class="math math-inline">k</span>".</p>
<h1 id="output">Output</h1>
<p>Print the result of each query of type 2.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i, u \le 10^9</span></li>
<li><span class="math math-inline">1 \le k \le n</span></li>
<li><span class="math math-inline">1 \le a \le b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8 3
3 2 4 5 1 1 5 3
2 4
1 2 5 1
2 4
</pre>
<p>Output:</p>
<pre>5
6
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem108"></a>
    <h1>Problem 108: School Dance</h1>
    <div class="problem"><div class="content">
<title>CSES - Forest Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1652"/>
<div class="md"><p>You are given an <span class="math math-inline">n \times n</span> grid representing the map of a forest. Each square is either empty or contains a tree. The upper-left square has coordinates <span class="math math-inline">(1,1)</span>, and the lower-right square has coordinates <span class="math math-inline">(n,n)</span>.</p>
<p>Your task is to process <span class="math math-inline">q</span> queries of the form: how many trees are inside a given rectangle in the forest?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the size of the forest and the number of queries.</p>
<p>Then, there are <span class="math math-inline">n</span> lines describing the forest. Each line has <span class="math math-inline">n</span> characters: <code>.</code> is an empty square and <code>*</code> is a tree.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. Each line has four integers <span class="math math-inline">y_1</span>, <span class="math math-inline">x_1</span>, <span class="math math-inline">y_2</span>, <span class="math math-inline">x_2</span> corresponding to the corners of a rectangle.</p>
<h1 id="output">Output</h1>
<p>Print the number of trees inside each rectangle.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 1000</span></li>
<li><span class="math math-inline">1 \le q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le y_1 \le y_2 \le n</span></li>
<li><span class="math math-inline">1 \le x_1 \le x_2 \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 3
.*..
*.**
**..
****
2 2 3 4
3 1 3 1
1 1 2 2
</pre>
<p>Output:</p>
<pre>3
1
2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem109"></a>
    <h1>Problem 109: Distinct Routes</h1>
    <div class="problem"><div class="content">
<title>CSES - Elevator Rides</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1653"/>
<div class="md"><p>There are <span class="math math-inline">n</span> people who want to get to the top of a building which has only one elevator. You know the weight of each person and the maximum allowed weight in the elevator. What is the minimum number of elevator rides?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">x</span>: the number of people and the maximum allowed weight in the elevator.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">w_1,w_2,\dots,w_n</span>: the weight of each person.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum number of rides.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 20</span></li>
<li><span class="math math-inline">1 \le x \le 10^9</span></li>
<li><span class="math math-inline">1 \le w_i \le x</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 10
4 8 6 1
</pre>
<p>Output:</p>
<pre>2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem110"></a>
    <h1>Problem 110: Static Range Sum Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - Bit Problem</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1654"/>
<div class="md"><p>Given a list of <span class="math math-inline">n</span> integers, your task is to calculate for each element <span class="math math-inline">x</span>:</p>
<ol>
<li>the number of elements <span class="math math-inline">y</span> such that <span class="math math-inline">x \mid y = x</span></li>
<li>the number of elements <span class="math math-inline">y</span> such that <span class="math math-inline">x \mathrel{\&amp;} y = x</span></li>
<li>the number of elements <span class="math math-inline">y</span> such that <span class="math math-inline">x \mathrel{\&amp;} y \neq 0</span></li>
</ol>
<h1 id="input">Input</h1>
<p>The first line has an integer <span class="math math-inline">n</span>: the size of the list.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the elements of the list.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">n</span> lines: for each element the required values.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
3 7 2 9 2
</pre>
<p>Output:</p>
<pre>3 2 5
4 1 5
2 4 4
1 1 3
2 4 4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem111"></a>
    <h1>Problem 111: Static Range Minimum Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - Maximum Xor Subarray</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1655"/>
<div class="md"><p>Given an array of <span class="math math-inline">n</span> integers, your task is to find the maximum xor sum of a subarray.</p>
<h1 id="input">Input</h1>
<p>The first line has an integer <span class="math math-inline">n</span>: the size of the array.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the contents of the array.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the maximum xor sum in a subarray.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">0 \le x_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4
5 1 5 9
</pre>
<p>Output:</p>
<pre>13
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem112"></a>
    <h1>Problem 112: Dynamic Range Sum Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - Subarray Sums I</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1660"/>
<div class="md"><p>Given an array of <span class="math math-inline">n</span> positive integers, your task is to count the number of subarrays having sum <span class="math math-inline">x</span>.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">x</span>: the size of the array and the target sum <span class="math math-inline">x</span>.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">a_1,a_2,\dots,a_n</span>: the contents of the array.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the required number of subarrays.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x,a_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 7
2 4 1 2 7
</pre>
<p>Output:</p>
<pre>3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem113"></a>
    <h1>Problem 113: Dynamic Range Minimum Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - Subarray Sums II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1661"/>
<div class="md"><p>Given an array of <span class="math math-inline">n</span> integers, your task is to count the number of subarrays having sum <span class="math math-inline">x</span>.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">x</span>: the size of the array and the target sum <span class="math math-inline">x</span>.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">a_1,a_2,\dots,a_n</span>: the contents of the array.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the required number of subarrays.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">-10^9 \le x,a_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 7
2 -1 3 5 -2
</pre>
<p>Output:</p>
<pre>2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem114"></a>
    <h1>Problem 114: Range Xor Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - Subarray Divisibility</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1662"/>
<div class="md"><p>Given an array of <span class="math math-inline">n</span> integers, your task is to count the number of subarrays where the sum of values is divisible by <span class="math math-inline">n</span>.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the size of the array.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">a_1,a_2,\dots,a_n</span>: the contents of the array.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the required number of subarrays.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">-10^9 \le a_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
3 1 2 7 4
</pre>
<p>Output:</p>
<pre>1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem115"></a>
    <h1>Problem 115: Range Update Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - Movie Festival Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1664"/>
<div class="md"><p>In a movie festival, <span class="math math-inline">n</span> movies will be shown. You know the starting and ending time of each movie.</p>
<p>Your task is to process <span class="math math-inline">q</span> queries of the form: if you arrive and leave the festival at specific times, what is the maximum number of movies you can watch?</p>
<p>You can watch two movies if the first movie ends before or exactly when the second movie starts. You can start the first movie exactly when you arrive and leave exactly when the last movie ends.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the number of movies and queries.</p>
<p>After this, there are <span class="math math-inline">n</span> lines describing the movies. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: the starting and ending time of a movie.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: your arrival and leaving time.</p>
<h1 id="output">Output</h1>
<p>Print the maximum number of movies for each query.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a &lt; b \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 3
2 5
6 10
4 7
9 10
5 9
2 10
7 10
</pre>
<p>Output:</p>
<pre>0
2
1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem116"></a>
    <h1>Problem 116: Forest Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - Coding Company</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1665"/>
<div class="md"><p>Your company has <span class="math math-inline">n</span> coders, and each of them has a skill level between <span class="math math-inline">0</span> and <span class="math math-inline">100</span>. Your task is to divide the coders into teams that work together.</p>
<p>Based on your experience, you know that teams work well when the skill levels of the coders are about the same. For this reason, the penalty for creating a team is the skill level difference between the best and the worst coder.</p>
<p>In how many ways can you divide the coders into teams such that the sum of the penalties is at most <span class="math math-inline">x</span>?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">x</span>: the number of coders and the maximum allowed penalty sum.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">t_1,t_2,\dots,t_n</span>: the skill level of each coder.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of valid divisions modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 100</span></li>
<li><span class="math math-inline">0 \le x \le 5000</span></li>
<li><span class="math math-inline">0 \le t_i \le 100</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3 2
2 5 3
</pre>
<p>Output:</p>
<pre>3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem117"></a>
    <h1>Problem 117: Hotel Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - Building Roads</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1666"/>
<div class="md"><p>Byteland has <span class="math math-inline">n</span> cities, and <span class="math math-inline">m</span> roads between them. The goal is to construct new roads so that there is a route between any two cities.</p>
<p>Your task is to find out the minimum number of roads required, and also determine which roads should be built.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of cities and roads. The cities are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>After that, there are <span class="math math-inline">m</span> lines describing the roads. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is a road between those cities.</p>
<p>A road always connects two different cities, and there is at most one road between any two cities.</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math math-inline">k</span>: the number of required roads.</p>
<p>Then, print <span class="math math-inline">k</span> lines that describe the new roads. You can print any valid solution.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 2
1 2
3 4
</pre>
<p>Output:</p>
<pre>1
2 3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem118"></a>
    <h1>Problem 118: List Removals</h1>
    <div class="problem"><div class="content">
<title>CSES - Message Route</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1667"/>
<div class="md"><p>Syrjälä's network has <span class="math math-inline">n</span> computers and <span class="math math-inline">m</span> connections. Your task is to find out if Uolevi can send a message to Maija, and if it is possible, what is the minimum number of computers on such a route.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of computers and connections. The computers are numbered <span class="math math-inline">1,2,\dots,n</span>. Uolevi's computer is <span class="math math-inline">1</span> and Maija's computer is <span class="math math-inline">n</span>.</p>
<p>Then, there are <span class="math math-inline">m</span> lines describing the connections. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is a connection between those computers.</p>
<p>Every connection is between two different computers, and there is at most one connection between any two computers.</p>
<h1 id="output">Output</h1>
<p>If it is possible to send a message, first print <span class="math math-inline">k</span>: the minimum number of computers on a valid route. After this, print an example of such a route. You can print any valid solution.</p>
<p>If there are no routes, print "IMPOSSIBLE".</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">2 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 5
1 2
1 3
1 4
2 3
5 4
</pre>
<p>Output:</p>
<pre>3
1 4 5
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem119"></a>
    <h1>Problem 119: Salary Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - Building Teams</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1668"/>
<div class="md"><p>There are <span class="math math-inline">n</span> pupils in Uolevi's class, and <span class="math math-inline">m</span> friendships between them. Your task is to divide the pupils into two teams in such a way that no two pupils in a team are friends. You can freely choose the sizes of the teams.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of pupils and friendships. The pupils are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>Then, there are <span class="math math-inline">m</span> lines describing the friendships. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: pupils <span class="math math-inline">a</span> and <span class="math math-inline">b</span> are friends.</p>
<p>Every friendship is between two different pupils. You can assume that there is at most one friendship between any two pupils.</p>
<h1 id="output">Output</h1>
<p>Print an example of how to build the teams. For each pupil, print "1" or "2" depending on to which team the pupil will be assigned. You can print any valid team.</p>
<p>If there are no solutions, print "IMPOSSIBLE".</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3
1 2
1 3
4 5
</pre>
<p>Output:</p>
<pre>1 2 2 1 2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem120"></a>
    <h1>Problem 120: Prefix Sum Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - Round Trip</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1669"/>
<div class="md"><p>Byteland has <span class="math math-inline">n</span> cities and <span class="math math-inline">m</span> roads between them. Your task is to design a round trip that begins in a city, goes through two or more other cities, and finally returns to the starting city. Every intermediate city on the route has to be distinct.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of cities and roads. The cities are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>Then, there are <span class="math math-inline">m</span> lines describing the roads. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is a road between those cities.</p>
<p>Every road is between two different cities, and there is at most one road between any two cities.</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math math-inline">k</span>: the number of cities on the route. Then print <span class="math math-inline">k</span> cities in the order they will be visited. You can print any valid solution.</p>
<p>If there are no solutions, print "IMPOSSIBLE".</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 6
1 3
1 2
5 3
1 5
2 4
4 5
</pre>
<p>Output:</p>
<pre>4
3 5 1 3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem121"></a>
    <h1>Problem 121: Pizzeria Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - Swap Game</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1670"/>
<div class="md"><p>You are given a <span class="math math-inline">3 \times 3</span> grid containing the numbers <span class="math math-inline">1,2,\dots,9</span>. Your task is to perform a sequence of moves so that the grid will look like this:
<span class="math math-display">
\begin{matrix}
1 &amp; 2 &amp; 3 \\
4 &amp; 5 &amp; 6 \\
7 &amp; 8 &amp; 9 \\
\end{matrix}
</span>
On each move, you can swap the numbers in any two adjacent squares (horizontally or vertically). What is the minimum number of moves required?</p>
<h1 id="input">Input</h1>
<p>The input has three lines, and each of them has three integers.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum number of moves.</p>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>2 1 3
7 5 9
8 4 6
</pre>
<p>Output:</p>
<pre>4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem122"></a>
    <h1>Problem 122: Subarray Sum Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - Shortest Routes I</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1671"/>
<div class="md"><p>There are <span class="math math-inline">n</span> cities and <span class="math math-inline">m</span> flight connections between them. Your task is to determine the length of the shortest route from Syrjälä to every city.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of cities and flight connections. The cities are numbered <span class="math math-inline">1,2,\dots,n</span>, and city <span class="math math-inline">1</span> is Syrjälä.</p>
<p>After that, there are <span class="math math-inline">m</span> lines describing the flight connections. Each line has three integers <span class="math math-inline">a</span>, <span class="math math-inline">b</span> and <span class="math math-inline">c</span>: a flight begins at city <span class="math math-inline">a</span>, ends at city <span class="math math-inline">b</span>, and its length is <span class="math math-inline">c</span>. Each flight is a one-way flight.</p>
<p>You can assume that it is possible to travel from Syrjälä to all other cities.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">n</span> integers: the shortest route lengths from Syrjälä to cities <span class="math math-inline">1,2,\dots,n</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
<li><span class="math math-inline">1 \le c \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3 4
1 2 6
1 3 2
3 2 3
1 3 4
</pre>
<p>Output:</p>
<pre>0 5 2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem123"></a>
    <h1>Problem 123: Distinct Values Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - Shortest Routes II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1672"/>
<div class="md"><p>There are <span class="math math-inline">n</span> cities and <span class="math math-inline">m</span> roads between them. Your task is to process <span class="math math-inline">q</span> queries where you have to determine the length of the shortest route between two given cities.</p>
<h1 id="input">Input</h1>
<p>The first input line has three integers <span class="math math-inline">n</span>, <span class="math math-inline">m</span> and <span class="math math-inline">q</span>: the number of cities, roads, and queries.</p>
<p>Then, there are <span class="math math-inline">m</span> lines describing the roads. Each line has three integers <span class="math math-inline">a</span>, <span class="math math-inline">b</span> and <span class="math math-inline">c</span>: there is a road between cities <span class="math math-inline">a</span> and <span class="math math-inline">b</span> whose length is <span class="math math-inline">c</span>. All roads are two-way roads.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: determine the length of the shortest route between cities <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>Print the length of the shortest route for each query. If there is no route, print <span class="math math-inline">-1</span> instead.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 500</span></li>
<li><span class="math math-inline">1 \le m \le n^2</span></li>
<li><span class="math math-inline">1 \le q \le 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
<li><span class="math math-inline">1 \le c \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 3 5
1 2 5
1 3 9
2 3 3
1 2
2 1
1 3
1 4
3 2
</pre>
<p>Output:</p>
<pre>5
5
8
-1
3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem124"></a>
    <h1>Problem 124: Increasing Array Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - High Score</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1673"/>
<div class="md"><p>You play a game consisting of <span class="math math-inline">n</span> rooms and <span class="math math-inline">m</span> tunnels. Your initial score is <span class="math math-inline">0</span>, and each tunnel increases your score by <span class="math math-inline">x</span> where <span class="math math-inline">x</span> may be both positive or negative. You may go through a tunnel several times.</p>
<p>Your task is to walk from room <span class="math math-inline">1</span> to room <span class="math math-inline">n</span>. What is the maximum score you can get?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of rooms and tunnels. The rooms are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>Then, there are <span class="math math-inline">m</span> lines describing the tunnels. Each line has three integers <span class="math math-inline">a</span>, <span class="math math-inline">b</span> and <span class="math math-inline">x</span>: the tunnel starts at room <span class="math math-inline">a</span>, ends at room <span class="math math-inline">b</span>, and it increases your score by <span class="math math-inline">x</span>. All tunnels are one-way tunnels.</p>
<p>You can assume that it is possible to get from room <span class="math math-inline">1</span> to room <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the maximum score you can get. However, if you can get an arbitrarily large score, print <span class="math math-inline">-1</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2500</span></li>
<li><span class="math math-inline">1 \le m \le 5000</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
<li><span class="math math-inline">-10^9 \le x \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 5
1 2 3
2 4 -1
1 3 -2
3 4 7
1 4 4
</pre>
<p>Output:</p>
<pre>5
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem125"></a>
    <h1>Problem 125: Forest Queries II</h1>
    <div class="problem"><div class="content">
<title>CSES - Subordinates</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1674"/>
<div class="md"><p>Given the structure of a company, your task is to calculate for each employee the number of their subordinates.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of employees. The employees are numbered <span class="math math-inline">1,2,\dots,n</span>, and employee <span class="math math-inline">1</span> is the general director of the company.</p>
<p>After this, there are <span class="math math-inline">n-1</span> integers: for each employee <span class="math math-inline">2,3,\dots,n</span> their direct boss in the company.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">n</span> integers: for each employee <span class="math math-inline">1,2,\dots,n</span> the number of their subordinates.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
1 1 2 3
</pre>
<p>Output:</p>
<pre>4 1 1 0 0
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem126"></a>
    <h1>Problem 126: Range Updates and Sums</h1>
    <div class="problem"><div class="content">
<title>CSES - Road Reparation</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 128 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1675"/>
<div class="md"><p>There are <span class="math math-inline">n</span> cities and <span class="math math-inline">m</span> roads between them. Unfortunately, the condition of the roads is so poor that they cannot be used. Your task is to repair some of the roads so that there will be a decent route between any two cities.</p>
<p>For each road, you know its reparation cost, and you should find a solution where the total cost is as small as possible.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of cities and roads. The cities are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>Then, there are <span class="math math-inline">m</span> lines describing the roads. Each line has three integers <span class="math math-inline">a</span>, <span class="math math-inline">b</span> and <span class="math math-inline">c</span>: there is a road between cities <span class="math math-inline">a</span> and <span class="math math-inline">b</span>, and its reparation cost is <span class="math math-inline">c</span>. All roads are two-way roads.</p>
<p>Every road is between two different cities, and there is at most one road between two cities.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum total reparation cost. However, if there are no solutions, print "IMPOSSIBLE".</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
<li><span class="math math-inline">1 \le c \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 6
1 2 3
2 3 5
2 4 2
3 4 8
5 1 7
5 4 4
</pre>
<p>Output:</p>
<pre>14
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem127"></a>
    <h1>Problem 127: Polynomial Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - Road Construction</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1676"/>
<div class="md"><p>There are <span class="math math-inline">n</span> cities and initially no roads between them. However, every day a new road will be constructed, and there will be a total of <span class="math math-inline">m</span> roads.</p>
<p>A component is a group of cities where there is a route between any two cities using the roads. After each day, your task is to find the number of components and the size of the largest component.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of cities and roads. The cities are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>Then, there are <span class="math math-inline">m</span> lines describing the new roads. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: a new road is constructed between cities <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<p>You may assume that every road will be constructed between two different cities.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">m</span> lines: the required information after each day.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3
1 2
1 3
4 5
</pre>
<p>Output:</p>
<pre>4 2
3 3
2 3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem128"></a>
    <h1>Problem 128: Range Queries and Copies</h1>
    <div class="problem"><div class="content">
<title>CSES - Network Breakdown</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1677"/>
<div class="md"><p>Syrjälä's network has <span class="math math-inline">n</span> computers and <span class="math math-inline">m</span> connections between them. The network consists of components of computers that can send messages to each other.</p>
<p>Nobody in Syrjälä understands how the network works. For this reason, if a connection breaks down, nobody will repair it. In this situation a component may be divided into two components.</p>
<p>Your task is to calculate the number of components after each connection breakdown.</p>
<h1 id="input">Input</h1>
<p>The first input line has three integers <span class="math math-inline">n</span>, <span class="math math-inline">m</span> and <span class="math math-inline">k</span>: the number of computers, connections and breakdowns. The computers are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>Then, there are <span class="math math-inline">m</span> lines describing the connections. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is a connection between computers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>. Each connection is between two different computers, and there is at most one connection between two computers.</p>
<p>Finally, there are <span class="math math-inline">k</span> lines describing the breakdowns. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: the connection between computers <span class="math math-inline">a</span> and <span class="math math-inline">b</span> breaks down.</p>
<h1 id="output">Output</h1>
<p>After each breakdown, print the number of components.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le k \le m</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 5 3
1 2
1 3
2 3
3 4
4 5
3 4
2 3
4 5
</pre>
<p>Output:</p>
<pre>2 2 3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem129"></a>
    <h1>Problem 129: Subordinates</h1>
    <div class="problem"><div class="content">
<title>CSES - Round Trip II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1678"/>
<div class="md"><p>Byteland has <span class="math math-inline">n</span> cities and <span class="math math-inline">m</span> flight connections. Your task is to design a round trip that begins in a city, goes through one or more other cities, and finally returns to the starting city. Every intermediate city on the route has to be distinct.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of cities and flights. The cities are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>Then, there are <span class="math math-inline">m</span> lines describing the flights. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is a flight connection from city <span class="math math-inline">a</span> to city <span class="math math-inline">b</span>. All connections are one-way flights from a city to another city.</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math math-inline">k</span>: the number of cities on the route. Then print <span class="math math-inline">k</span> cities in the order they will be visited. You can print any valid solution.</p>
<p>If there are no solutions, print "IMPOSSIBLE".</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 5
1 3
2 1
2 4
3 2
3 4
</pre>
<p>Output:</p>
<pre>4
2 1 3 2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem130"></a>
    <h1>Problem 130: Tree Matching</h1>
    <div class="problem"><div class="content">
<title>CSES - Course Schedule</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1679"/>
<div class="md"><p>You have to complete <span class="math math-inline">n</span> courses. There are <span class="math math-inline">m</span> requirements of the form "course <span class="math math-inline">a</span> has to be completed before course <span class="math math-inline">b</span>". Your task is to find an order in which you can complete the courses.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of courses and requirements. The courses are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>After this, there are <span class="math math-inline">m</span> lines describing the requirements. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: course <span class="math math-inline">a</span> has to be completed before course <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>Print an order in which you can complete the courses. You can print any valid order that includes all the courses.</p>
<p>If there are no solutions, print "IMPOSSIBLE".</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3
1 2
3 1
4 5
</pre>
<p>Output:</p>
<pre>3 4 1 5 2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem131"></a>
    <h1>Problem 131: Tree Diameter</h1>
    <div class="problem"><div class="content">
<title>CSES - Longest Flight Route</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1680"/>
<div class="md"><p>Uolevi has won a contest, and the prize is a free flight trip that can consist of one or more flights through cities. Of course, Uolevi wants to choose a trip that has as many cities as possible.</p>
<p>Uolevi wants to fly from Syrjälä to Lehmälä so that he visits the maximum number of cities. You are given the list of possible flights, and you know that there are no directed cycles in the flight network.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of cities and flights. The cities are numbered <span class="math math-inline">1,2,\dots,n</span>. City <span class="math math-inline">1</span> is Syrjälä, and city <span class="math math-inline">n</span> is Lehmälä.</p>
<p>After this, there are <span class="math math-inline">m</span> lines describing the flights. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is a flight from city <span class="math math-inline">a</span> to city <span class="math math-inline">b</span>. Each flight is a one-way flight.</p>
<h1 id="output">Output</h1>
<p>First print the maximum number of cities on the route. After this, print the cities in the order they will be visited. You can print any valid solution.</p>
<p>If there are no solutions, print "IMPOSSIBLE".</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">2 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 5
1 2
2 5
1 3
3 4
4 5
</pre>
<p>Output:</p>
<pre>4
1 3 4 5
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem132"></a>
    <h1>Problem 132: Tree Distances I</h1>
    <div class="problem"><div class="content">
<title>CSES - Game Routes</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1681"/>
<div class="md"><p>A game has <span class="math math-inline">n</span> levels, connected by <span class="math math-inline">m</span> teleporters, and your task is to get from level <span class="math math-inline">1</span> to level <span class="math math-inline">n</span>. The game has been designed so that there are no directed cycles in the underlying graph. In how many ways can you complete the game?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of levels and teleporters. The levels are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>After this, there are <span class="math math-inline">m</span> lines describing the teleporters. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is a teleporter from level <span class="math math-inline">a</span> to level <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of ways you can complete the game. Since the result may be large, print it modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 5
1 2
2 4
1 3
3 4
1 4
</pre>
<p>Output:</p>
<pre>3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem133"></a>
    <h1>Problem 133: Tree Distances II</h1>
    <div class="problem"><div class="content">
<title>CSES - Flight Routes Check</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1682"/>
<div class="md"><p>There are <span class="math math-inline">n</span> cities and <span class="math math-inline">m</span> flight connections. Your task is to check if you can travel from any city to any other city using the available flights.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of cities and flights. The cities are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>After this, there are <span class="math math-inline">m</span> lines describing the flights. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is a flight from city <span class="math math-inline">a</span> to city <span class="math math-inline">b</span>. All flights are one-way flights.</p>
<h1 id="output">Output</h1>
<p>Print "YES" if all routes are possible, and "NO" otherwise. In the latter case also print two cities <span class="math math-inline">a</span> and <span class="math math-inline">b</span> such that you cannot travel from city <span class="math math-inline">a</span> to city <span class="math math-inline">b</span>. If there are several possible solutions, you can print any of them.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 5
1 2
2 3
3 1
1 4
3 4
</pre>
<p>Output:</p>
<pre>NO
4 2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem134"></a>
    <h1>Problem 134: Company Queries I</h1>
    <div class="problem"><div class="content">
<title>CSES - Planets and Kingdoms</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1683"/>
<div class="md"><p>A game has <span class="math math-inline">n</span> planets, connected by <span class="math math-inline">m</span> teleporters. Two planets <span class="math math-inline">a</span> and <span class="math math-inline">b</span> belong to the same kingdom exactly when there is a route both from <span class="math math-inline">a</span> to <span class="math math-inline">b</span> and from <span class="math math-inline">b</span> to <span class="math math-inline">a</span>. Your task is to determine for each planet its kingdom.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of planets and teleporters. The planets are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>After this, there are <span class="math math-inline">m</span> lines describing the teleporters. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: you can travel from planet <span class="math math-inline">a</span> to planet <span class="math math-inline">b</span> through a teleporter.</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math math-inline">k</span>: the number of kingdoms. After this, print for each planet a kingdom label between <span class="math math-inline">1</span> and <span class="math math-inline">k</span>. You can print any valid solution.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 6
1 2
2 3
3 1
3 4
4 5
5 4
</pre>
<p>Output:</p>
<pre>2
1 1 1 2 2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem135"></a>
    <h1>Problem 135: Company Queries II</h1>
    <div class="problem"><div class="content">
<title>CSES - Giant Pizza</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1684"/>
<div class="md"><p>Uolevi's family is going to order a large pizza and eat it together. A total of <span class="math math-inline">n</span> family members will join the order, and there are <span class="math math-inline">m</span> possible toppings. The pizza may have any number of toppings.</p>
<p>Each family member gives two wishes concerning the toppings of the pizza. The wishes are of the form "topping <span class="math math-inline">x</span> is good/bad". Your task is to choose the toppings so that at least one wish from everybody becomes true (a good topping is included in the pizza or a bad topping is not included).</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of family members and toppings. The toppings are numbered <span class="math math-inline">1,2,\dots,m</span>.</p>
<p>After this, there are <span class="math math-inline">n</span> lines describing the wishes. Each line has two wishes of the form "+ <span class="math math-inline">x</span>" (topping <span class="math math-inline">x</span> is good) or "- <span class="math math-inline">x</span>" (topping <span class="math math-inline">x</span> is bad).</p>
<h1 id="output">Output</h1>
<p>Print a line with <span class="math math-inline">m</span> symbols: for each topping "+" if it is included and "-" if it is not included. You can print any valid solution.</p>
<p>If there are no valid solutions, print "IMPOSSIBLE".</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,m \le 10^5</span></li>
<li><span class="math math-inline">1 \le x \le m</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3 5
+ 1 + 2
- 1 + 3
+ 4 - 2
</pre>
<p>Output:</p>
<pre>- + + + -
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem136"></a>
    <h1>Problem 136: Distance Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - New Flight Routes</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1685"/>
<div class="md"><p>There are <span class="math math-inline">n</span> cities and <span class="math math-inline">m</span> flight connections between them. Your task is to add new flights so that it will be possible to travel from any city to any other city. What is the minimum number of new flights required?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of cities and flights. The cities are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>After this, there are <span class="math math-inline">m</span> lines describing the flights. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is a flight from city <span class="math math-inline">a</span> to city <span class="math math-inline">b</span>. All flights are one-way flights.</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math math-inline">k</span>: the required number of new flights. After this, print <span class="math math-inline">k</span> lines describing the new flights. You can print any valid solution.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 5
1 2
2 3
3 1
1 4
3 4
</pre>
<p>Output:</p>
<pre>1
4 2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem137"></a>
    <h1>Problem 137: Counting Paths</h1>
    <div class="problem"><div class="content">
<title>CSES - Coin Collector</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1686"/>
<div class="md"><p>A game has <span class="math math-inline">n</span> rooms and <span class="math math-inline">m</span> tunnels between them. Each room has a certain number of coins. What is the maximum number of coins you can collect while moving through the tunnels when you can freely choose your starting and ending room?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of rooms and tunnels. The rooms are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>Then, there are <span class="math math-inline">n</span> integers <span class="math math-inline">k_1,k_2,\ldots,k_n</span>: the number of coins in each room.</p>
<p>Finally, there are <span class="math math-inline">m</span> lines describing the tunnels. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is a tunnel from room <span class="math math-inline">a</span> to room <span class="math math-inline">b</span>. Each tunnel is a one-way tunnel.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the maximum number of coins you can collect.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le k_i \le 10^9</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 4
4 5 2 7
1 2
2 1
1 3
2 4
</pre>
<p>Output:</p>
<pre>16
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem138"></a>
    <h1>Problem 138: Subtree Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - Company Queries I</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1687"/>
<div class="md"><p>A company has <span class="math math-inline">n</span> employees, who form a tree hierarchy where each employee has a boss, except for the general director.</p>
<p>Your task is to process <span class="math math-inline">q</span> queries of the form: who is employee <span class="math math-inline">x</span>'s boss <span class="math math-inline">k</span> levels higher up in the hierarchy?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the number of employees and queries. The employees are numbered <span class="math math-inline">1,2,\dots,n</span>, and employee <span class="math math-inline">1</span> is the general director.</p>
<p>The next line has <span class="math math-inline">n-1</span> integers <span class="math math-inline">e_2,e_3,\dots,e_n</span>: for each employee <span class="math math-inline">2,3,\dots,n</span> their boss.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. Each line has two integers <span class="math math-inline">x</span> and <span class="math math-inline">k</span>: who is employee <span class="math math-inline">x</span>'s boss <span class="math math-inline">k</span> levels higher up?</p>
<h1 id="output">Output</h1>
<p>Print the answer for each query. If such a boss does not exist, print <span class="math math-inline">-1</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le e_i \le i-1</span></li>
<li><span class="math math-inline">1 \le x \le n</span></li>
<li><span class="math math-inline">1 \le k \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3
1 1 3 3
4 1
4 2
4 3
</pre>
<p>Output:</p>
<pre>3
1
-1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem139"></a>
    <h1>Problem 139: Path Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - Company Queries II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1688"/>
<div class="md"><p>A company has <span class="math math-inline">n</span> employees, who form a tree hierarchy where each employee has a boss, except for the general director.</p>
<p>Your task is to process <span class="math math-inline">q</span> queries of the form: who is the lowest common boss of employees <span class="math math-inline">a</span> and <span class="math math-inline">b</span> in the hierarchy?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the number of employees and queries. The employees are numbered <span class="math math-inline">1,2,\dots,n</span>, and employee <span class="math math-inline">1</span> is the general director.</p>
<p>The next line has <span class="math math-inline">n-1</span> integers <span class="math math-inline">e_2,e_3,\dots,e_n</span>: for each employee <span class="math math-inline">2,3,\dots,n</span> their boss.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: who is the lowest common boss of employees <span class="math math-inline">a</span> and <span class="math math-inline">b</span>?</p>
<h1 id="output">Output</h1>
<p>Print the answer for each query.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le e_i \le i-1</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3
1 1 3 3
4 5
2 5
1 4
</pre>
<p>Output:</p>
<pre>3
1
1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem140"></a>
    <h1>Problem 140: Path Queries II</h1>
    <div class="problem"><div class="content">
<title>CSES - Knight's Tour</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1689"/>
<div class="md"><p>Given a starting position of a knight on an <span class="math math-inline">8 \times 8</span> chessboard, your task is to find a sequence of moves such that it visits every square exactly once.</p>
<p>On each move, the knight may either move two steps horizontally and one step vertically, or one step horizontally and two steps vertically.</p>
<h1 id="input">Input</h1>
<p>The only line has two integers <span class="math math-inline">x</span> and <span class="math math-inline">y</span>: the knight's starting position.</p>
<h1 id="output">Output</h1>
<p>Print a grid that shows how the knight moves (according to the example). You can print any valid solution.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le x,y \le 8</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>2 1
</pre>
<p>Output:</p>
<pre>8 1 10 13 6 3 20 17 
11 14 7 2 19 16 23 4 
26 9 12 15 24 5 18 21 
49 58 25 28 51 22 33 30 
40 27 50 59 32 29 52 35 
57 48 41 44 37 34 31 62 
42 39 46 55 60 63 36 53 
47 56 43 38 45 54 61 64
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem141"></a>
    <h1>Problem 141: Distinct Colors</h1>
    <div class="problem"><div class="content">
<title>CSES - Hamiltonian Flights</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1690"/>
<div class="md"><p>There are <span class="math math-inline">n</span> cities and <span class="math math-inline">m</span> flight connections between them. You want to travel from Syrjälä to Lehmälä so that you visit each city exactly once. How many possible routes are there?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of cities and flights. The cities are numbered <span class="math math-inline">1,2,\dots,n</span>. City <span class="math math-inline">1</span> is Syrjälä, and city <span class="math math-inline">n</span> is Lehmälä.</p>
<p>Then, there are <span class="math math-inline">m</span> lines describing the flights. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is a flight from city <span class="math math-inline">a</span> to city <span class="math math-inline">b</span>. All flights are one-way flights.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of routes modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">2 \le n \le 20</span></li>
<li><span class="math math-inline">1 \le m \le n^2</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 6
1 2
1 3
2 3
3 2
2 4
3 4
</pre>
<p>Output:</p>
<pre>2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem142"></a>
    <h1>Problem 142: Finding a Centroid</h1>
    <div class="problem"><div class="content">
<title>CSES - Mail Delivery</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1691"/>
<div class="md"><p>Your task is to deliver mail to the inhabitants of a city. For this reason, you want to find a route whose starting and ending point are the post office, and that goes through every street exactly once.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of crossings and streets. The crossings are numbered <span class="math math-inline">1,\,2,\ldots,\,n</span>, and the post office is located at crossing <span class="math math-inline">1</span>.</p>
<p>After that, there are m lines describing the streets. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is a street between crossings <span class="math math-inline">a</span> and <span class="math math-inline">b</span>. All streets are two-way streets.</p>
<p>Every street is between two different crossings, and there is at most one street between two crossings.</p>
<h1 id="output">Output</h1>
<p>Print all the crossings on the route in the order you will visit them. You can print any valid solution.</p>
<p>If there are no solutions, print "IMPOSSIBLE".</p>
<h1 id="constraints">Constraints</h1>
<p><span class="math math-inline">2\leq n\leq 10^5</span><br/>
<span class="math math-inline">1\leq m\leq 2 . 10^5</span><br/>
<span class="math math-inline">1\leq a,\,b\leq n</span></p>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>6 8
1 2
1 3
2 3
2 4
2 6
3 5
3 6
4 5
</pre>
<p>Output:</p>
<pre>1 2 6 3 2 4 5 3 1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem143"></a>
    <h1>Problem 143: Fixed-Length Paths I</h1>
    <div class="problem"><div class="content">
<title>CSES - De Bruijn Sequence</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1692"/>
<div class="md"><p>Your task is to construct a minimum-length bit string that contains all possible substrings of length <span class="math math-inline">n</span>. For example, when <span class="math math-inline">n=2</span>, the string 00110 is a valid solution, because its substrings of length <span class="math math-inline">2</span> are 00, 01, 10 and 11.</p>
<h1 id="input">Input</h1>
<p>The only input line has an integer <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print a minimum-length bit string that contains all substrings of length <span class="math math-inline">n</span>. You can print any valid solution.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 15</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>2
</pre>
<p>Output:</p>
<pre>00110
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem144"></a>
    <h1>Problem 144: Fixed-Length Paths II</h1>
    <div class="problem"><div class="content">
<title>CSES - Teleporters Path</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1693"/>
<div class="md"><p>A game has <span class="math math-inline">n</span> levels and <span class="math math-inline">m</span> teleportes between them. You win the game if you move from level <span class="math math-inline">1</span> to level <span class="math math-inline">n</span> using every teleporter exactly once.</p>
<p>Can you win the game, and what is a possible way to do it?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of levels and teleporters. The levels are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>Then, there are <span class="math math-inline">m</span> lines describing the teleporters. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is a teleporter from level <span class="math math-inline">a</span> to level <span class="math math-inline">b</span>.</p>
<p>You can assume that each pair <span class="math math-inline">(a,b)</span> in the input is distinct.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">m+1</span> integers: the sequence in which you visit the levels during the game. You can print any valid solution.</p>
<p>If there are no solutions, print "IMPOSSIBLE".</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">2 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 6
1 2
1 3
2 4
2 5
3 1
4 2
</pre>
<p>Output:</p>
<pre>1 3 1 2 4 2 5
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem145"></a>
    <h1>Problem 145: Josephus Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - Download Speed</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1694"/>
<div class="md"><p>Consider a network consisting of <span class="math math-inline">n</span> computers and <span class="math math-inline">m</span> connections. Each connection specifies how fast a computer can send data to another computer.</p>
<p>Kotivalo wants to download some data from a server. What is the maximum speed he can do this, using the connections in the network?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of computers and connections. The computers are numbered <span class="math math-inline">1,2,\dots,n</span>. Computer <span class="math math-inline">1</span> is the server and computer <span class="math math-inline">n</span> is Kotivalo's computer.</p>
<p>After this, there are <span class="math math-inline">m</span> lines describing the connections. Each line has three integers <span class="math math-inline">a</span>, <span class="math math-inline">b</span> and <span class="math math-inline">c</span>: computer <span class="math math-inline">a</span> can send data to computer <span class="math math-inline">b</span> at speed <span class="math math-inline">c</span>.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the maximum speed Kotivalo can download data.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 500</span></li>
<li><span class="math math-inline">1 \le m \le 1000</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
<li><span class="math math-inline">1 \le c \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 5
1 2 3
2 4 2
1 3 4
3 4 5
4 1 3
</pre>
<p>Output:</p>
<pre>6
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem146"></a>
    <h1>Problem 146: Exponentiation</h1>
    <div class="problem"><div class="content">
<title>CSES - Police Chase</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1695"/>
<div class="md"><p>Kaaleppi has just robbed a bank and is now heading to the harbor. However, the police wants to stop him by closing some streets of the city.</p>
<p>What is the minimum number of streets that should be closed so that there is no route between the bank and the harbor?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of crossings and streets. The crossings are numbered <span class="math math-inline">1,2,\dots,n</span>. The bank is located at crossing <span class="math math-inline">1</span>, and the harbor is located at crossing <span class="math math-inline">n</span>.</p>
<p>After this, there are <span class="math math-inline">m</span> lines that describing the streets. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is a street between crossings <span class="math math-inline">a</span> and <span class="math math-inline">b</span>. All streets are two-way streets, and there is at most one street between two crossings.</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math math-inline">k</span>: the minimum number of streets that should be closed. After this, print <span class="math math-inline">k</span> lines describing the streets. You can print any valid solution.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">2 \le n \le 500</span></li>
<li><span class="math math-inline">1 \le m \le 1000</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 5
1 2
1 3
2 3
3 4
1 4
</pre>
<p>Output:</p>
<pre>2
3 4
1 4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem147"></a>
    <h1>Problem 147: Exponentiation II</h1>
    <div class="problem"><div class="content">
<title>CSES - School Dance</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1696"/>
<div class="md"><p>There are <span class="math math-inline">n</span> boys and <span class="math math-inline">m</span> girls in a school. Next week a school dance will be organized. A dance pair consists of a boy and a girl, and there are <span class="math math-inline">k</span> potential pairs.</p>
<p>Your task is to find out the maximum number of dance pairs and show how this number can be achieved.</p>
<h1 id="input">Input</h1>
<p>The first input line has three integers <span class="math math-inline">n</span>, <span class="math math-inline">m</span> and <span class="math math-inline">k</span>: the number of boys, girls, and potential pairs. The boys are numbered <span class="math math-inline">1,2,\dots,n</span>, and the girls are numbered <span class="math math-inline">1,2,\dots,m</span>.</p>
<p>After this, there are <span class="math math-inline">k</span> lines describing the potential pairs. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: boy <span class="math math-inline">a</span> and girl <span class="math math-inline">b</span> are willing to dance together.</p>
<h1 id="output">Output</h1>
<p>First print one integer <span class="math math-inline">r</span>: the maximum number of dance pairs. After this, print <span class="math math-inline">r</span> lines describing the pairs. You can print any valid solution.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,m \le 500</span></li>
<li><span class="math math-inline">1 \le k \le 1000</span></li>
<li><span class="math math-inline">1 \le a \le n</span></li>
<li><span class="math math-inline">1 \le b \le m</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3 2 4
1 1
1 2
2 1
3 1
</pre>
<p>Output:</p>
<pre>2
1 2
3 1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem148"></a>
    <h1>Problem 148: Counting Divisors</h1>
    <div class="problem"><div class="content">
<title>CSES - Chess Tournament</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1697"/>
<div class="md"><p>There will be a chess tournament of <span class="math math-inline">n</span> players. Each player has announced the number of games they want to play.</p>
<p>Each pair of players can play at most one game. Your task is to determine which games will be played so that everybody will be happy.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of players. The players are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: for each player, the number of games they want to play.</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math math-inline">k</span>: the number of games. Then, print <span class="math math-inline">k</span> lines describing the games. You can print any valid solution.</p>
<p>If there are no solutions, print "IMPOSSIBLE".</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">\sum_{i=1}^{n} x_i \le 2 \cdot 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
1 3 2 0 2
</pre>
<p>Output:</p>
<pre>4
1 2
2 3
2 5
3 5
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem149"></a>
    <h1>Problem 149: Common Divisors</h1>
    <div class="problem"><div class="content">
<title>CSES - Swap Round Sorting</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1698"/>
<div class="md"><p>You are given an array containing a permutation of numbers <span class="math math-inline">1,2,\dots,n</span>, and your task is to sort the array using <em>swap rounds</em>. On each swap round, you can choose any number of distinct pairs of elements and swap each pair.</p>
<p>Your task is to find the minimum number of rounds and show how you can choose the pairs in each round.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the size of the array.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the initial permutation.</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math math-inline">k</span>: the minimum number of rounds.</p>
<p>Then, for each round, print the number of swaps and the indices of each swap. You can print any valid solution.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
5 2 1 3 4
</pre>
<p>Output:</p>
<pre>2
2
1 3
4 5
1
3 5
</pre>
<p>Explanation: The initial array is <span class="math math-inline">[5,2,1,3,4]</span>. After round <span class="math math-inline">1</span>, the array becomes <span class="math math-inline">[1,2,5,4,3]</span>. After round <span class="math math-inline">2</span>, the array becomes <span class="math math-inline">[1,2,3,4,5]</span>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem150"></a>
    <h1>Problem 150: Sum of Divisors</h1>
    <div class="problem"><div class="content">
<title>CSES - Flight Route Requests</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1699"/>
<div class="md"><p>There are <span class="math math-inline">n</span> cities with airports but no flight connections. You are given <span class="math math-inline">m</span> requests which routes should be possible to travel.</p>
<p>Your task is to determine the minimum number of one-way flight connections which makes it possible to fulfil all requests.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of cities and requests. The cities are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>After this, there are <span class="math math-inline">m</span> lines describing the requests. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there has to be a route from city <span class="math math-inline">a</span> to city <span class="math math-inline">b</span>. Each request is unique.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum number of flight connections.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a, b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 5
1 2
2 3
2 4
3 1
3 4
</pre>
<p>Output:</p>
<pre>4
</pre>
<p>Explanation: You can create the connections <span class="math math-inline">1 \rightarrow 2</span>, <span class="math math-inline">2 \rightarrow 3</span>, <span class="math math-inline">2 \rightarrow 4</span> and <span class="math math-inline">3 \rightarrow 1</span>. Then you can also fly from city <span class="math math-inline">3</span> to city <span class="math math-inline">4</span> using the route <span class="math math-inline">3 \rightarrow 1 \rightarrow 2 \rightarrow 4</span>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem151"></a>
    <h1>Problem 151: Divisor Analysis</h1>
    <div class="problem"><div class="content">
<title>CSES - Tree Isomorphism I</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1700"/>
<div class="md"><p>Given two rooted trees, your task is to find out if they are <em>isomorphic</em>, i.e., it is possible to draw them so that they look the same.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">t</span>: the number of tests. Then, there are <span class="math math-inline">t</span> tests described as follows:</p>
<p>The first line has an integer <span class="math math-inline">n</span>: the number of nodes in both trees. The nodes are numbered <span class="math math-inline">1,2,\dots,n</span>, and node <span class="math math-inline">1</span> is the root.</p>
<p>Then, there are <span class="math math-inline">n-1</span> lines describing the edges of the first tree, and finally <span class="math math-inline">n-1</span> lines describing the edges of the second tree.</p>
<h1 id="output">Output</h1>
<p>For each test, print "YES", if the trees are isomorphic, and "NO" otherwise.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le t \le 1000</span></li>
<li><span class="math math-inline">2 \le n \le 10^5</span></li>
<li>the sum of all values of <span class="math math-inline">n</span> is at most <span class="math math-inline">10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>2
3
1 2
2 3
1 2
1 3
3
1 2
2 3
1 3
3 2
</pre>
<p>Output:</p>
<pre>NO
YES
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem152"></a>
    <h1>Problem 152: Prime Multiples</h1>
    <div class="problem"><div class="content">
<title>CSES - Tree Isomorphism II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1701"/>
<div class="md"><p>Given two (not rooted) trees, your task is to find out if they are <em>isomorphic</em>, i.e., it is possible to draw them so that they look the same.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">t</span>: the number of tests. Then, there are <span class="math math-inline">t</span> tests described as follows:</p>
<p>The first line has an integer <span class="math math-inline">n</span>: the number of nodes in both trees. The nodes are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>Then, there are <span class="math math-inline">n-1</span> lines describing the edges of the first tree, and finally <span class="math math-inline">n-1</span> lines describing the edges of the second tree.</p>
<h1 id="output">Output</h1>
<p>For each test, print "YES", if the trees are isomorphic, and "NO" otherwise.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le t \le 1000</span></li>
<li><span class="math math-inline">2 \le n \le 10^5</span></li>
<li>the sum of all values of <span class="math math-inline">n</span> is at most <span class="math math-inline">10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>2
3
1 2
2 3
1 2
1 3
3
1 2
2 3
1 3
3 2
</pre>
<p>Output:</p>
<pre>YES
YES
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem153"></a>
    <h1>Problem 153: Counting Coprime Pairs</h1>
    <div class="problem"><div class="content">
<title>CSES - Tree Traversals</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1702"/>
<div class="md"><p>There are three common ways to traverse the nodes of a binary tree:</p>
<ul>
<li><em>Preorder</em>: First process the root, then the left subtree, and finally the right subtree.</li>
<li><em>Inorder</em>: First process the left subtree, then the root, and finally the right subtree.</li>
<li><em>Postorder</em>: First process the left subtree, then the right subtree, and finally the root.</li>
</ul>
<p>There is a binary tree of <span class="math math-inline">n</span> nodes with distinct labels. You are given the preorder and inorder traversals of the tree, and your task is to determine its postorder traversal.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of nodes. The nodes are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>After this, there are two lines describing the preorder and inorder traversals of the tree. Both lines consist of <span class="math math-inline">n</span> integers.</p>
<p>You can assume that the input corresponds to a binary tree.</p>
<h1 id="output">Output</h1>
<p>Print the postorder traversal of the tree.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
5 3 2 1 4
3 5 1 2 4
</pre>
<p>Output:</p>
<pre>3 1 4 2 5
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem154"></a>
    <h1>Problem 154: Binomial Coefficients</h1>
    <div class="problem"><div class="content">
<title>CSES - Critical Cities</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1703"/>
<div class="md"><p>There are <span class="math math-inline">n</span> cities and <span class="math math-inline">m</span> flight connections between them. A city is called a <em>critical city</em> if it appears on every route from a city to another city.</p>
<p>Your task is to find all critical cities from Syrjälä to Lehmälä.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of cities and flights. The cities are numbered <span class="math math-inline">1,2,\dots,n</span>. City <span class="math math-inline">1</span> is Syrjälä, and city <span class="math math-inline">n</span> is Lehmälä.</p>
<p>Then, there are <span class="math math-inline">m</span> lines describing the connections. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is a flight from city <span class="math math-inline">a</span> to city <span class="math math-inline">b</span>. All flights are one-way.</p>
<p>You may assume that there is a route from Syrjälä to Lehmälä.</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math math-inline">k</span>: the number of critical cities. After this, print <span class="math math-inline">k</span> integers: the critical cities in increasing order.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">2 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 5
1 2
2 3
2 4
3 5
4 5
</pre>
<p>Output:</p>
<pre>3
1 2 5
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem155"></a>
    <h1>Problem 155: Creating Strings II</h1>
    <div class="problem"><div class="content">
<title>CSES - Network Renovation</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1704"/>
<div class="md"><p>Syrjälä's network consists of <span class="math math-inline">n</span> computers and <span class="math math-inline">n-1</span> connections between them. It is possible to send data between any two computers.</p>
<p>However, if any connection breaks down, it will no longer be possible to send data between some computers. Your task is to add the minimum number of new connections in such a way that you can still send data between any two computers even if any single connection breaks down.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of computers. The computers are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>After this, there are <span class="math math-inline">n-1</span> lines describing the connections. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is a connection between computers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math math-inline">k</span>: the minimum number of new connections. After this, print <span class="math math-inline">k</span> lines describing the connections. You can print any valid solution.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">3 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
1 2
1 3
3 4
3 5
</pre>
<p>Output:</p>
<pre>2
2 4
4 5
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem156"></a>
    <h1>Problem 156: Distributing Apples</h1>
    <div class="problem"><div class="content">
<title>CSES - Forbidden Cities</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1705"/>
<div class="md"><p>There are <span class="math math-inline">n</span> cities and <span class="math math-inline">m</span> roads between them. Kaaleppi is currently in city <span class="math math-inline">a</span> and wants to travel to city <span class="math math-inline">b</span>.</p>
<p>However, there is a problem: Kaaleppi has recently robbed a bank in city <span class="math math-inline">c</span> and can't enter the city, because the local police would catch him. Your task is to find out if there is a route from city <span class="math math-inline">a</span> to city <span class="math math-inline">b</span> that does not visit city <span class="math math-inline">c</span>.</p>
<p>As an additional challenge, you have to process <span class="math math-inline">q</span> queries where <span class="math math-inline">a</span>, <span class="math math-inline">b</span> and <span class="math math-inline">c</span> vary.</p>
<h1 id="input">Input</h1>
<p>The first input line has three integers <span class="math math-inline">n</span>, <span class="math math-inline">m</span> and <span class="math math-inline">q</span>: the number of cities, roads and queries. The cities are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>Then, there are <span class="math math-inline">m</span> lines describing the roads. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is a road between cities <span class="math math-inline">a</span> and <span class="math math-inline">b</span>. Each road is bidirectional.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. Each line has three integers <span class="math math-inline">a</span>, <span class="math math-inline">b</span> and <span class="math math-inline">c</span>: is there a route from city <span class="math math-inline">a</span> to city <span class="math math-inline">b</span> that does not visit city <span class="math math-inline">c</span>?</p>
<p>You can assume that there is a route between any two cities.</p>
<h1 id="output">Output</h1>
<p>For each query, print "YES", if there is such a route, and "NO" otherwise.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le q \le 10^5</span></li>
<li><span class="math math-inline">1 \le a,b,c \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 6 3
1 2
1 3
2 3
2 4
3 4
4 5
1 4 2
3 5 4
3 5 2
</pre>
<p>Output:</p>
<pre>YES
NO
YES
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem157"></a>
    <h1>Problem 157: Christmas Party</h1>
    <div class="problem"><div class="content">
<title>CSES - School Excursion</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1706"/>
<div class="md"><p>A group of <span class="math math-inline">n</span> children are coming to Helsinki. There are two possible attractions: a child can visit either Korkeasaari (zoo) or Linnanmäki (amusement park).</p>
<p>There are <span class="math math-inline">m</span> pairs of children who want to visit the same attraction. Your task is to find all possible alternatives for the number of children that will visit Korkeasaari. The children's wishes have to be taken into account.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of children and their wishes. The children are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>After this, there are <span class="math math-inline">m</span> lines describing the children's wishes. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: children <span class="math math-inline">a</span> and <span class="math math-inline">b</span> want to visit the same attraction.</p>
<h1 id="output">Output</h1>
<p>Print a bit string of length <span class="math math-inline">n</span> where a one-bit at index <span class="math math-inline">i</span> indicates that it is possible that exactly <span class="math math-inline">i</span> children visit Korkeasaari (the bit string is to be considered one-indexed).</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">0 \le m \le 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3
1 2
2 3
1 5
</pre>
<p>Output:</p>
<pre>10011
</pre>
<p>Explanation: The number of children visiting Korkeasaari can be <span class="math math-inline">1</span>, <span class="math math-inline">4</span> or <span class="math math-inline">5</span>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem158"></a>
    <h1>Problem 158: Bracket Sequences I</h1>
    <div class="problem"><div class="content">
<title>CSES - Graph Girth</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1707"/>
<div class="md"><p>Given an undirected graph, your task is to determine its <em>girth</em>, i.e., the length of its shortest cycle.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of nodes and edges. The nodes are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>After this, there are <span class="math math-inline">m</span> lines describing the edges. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<p>You may assume that there is at most one edge between each two nodes.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the girth of the graph. If there are no cycles, print <span class="math math-inline">-1</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2500</span></li>
<li><span class="math math-inline">1 \le m \le 5000</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 6
1 2
1 3
2 4
2 5
3 4
4 5
</pre>
<p>Output:</p>
<pre>3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem159"></a>
    <h1>Problem 159: Bracket Sequences II</h1>
    <div class="problem"><div class="content">
<title>CSES - Coin Grid</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1709"/>
<div class="md"><p>There is an <span class="math math-inline">n \times n</span> grid whose each square is empty or has a coin. On each move, you can remove all coins in a row or column.</p>
<p>What is the minimum number of moves after which the grid is empty?</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the size of the grid. The rows and columns are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>After this, there are <span class="math math-inline">n</span> lines describing the grid. Each line has <span class="math math-inline">n</span> characters: each character is either <code>.</code> (empty) or <code>o</code> (coin).</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math math-inline">k</span>: the minimum number of moves. After this, print <span class="math math-inline">k</span> lines describing the moves.</p>
<p>On each line, first print <span class="math math-inline">1</span> (row) or <span class="math math-inline">2</span> (column), and then the number of a row or column. You can print any valid solution.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 100</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
..o
o.o
...
</pre>
<p>Output:</p>
<pre>2
1 2
2 3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem160"></a>
    <h1>Problem 160: Counting Necklaces</h1>
    <div class="problem"><div class="content">
<title>CSES - Distinct Routes</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1711"/>
<div class="md"><p>A game consists of <span class="math math-inline">n</span> rooms and <span class="math math-inline">m</span> teleporters. At the beginning of each day, you start in room <span class="math math-inline">1</span> and you have to reach room <span class="math math-inline">n</span>.</p>
<p>You can use each teleporter at most once during the game. How many days can you play if you choose your routes optimally?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of rooms and teleporters. The rooms are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>After this, there are <span class="math math-inline">m</span> lines describing the teleporters. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is a teleporter from room <span class="math math-inline">a</span> to room <span class="math math-inline">b</span>.</p>
<p>There are no two teleporters whose starting and ending room are the same.</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math math-inline">k</span>: the maximum number of days you can play the game. Then, print <span class="math math-inline">k</span> route descriptions according to the example. You can print any valid solution.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">2 \le n \le 500</span></li>
<li><span class="math math-inline">1 \le m \le 1000</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>6 7
1 2
1 3
2 6
3 4
3 5
4 6
5 6
</pre>
<p>Output:</p>
<pre>2
3
1 2 6
4
1 3 4 6
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem161"></a>
    <h1>Problem 161: Counting Grids</h1>
    <div class="problem"><div class="content">
<title>CSES - Exponentiation II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1712"/>
<div class="md"><p>Your task is to efficiently calculate values <span class="math math-inline">a^{b^c}</span> modulo <span class="math math-inline">10^9+7</span>.</p>
<p>Note that in this task we assume that <span class="math math-inline">0^0=1</span>.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of calculations.</p>
<p>After this, there are <span class="math math-inline">n</span> lines, each containing three integers <span class="math math-inline">a</span>, <span class="math math-inline">b</span> and <span class="math math-inline">c</span>.</p>
<h1 id="output">Output</h1>
<p>Print each value <span class="math math-inline">a^{b^c}</span> modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">0 \le a,b,c \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
3 7 1
15 2 2
3 4 5
</pre>
<p>Output:</p>
<pre>2187
50625
763327764
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem162"></a>
    <h1>Problem 162: Fibonacci Numbers</h1>
    <div class="problem"><div class="content">
<title>CSES - Counting Divisors</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1713"/>
<div class="md"><p>Given <span class="math math-inline">n</span> integers, your task is to report for each integer the number of its divisors.</p>
<p>For example, if <span class="math math-inline">x=18</span>, the correct answer is <span class="math math-inline">6</span> because its divisors are <span class="math math-inline">1,2,3,6,9,18</span>.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of integers.</p>
<p>After this, there are <span class="math math-inline">n</span> lines, each containing an integer <span class="math math-inline">x</span>.</p>
<h1 id="output">Output</h1>
<p>For each integer, print the number of its divisors.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le x \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
16
17
18
</pre>
<p>Output:</p>
<pre>5
2
6
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem163"></a>
    <h1>Problem 163: Throwing Dice</h1>
    <div class="problem"><div class="content">
<title>CSES - Creating Strings II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1715"/>
<div class="md"><p>Given a string, your task is to calculate the number of different strings that can be created using its characters.</p>
<h1 id="input">Input</h1>
<p>The only input line has a string of length <span class="math math-inline">n</span>. Each character is between a–z.</p>
<h1 id="output">Output</h1>
<p>Print the number of different strings modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>aabac
</pre>
<p>Output:</p>
<pre>20
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem164"></a>
    <h1>Problem 164: Graph Paths I</h1>
    <div class="problem"><div class="content">
<title>CSES - Distributing Apples</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1716"/>
<div class="md"><p>There are <span class="math math-inline">n</span> children and <span class="math math-inline">m</span> apples that will be distributed to them. Your task is to count the number of ways this can be done.</p>
<p>For example, if <span class="math math-inline">n=3</span> and <span class="math math-inline">m=2</span>, there are <span class="math math-inline">6</span> ways: <span class="math math-inline">[0,0,2]</span>, <span class="math math-inline">[0,1,1]</span>, <span class="math math-inline">[0,2,0]</span>, <span class="math math-inline">[1,0,1]</span>, <span class="math math-inline">[1,1,0]</span> and <span class="math math-inline">[2,0,0]</span>.</p>
<h1 id="input">Input</h1>
<p>The only input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>.</p>
<h1 id="output">Output</h1>
<p>Print the number of ways modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,m \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3 2
</pre>
<p>Output:</p>
<pre>6
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem165"></a>
    <h1>Problem 165: Graph Paths II</h1>
    <div class="problem"><div class="content">
<title>CSES - Christmas Party</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1717"/>
<div class="md"><p>There are <span class="math math-inline">n</span> children at a Christmas party, and each of them has brought a gift. The idea is that everybody will get a gift brought by someone else.</p>
<p>In how many ways can the gifts be distributed?</p>
<h1 id="input">Input</h1>
<p>The only input line has an integer <span class="math math-inline">n</span>: the number of children.</p>
<h1 id="output">Output</h1>
<p>Print the number of ways modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4
</pre>
<p>Output:</p>
<pre>9
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem166"></a>
    <h1>Problem 166: Dice Probability</h1>
    <div class="problem"><div class="content">
<title>CSES - Fibonacci Numbers</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1722"/>
<div class="md"><p>The Fibonacci numbers can be defined as follows:</p>
<ul>
<li><span class="math math-inline">F_0=0</span></li>
<li><span class="math math-inline">F_1=1</span></li>
<li><span class="math math-inline">F_n = F_{n-2}+F_{n-1}</span></li>
</ul>
<p>Your task is to calculate the value of <span class="math math-inline">F_n</span> for a given <span class="math math-inline">n</span>.</p>
<h1 id="input">Input</h1>
<p>The only input line has an integer <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print the value of <span class="math math-inline">F_n</span> modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">0 \le n \le 10^{18}</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>10
</pre>
<p>Output:</p>
<pre>55
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem167"></a>
    <h1>Problem 167: Moving Robots</h1>
    <div class="problem"><div class="content">
<title>CSES - Graph Paths I</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1723"/>
<div class="md"><p>Consider a directed graph that has <span class="math math-inline">n</span> nodes and <span class="math math-inline">m</span> edges. Your task is to count the number of paths from node <span class="math math-inline">1</span> to node <span class="math math-inline">n</span> with exactly <span class="math math-inline">k</span> edges.</p>
<h1 id="input">Input</h1>
<p>The first input line contains three integers <span class="math math-inline">n</span>, <span class="math math-inline">m</span> and <span class="math math-inline">k</span>: the number of nodes and edges, and the length of the path. The nodes are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>Then, there are <span class="math math-inline">m</span> lines describing the edges. Each line contains two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge from node <span class="math math-inline">a</span> to node <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>Print the number of paths modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 100</span></li>
<li><span class="math math-inline">1 \le m \le n(n-1)</span></li>
<li><span class="math math-inline">1 \le k \le 10^9</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3 4 8
1 2
2 3
3 1
3 2
</pre>
<p>Output:</p>
<pre>2
</pre>
<p>Explanation: The paths are <span class="math math-inline">1 \rightarrow 2 \rightarrow 3 \rightarrow 1 \rightarrow 2 \rightarrow 3 \rightarrow 1 \rightarrow 2 \rightarrow 3</span> and <span class="math math-inline">1 \rightarrow 2 \rightarrow 3 \rightarrow 2 \rightarrow 3 \rightarrow 2 \rightarrow 3 \rightarrow 2 \rightarrow 3</span>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem168"></a>
    <h1>Problem 168: Candy Lottery</h1>
    <div class="problem"><div class="content">
<title>CSES - Graph Paths II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1724"/>
<div class="md"><p>Consider a directed weighted graph having <span class="math math-inline">n</span> nodes and <span class="math math-inline">m</span> edges. Your task is to calculate the minimum path length from node <span class="math math-inline">1</span> to node <span class="math math-inline">n</span> with exactly <span class="math math-inline">k</span> edges.</p>
<h1 id="input">Input</h1>
<p>The first input line contains three integers <span class="math math-inline">n</span>, <span class="math math-inline">m</span> and <span class="math math-inline">k</span>: the number of nodes and edges, and the length of the path. The nodes are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>Then, there are m lines describing the edges. Each line contains three integers <span class="math math-inline">a</span>, <span class="math math-inline">b</span> and <span class="math math-inline">c</span>: there is an edge from node <span class="math math-inline">a</span> to node <span class="math math-inline">b</span> with weight <span class="math math-inline">c</span>.</p>
<h1 id="output">Output</h1>
<p>Print the minimum path length. If there are no such paths, print <span class="math math-inline">-1</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 100</span></li>
<li><span class="math math-inline">1 \le m \le n(n-1)</span></li>
<li><span class="math math-inline">1 \le k \le 10^9</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
<li><span class="math math-inline">1 \le c \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3 4 8
1 2 5
2 3 4
3 1 1
3 2 2
</pre>
<p>Output:</p>
<pre>27
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem169"></a>
    <h1>Problem 169: Inversion Probability</h1>
    <div class="problem"><div class="content">
<title>CSES - Dice Probability</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1725"/>
<div class="md"><p>You throw a dice <span class="math math-inline">n</span> times, and every throw produces an outcome between <span class="math math-inline">1</span> and <span class="math math-inline">6</span>. What is the probability that the sum of outcomes is between <span class="math math-inline">a</span> and <span class="math math-inline">b</span>?</p>
<h1 id="input">Input</h1>
<p>The only input line contains three integers <span class="math math-inline">n</span>, <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>Print the probability rounded to six decimal places (rounding half to even).</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 100</span></li>
<li><span class="math math-inline">1 \le a \le b \le 6n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>2 9 10
</pre>
<p>Output:</p>
<pre>0.194444
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem170"></a>
    <h1>Problem 170: Stick Game</h1>
    <div class="problem"><div class="content">
<title>CSES - Moving Robots</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1726"/>
<div class="md"><p>Each square of an <span class="math math-inline">8 \times 8</span> chessboard has a robot. Each robot independently moves <span class="math math-inline">k</span> steps, and there can be many robots on the same square.</p>
<p>On each turn, a robot moves one step left, right, up or down, but not outside the board. It randomly chooses a direction among those where it can move.</p>
<p>Your task is to calculate the expected number of <em>empty</em> squares after <span class="math math-inline">k</span> turns.</p>
<h1 id="input">Input</h1>
<p>The only input line has an integer <span class="math math-inline">k</span>.</p>
<h1 id="output">Output</h1>
<p>Print the expected number of empty squares rounded to six decimal places (rounding half to even).</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le k \le 100</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>10
</pre>
<p>Output:</p>
<pre>23.120740
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem171"></a>
    <h1>Problem 171: Nim Game I</h1>
    <div class="problem"><div class="content">
<title>CSES - Candy Lottery</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1727"/>
<div class="md"><p>There are <span class="math math-inline">n</span> children, and each of them independently gets a random integer number of candies between <span class="math math-inline">1</span> and <span class="math math-inline">k</span>.</p>
<p>What is the expected maximum number of candies a child gets?</p>
<h1 id="input">Input</h1>
<p>The only input line contains two integers <span class="math math-inline">n</span> and <span class="math math-inline">k</span>.</p>
<h1 id="output">Output</h1>
<p>Print the expected number rounded to six decimal places (rounding half to even).</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 100</span></li>
<li><span class="math math-inline">1 \le k \le 100</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>2 3
</pre>
<p>Output:</p>
<pre>2.444444
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem172"></a>
    <h1>Problem 172: Nim Game II</h1>
    <div class="problem"><div class="content">
<title>CSES - Inversion Probability</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1728"/>
<div class="md"><p>An array has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>, and each of them has been randomly chosen between <span class="math math-inline">1</span> and <span class="math math-inline">r_i</span>. An inversion is a pair <span class="math math-inline">(a,b)</span> where <span class="math math-inline">a&lt;b</span> and <span class="math math-inline">x_a&gt;x_b</span>.</p>
<p>What is the expected number of inversions in the array?</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">n</span>: the size of the array.</p>
<p>The second line contains <span class="math math-inline">n</span> integers <span class="math math-inline">r_1,r_2,\dots,r_n</span>: the range of possible values for each array position.</p>
<h1 id="output">Output</h1>
<p>Print the expected number of inversions rounded to six decimal places (rounding half to even).</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 100</span></li>
<li><span class="math math-inline">1 \le r_i \le 100</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
5 2 7
</pre>
<p>Output:</p>
<pre>1.057143
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem173"></a>
    <h1>Problem 173: Stair Game</h1>
    <div class="problem"><div class="content">
<title>CSES - Stick Game</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1729"/>
<div class="md"><p>Consider a game where two players remove sticks from a heap. The players move alternately, and the player who removes the last stick wins the game.</p>
<p>A set <span class="math math-inline">P=\{p_1,p_2,\ldots,p_k\}</span> determines the allowed moves. For example, if <span class="math math-inline">P=\{1,3,4\}</span>, a player may remove <span class="math math-inline">1</span>, <span class="math math-inline">3</span> or <span class="math math-inline">4</span> sticks.</p>
<p>Your task is find out for each number of sticks <span class="math math-inline">1,2,\dots,n</span> if the first player has a winning or losing position.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">k</span>: the number of sticks and moves.</p>
<p>The next line has <span class="math math-inline">k</span> integers <span class="math math-inline">p_1,p_2,\dots,p_k</span> that describe the allowed moves. All integers are distinct, and one of them is <span class="math math-inline">1</span>.</p>
<h1 id="output">Output</h1>
<p>Print a string containing <span class="math math-inline">n</span> characters: <code>W</code> means a winning position, and <code>L</code> means a losing position.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
<li><span class="math math-inline">1 \le k \le 100</span></li>
<li><span class="math math-inline">1 \le p_i \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>10 3
1 3 4
</pre>
<p>Output:</p>
<pre>WLWWWWLWLW
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem174"></a>
    <h1>Problem 174: Grundy's Game</h1>
    <div class="problem"><div class="content">
<title>CSES - Nim Game I</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1730"/>
<div class="md"><p>There are <span class="math math-inline">n</span> heaps of sticks and two players who move alternately. On each move, a player chooses a non-empty heap and removes any number of sticks. The player who removes the last stick wins the game.</p>
<p>Your task is to find out who wins if both players play optimally.</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">t</span>: the number of tests. After this, <span class="math math-inline">t</span> test cases are described:</p>
<p>The first line contains an integer <span class="math math-inline">n</span>: the number of heaps.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\ldots,x_n</span>: the number of sticks in each heap.</p>
<h1 id="output">Output</h1>
<p>For each test case, print "first" if the first player wins the game and "second" if the second player wins the game.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le t \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
<li>the sum of all <span class="math math-inline">n</span> is at most <span class="math math-inline">2 \cdot 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
4
5 7 2 5
2
4 1
3
3 5 6
</pre>
<p>Output:</p>
<pre>first
first
second
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem175"></a>
    <h1>Problem 175: Another Game</h1>
    <div class="problem"><div class="content">
<title>CSES - Word Combinations</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1731"/>
<div class="md"><p>You are given a string of length <span class="math math-inline">n</span> and a dictionary containing <span class="math math-inline">k</span> words. In how many ways can you create the string using the words?</p>
<h1 id="input">Input</h1>
<p>The first input line has a string containing <span class="math math-inline">n</span> characters between a–z.</p>
<p>The second line has an integer <span class="math math-inline">k</span>: the number of words in the dictionary.</p>
<p>Finally there are <span class="math math-inline">k</span> lines describing the words. Each word is unique and consists of characters a–z.</p>
<h1 id="output">Output</h1>
<p>Print the number of ways modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 5000</span></li>
<li><span class="math math-inline">1 \le k \le 10^5</span></li>
<li>the total length of the words is at most <span class="math math-inline">10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>ababc
4
ab
abab
c
cb
</pre>
<p>Output:</p>
<pre>2
</pre>
<p>Explanation: The possible ways are <code>ab+ab+c</code> and <code>abab+c</code>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem176"></a>
    <h1>Problem 176: Word Combinations</h1>
    <div class="problem"><div class="content">
<title>CSES - Finding Borders</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1732"/>
<div class="md"><p>A <em>border</em> of a string is a prefix that is also a suffix of the string but not the whole string. For example, the borders of <code>abcababcab</code> are <code>ab</code> and <code>abcab</code>.</p>
<p>Your task is to find all border lengths of a given string.</p>
<h1 id="input">Input</h1>
<p>The only input line has a string of length <span class="math math-inline">n</span> consisting of characters a–z.</p>
<h1 id="output">Output</h1>
<p>Print all border lengths of the string in increasing order.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>abcababcab
</pre>
<p>Output:</p>
<pre>2 5
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem177"></a>
    <h1>Problem 177: String Matching</h1>
    <div class="problem"><div class="content">
<title>CSES - Finding Periods</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1733"/>
<div class="md"><p>A <em>period</em> of a string is a prefix that can be used to generate the whole string by repeating the prefix. The last repetition may be partial. For example, the periods of <code>abcabca</code> are <code>abc</code>, <code>abcabc</code> and <code>abcabca</code>.</p>
<p>Your task is to find all period lengths of a string.</p>
<h1 id="input">Input</h1>
<p>The only input line has a string of length <span class="math math-inline">n</span> consisting of characters a–z.</p>
<h1 id="output">Output</h1>
<p>Print all period lengths in increasing order.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>abcabca
</pre>
<p>Output:</p>
<pre>3 6 7
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem178"></a>
    <h1>Problem 178: Finding Borders</h1>
    <div class="problem"><div class="content">
<title>CSES - Distinct Values Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1734"/>
<div class="md"><p>You are given an array of <span class="math math-inline">n</span> integers and <span class="math math-inline">q</span> queries of the form: how many distinct values are there in a range <span class="math math-inline">[a,b]</span>?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the array size and number of queries.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the array values.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>For each query, print the number of distinct values in the range.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
<li><span class="math math-inline">1 \le a \le b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3
3 2 3 1 2
1 3
2 4
1 5
</pre>
<p>Output:</p>
<pre>2
3
3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem179"></a>
    <h1>Problem 179: Finding Periods</h1>
    <div class="problem"><div class="content">
<title>CSES - Range Updates and Sums</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1735"/>
<div class="md"><p>Your task is to maintain an array of <span class="math math-inline">n</span> values and efficiently process the following types of queries:</p>
<ol>
<li>Increase each value in range <span class="math math-inline">[a,b]</span> by <span class="math math-inline">x</span>.</li>
<li>Set each value in range <span class="math math-inline">[a,b]</span> to <span class="math math-inline">x</span>.</li>
<li>Calculate the sum of values in range <span class="math math-inline">[a,b]</span>.</li>
</ol>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the array size and the number of queries.</p>
<p>The next line has <span class="math math-inline">n</span> values <span class="math math-inline">t_1,t_2,\dots,t_n</span>: the initial contents of the array.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. The format of each line is one of the following: "1 <span class="math math-inline">a</span> <span class="math math-inline">b</span> <span class="math math-inline">x</span>",  "2 <span class="math math-inline">a</span> <span class="math math-inline">b</span> <span class="math math-inline">x</span>", or "3 <span class="math math-inline">a</span> <span class="math math-inline">b</span>".</p>
<h1 id="output">Output</h1>
<p>Print the answer to each sum query.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n, q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le t_i, x \le 10^6</span></li>
<li><span class="math math-inline">1 \le a \le b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>6 5
2 3 1 1 5 3
3 3 5
1 2 4 2
3 3 5
2 2 4 5
3 3 5
</pre>
<p>Output:</p>
<pre>7
11
15
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem180"></a>
    <h1>Problem 180: Minimal Rotation</h1>
    <div class="problem"><div class="content">
<title>CSES - Polynomial Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1736"/>
<div class="md"><p>Your task is to maintain an array of <span class="math math-inline">n</span> values and efficiently process the following types of queries:</p>
<ol>
<li>Increase the first value in range <span class="math math-inline">[a,b]</span> by <span class="math math-inline">1</span>, the second value by <span class="math math-inline">2</span>, the third value by <span class="math math-inline">3</span>, and so on.</li>
<li>Calculate the sum of values in range <span class="math math-inline">[a,b]</span>.</li>
</ol>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the size of the array and the number of queries.</p>
<p>The next line has <span class="math math-inline">n</span> values <span class="math math-inline">t_1,t_2,\dots,t_n</span>: the initial contents of the array.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. The format of each line is either "1 <span class="math math-inline">a</span> <span class="math math-inline">b</span>" or "2 <span class="math math-inline">a</span> <span class="math math-inline">b</span>".</p>
<h1 id="output">Output</h1>
<p>Print the answer to each sum query.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n, q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le t_i \le 10^6</span></li>
<li><span class="math math-inline">1 \le a \le b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3
4 2 3 1 7
2 1 5
1 1 5
2 1 5
</pre>
<p>Output:</p>
<pre>17
32
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem181"></a>
    <h1>Problem 181: Longest Palindrome</h1>
    <div class="problem"><div class="content">
<title>CSES - Range Queries and Copies</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1737"/>
<div class="md"><p>Your task is to maintain a list of arrays which initially has a single array. You have to process the following types of queries:</p>
<ol>
<li>Set the value <span class="math math-inline">a</span> in array <span class="math math-inline">k</span> to <span class="math math-inline">x</span>.</li>
<li>Calculate the sum of values in range <span class="math math-inline">[a,b]</span> in array <span class="math math-inline">k</span>.</li>
<li>Create a copy of array <span class="math math-inline">k</span> and add it to the end of the list.</li>
</ol>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the array size and the number of queries.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">t_1,t_2,\ldots,t_n</span>: the initial contents of the array.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. The format of each line is one of the following: "1 <span class="math math-inline">k</span> <span class="math math-inline">a</span> <span class="math math-inline">x</span>", "2 <span class="math math-inline">k</span> <span class="math math-inline">a</span> <span class="math math-inline">b</span>" or "3 <span class="math math-inline">k</span>".</p>
<h1 id="output">Output</h1>
<p>Print the answer to each sum query.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n, q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le t_i, x \le 10^9</span></li>
<li><span class="math math-inline">1 \le a \le b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 6
2 3 1 2 5
3 1
2 1 1 5
2 2 1 5
1 2 2 5
2 1 1 5
2 2 1 5
</pre>
<p>Output:</p>
<pre>13
13
13
15
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem182"></a>
    <h1>Problem 182: Required Substring</h1>
    <div class="problem"><div class="content">
<title>CSES - Forest Queries II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1739"/>
<div class="md"><p>You are given an <span class="math math-inline">n \times n</span> grid representing the map of a forest. Each square is either empty or has a tree. Your task is to process <span class="math math-inline">q</span> queries of the following types:</p>
<ol>
<li>Change the state (empty/tree) of a square.</li>
<li>How many trees are inside a rectangle in the forest?</li>
</ol>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the size of the forest and the number of queries.</p>
<p>Then, there are <span class="math math-inline">n</span> lines describing the forest. Each line has <span class="math math-inline">n</span> characters: <code>.</code> is an empty square and <code>*</code> is a tree.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. The format of each line is either "<span class="math math-inline">1</span> <span class="math math-inline">y</span> <span class="math math-inline">x</span>" or "2 <span class="math math-inline">y_1</span> <span class="math math-inline">x_1</span> <span class="math math-inline">y_2</span> <span class="math math-inline">x_2</span>".</p>
<h1 id="output">Output</h1>
<p>Print the answer to each query of the second type.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 1000</span></li>
<li><span class="math math-inline">1 \le q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le y,x \le n</span></li>
<li><span class="math math-inline">1 \le y_1 \le y_2 \le n</span></li>
<li><span class="math math-inline">1 \le x_1 \le x_2 \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 3
.*..
*.**
**..
****
2 2 2 3 4
1 3 3
2 2 2 3 4
</pre>
<p>Output:</p>
<pre>3
4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem183"></a>
    <h1>Problem 183: Palindrome Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - Intersection Points</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1740"/>
<div class="md"><p>Given <span class="math math-inline">n</span> horizontal and vertical line segments, your task is to calculate the number of their intersection points.</p>
<p>You can assume that no parallel line segments intersect, and no endpoint of a line segment is an intersection point.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of line segments.</p>
<p>Then there are <span class="math math-inline">n</span> lines describing the line segments. Each line has four integers: <span class="math math-inline">x_1</span>, <span class="math math-inline">y_1</span>, <span class="math math-inline">x_2</span> and <span class="math math-inline">y_2</span>: a line segment begins at point <span class="math math-inline">(x_1,y_1)</span> and ends at point <span class="math math-inline">(x_2,y_2)</span>.</p>
<h1 id="output">Output</h1>
<p>Print the number of intersection points.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">-10^6 \le x_1 \le x_2 \le 10^6</span></li>
<li><span class="math math-inline">-10^6 \le y_1 \le y_2 \le 10^6</span></li>
<li><span class="math math-inline">(x_1,y_1) \neq (x_2,y_2)</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
2 3 7 3
3 1 3 5
6 2 6 6
</pre>
<p>Output:</p>
<pre>2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem184"></a>
    <h1>Problem 184: Finding Patterns</h1>
    <div class="problem"><div class="content">
<title>CSES - Area of Rectangles</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1741"/>
<div class="md"><p>Given <span class="math math-inline">n</span> rectangles, your task is to determine the total area of their union.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of rectangles.</p>
<p>After that, there are <span class="math math-inline">n</span> lines describing the rectangles. Each line has four integers <span class="math math-inline">x_1</span>, <span class="math math-inline">y_1</span>, <span class="math math-inline">x_2</span> and <span class="math math-inline">y_2</span>: a rectangle begins at point <span class="math math-inline">(x_1,y_1)</span> and ends at point <span class="math math-inline">(x_2,y_2)</span>.</p>
<h1 id="output">Output</h1>
<p>Print the total area covered by the rectangles.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">-10^6 \le x_1 &lt; x_2 \le 10^6</span></li>
<li><span class="math math-inline">-10^6 \le y_1 &lt; y_2 \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
1 3 4 5
3 1 7 4
5 3 8 6
</pre>
<p>Output:</p>
<pre>24
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem185"></a>
    <h1>Problem 185: Counting Patterns</h1>
    <div class="problem"><div class="content">
<title>CSES - Robot Path</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1742"/>
<div class="md"><p>You are given a description of a robot's path. The robot begins at point <span class="math math-inline">(0,0)</span> and performs <span class="math math-inline">n</span> commands. Each command moves the robot some distance up, down, left or right.</p>
<p>The robot will stop when it has performed all commands, or immediately when it returns to a point that it has already visited. Your task is to calculate the total distance the robot moves.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of commands.</p>
<p>After that, there are <span class="math math-inline">n</span> lines describing the commands. Each line has a character <span class="math math-inline">d</span> and an integer <span class="math math-inline">x</span>: the robot moves the distance  <span class="math math-inline">x</span> to the direction <span class="math math-inline">d</span>. Each direction is U (up), D (down), L (left), or R (right).</p>
<h1 id="output">Output</h1>
<p>Print the total distance the robot moves.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le x \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
U 2
R 3
D 1
L 5
U 2
</pre>
<p>Output:</p>
<pre>9
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem186"></a>
    <h1>Problem 186: Pattern Positions</h1>
    <div class="problem"><div class="content">
<title>CSES - String Reorder</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1743"/>
<div class="md"><p>Your task is to reorder the characters of a string so that no two adjacent characters are the same. What is the lexicographically minimal such string?</p>
<h1 id="input">Input</h1>
<p>The only line has a string of length <span class="math math-inline">n</span> consisting of characters A–Z.</p>
<h1 id="output">Output</h1>
<p>Print the lexicographically minimal reordered string where no two adjacent characters are the same. If it is not possible to create such a string, print <span class="math math-inline">-1</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>HATTIVATTI
</pre>
<p>Output:</p>
<pre>AHATITITVT
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem187"></a>
    <h1>Problem 187: Distinct Substrings</h1>
    <div class="problem"><div class="content">
<title>CSES - Rectangle Cutting</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1744"/>
<div class="md"><p>Given an <span class="math math-inline">a \times b</span> rectangle, your task is to cut it into squares. On each move you can select a rectangle and cut it into two rectangles in such a way that all side lengths remain integers. What is the minimum possible number of moves?</p>
<h1 id="input">Input</h1>
<p>The only input line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum number of moves.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le a,b \le 500</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3 5
</pre>
<p>Output:</p>
<pre>3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem188"></a>
    <h1>Problem 188: Repeating Substring</h1>
    <div class="problem"><div class="content">
<title>CSES - Money Sums</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1745"/>
<div class="md"><p>You have <span class="math math-inline">n</span> coins with certain values. Your task is to find all money sums you can create using these coins.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of coins.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the values of the coins.</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math math-inline">k</span>: the number of distinct money sums. After this, print all possible sums in increasing order.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 100</span></li>
<li><span class="math math-inline">1 \le x_i \le 1000</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4
4 2 5 2
</pre>
<p>Output:</p>
<pre>9
2 4 5 6 7 8 9 11 13
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem189"></a>
    <h1>Problem 189: String Functions</h1>
    <div class="problem"><div class="content">
<title>CSES - Array Description</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1746"/>
<div class="md"><p>You know that an array has <span class="math math-inline">n</span> integers between <span class="math math-inline">1</span> and  <span class="math math-inline">m</span>, and the absolute difference between two adjacent values is at most <span class="math math-inline">1</span>.</p>
<p>Given a description of the array where some values may be unknown, your task is to count the number of arrays that match the description.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the array size and the upper bound for each value.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the contents of the array. Value <span class="math math-inline">0</span> denotes an unknown value.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of arrays modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 100</span></li>
<li><span class="math math-inline">0 \le x_i \le m</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3 5
2 0 2
</pre>
<p>Output:</p>
<pre>3
</pre>
<p>Explanation: The arrays <span class="math math-inline">[2,1,2]</span>, <span class="math math-inline">[2,2,2]</span> and <span class="math math-inline">[2,3,2]</span> match the description.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem190"></a>
    <h1>Problem 190: Substring Order I</h1>
    <div class="problem"><div class="content">
<title>CSES - Pyramid Array</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1747"/>
<div class="md"><p>You are given an array consisting of <span class="math math-inline">n</span> distinct integers. On each move, you can swap any two adjacent values.</p>
<p>You want to transform the array into a <em>pyramid array</em>. This means that the final array has to be first increasing and then decreasing. It is also allowed that the final array is only increasing or decreasing.</p>
<p>What is the minimum number of moves needed?</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the size of the array.</p>
<p>The next line has <span class="math math-inline">n</span> distinct integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the contents of the array.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum number of moves.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4
2 1 5 3
</pre>
<p>Output:</p>
<pre>1
</pre>
<p>Explanation: You may swap the first two values which creates a pyramid array <span class="math math-inline">[1,2,5,3]</span>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem191"></a>
    <h1>Problem 191: Substring Order II</h1>
    <div class="problem"><div class="content">
<title>CSES - Increasing Subsequence II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1748"/>
<div class="md"><p>Given an array of <span class="math math-inline">n</span> integers, your task is to calculate the number of increasing subsequences it contains. If two subsequences have the same values but in different positions in the array, they are counted separately.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the size of the array.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the contents of the array.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of increasing subsequences modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
2 1 3
</pre>
<p>Output:</p>
<pre>5
</pre>
<p>Explanation: The increasing subsequences are <span class="math math-inline">[2]</span>, <span class="math math-inline">[1]</span>, <span class="math math-inline">[3]</span>, <span class="math math-inline">[2,3]</span> and <span class="math math-inline">[1,3]</span>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem192"></a>
    <h1>Problem 192: Substring Distribution</h1>
    <div class="problem"><div class="content">
<title>CSES - List Removals</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1749"/>
<div class="md"><p>You are given a list consisting of <span class="math math-inline">n</span> integers. Your task is to remove elements from the list at given positions, and report the removed elements.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the initial size of the list. During the process, the elements are numbered <span class="math math-inline">1,2,\dots,k</span> where <span class="math math-inline">k</span> is the current size of the list.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the contents of the list.</p>
<p>The last line has <span class="math math-inline">n</span> integers <span class="math math-inline">p_1,p_2,\dots,p_n</span>: the positions of the elements to be removed.</p>
<h1 id="output">Output</h1>
<p>Print the elements in the order they are removed.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
<li><span class="math math-inline">1 \le p_i \le n-i+1</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
2 6 1 4 2
3 1 3 1 1
</pre>
<p>Output:</p>
<pre>1 2 2 6 4
</pre>
<p>Explanation: The contents of the list are <span class="math math-inline">[2,6,1,4,2]</span>, <span class="math math-inline">[2,6,4,2]</span>, <span class="math math-inline">[6,4,2]</span>, <span class="math math-inline">[6,4]</span>, <span class="math math-inline">[4]</span> and <span class="math math-inline">[]</span>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem193"></a>
    <h1>Problem 193: Point Location Test</h1>
    <div class="problem"><div class="content">
<title>CSES - Planets Queries I</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1750"/>
<div class="md"><p>You are playing a game consisting of <span class="math math-inline">n</span> planets. Each planet has a teleporter to another planet (or the planet itself).</p>
<p>Your task is to process <span class="math math-inline">q</span> queries of the form: when you begin on planet <span class="math math-inline">x</span> and travel through <span class="math math-inline">k</span> teleporters, which planet will you reach?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the number of planets and queries. The planets are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">t_1,t_2,\dots,t_n</span>: for each planet, the destination of the teleporter. It is possible that <span class="math math-inline">t_i=i</span>.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. Each line has two integers <span class="math math-inline">x</span> and <span class="math math-inline">k</span>: you start on planet <span class="math math-inline">x</span> and travel through <span class="math math-inline">k</span> teleporters.</p>
<h1 id="output">Output</h1>
<p>Print the answer to each query.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n, q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le t_i \le n</span></li>
<li><span class="math math-inline">1 \le x \le n</span></li>
<li><span class="math math-inline">0 \le k \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 3
2 1 1 4
1 2
3 4
4 1
</pre>
<p>Output:</p>
<pre>1
2
4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem194"></a>
    <h1>Problem 194: Line Segment Intersection</h1>
    <div class="problem"><div class="content">
<title>CSES - Planets Cycles</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1751"/>
<div class="md"><p>You are playing a game consisting of <span class="math math-inline">n</span> planets. Each planet has a teleporter to another planet (or the planet itself).</p>
<p>You start on a planet and then travel through teleporters until you reach a planet that you have already visited before.</p>
<p>Your task is to calculate for each planet the number of teleportations there would be if you started on that planet.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of planets. The planets are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">t_1,t_2,\dots,t_n</span>: for each planet, the destination of the teleporter. It is possible that <span class="math math-inline">t_i=i</span>.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">n</span> integers according to the problem statement.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le t_i \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
2 4 3 1 4
</pre>
<p>Output:</p>
<pre>3 3 1 3 4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem195"></a>
    <h1>Problem 195: Polygon Area</h1>
    <div class="problem"><div class="content">
<title>CSES - Creating Offices</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1752"/>
<div class="md"><p>There are <span class="math math-inline">n</span> cities and <span class="math math-inline">n-1</span> roads between them. There is a unique route between any two cities, and their distance is the number of roads on that route.</p>
<p>A company wants to have offices in some cities, but the distance between any two offices has to be at least <span class="math math-inline">d</span>. What is the maximum number of offices they can have?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">d</span>: the number of cities and the minimum distance. The cities are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>After this, there are <span class="math math-inline">n-1</span> lines describing the roads. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is a road between cities <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math math-inline">k</span>: the maximum number of offices. After that, print the cities which will have offices. You can print any valid solution.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,d \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3
1 2
2 3
3 4
3 5
</pre>
<p>Output:</p>
<pre>2
1 4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem196"></a>
    <h1>Problem 196: Point in Polygon</h1>
    <div class="problem"><div class="content">
<title>CSES - String Matching</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1753"/>
<div class="md"><p>Given a string and a pattern, your task is to count the number of positions where the pattern occurs in the string.</p>
<h1 id="input">Input</h1>
<p>The first input line has a string of length <span class="math math-inline">n</span>, and the second input line has a pattern of length <span class="math math-inline">m</span>. Both of them consist of characters a–z.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of occurrences.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,m \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>saippuakauppias
pp
</pre>
<p>Output:</p>
<pre>2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem197"></a>
    <h1>Problem 197: Polygon Lattice Points</h1>
    <div class="problem"><div class="content">
<title>CSES - Coin Piles</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1754"/>
<div class="md"><p>You have two coin piles containing <span class="math math-inline">a</span> and <span class="math math-inline">b</span> coins. On each move, you can either remove one coin from the left pile and two coins from the right pile, or two coins from the left pile and one coin from the right pile.</p>
<p>Your task is to efficiently find out if you can empty both the piles.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">t</span>: the number of tests.</p>
<p>After this, there are <span class="math math-inline">t</span> lines, each of which has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: the numbers of coins in the piles.</p>
<h1 id="output">Output</h1>
<p>For each test, print "YES" if you can empty the piles and "NO" otherwise.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le t \le 10^5</span></li>
<li><span class="math math-inline">0 \le a, b \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
2 1
2 2
3 3
</pre>
<p>Output:</p>
<pre>YES
NO
YES
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem198"></a>
    <h1>Problem 198: Minimum Euclidean Distance</h1>
    <div class="problem"><div class="content">
<title>CSES - Palindrome Reorder</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1755"/>
<div class="md"><p>Given a string, your task is to reorder its letters in such a way that it becomes a palindrome (i.e., it reads the same forwards and backwards).</p>
<h1 id="input">Input</h1>
<p>The only input line has a string of length <span class="math math-inline">n</span> consisting of characters A–Z.</p>
<h1 id="output">Output</h1>
<p>Print a palindrome consisting of the characters of the original string. You may print any valid solution. If there are no solutions, print "NO SOLUTION".</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>AAAACACBA
</pre>
<p>Output:</p>
<pre>AACABACAA
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem199"></a>
    <h1>Problem 199: Convex Hull</h1>
    <div class="problem"><div class="content">
<title>CSES - Acyclic Graph Edges</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1756"/>
<div class="md"><p>Given an undirected graph, your task is to choose a direction for each edge so that the resulting directed graph is acyclic.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of nodes and edges. The nodes are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>After this, there are <span class="math math-inline">m</span> lines describing the edges. Each line has two distinct integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">m</span> lines describing the directions of the edges. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge from node <span class="math math-inline">a</span> to node <span class="math math-inline">b</span>. You can print any valid solution.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3 3
1 2
2 3
3 1
</pre>
<p>Output:</p>
<pre>1 2
3 2
3 1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem200"></a>
    <h1>Problem 200: Meet in the Middle</h1>
    <div class="problem"><div class="content">
<title>CSES - Course Schedule II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="1757"/>
<div class="md"><p>You want to complete <span class="math math-inline">n</span> courses that have requirements of the form "course <span class="math math-inline">a</span> has to be completed before course <span class="math math-inline">b</span>".</p>
<p>You want to complete course <span class="math math-inline">1</span> as soon as possible. If there are several ways to do this, you want then to complete course <span class="math math-inline">2</span> as soon as possible, and so on.</p>
<p>Your task is to determine the order in which you complete the courses.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of courses and requirements. The courses are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>Then, there are <span class="math math-inline">m</span> lines describing the requirements. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: course <span class="math math-inline">a</span> has to be completed before course <span class="math math-inline">b</span>.</p>
<p>You can assume that there is at least one valid schedule.</p>
<h1 id="output">Output</h1>
<p>Print one line having <span class="math math-inline">n</span> integers: the order in which you complete the courses.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 2
2 1
2 3
</pre>
<p>Output:</p>
<pre>2 1 3 4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem201"></a>
    <h1>Problem 201: Hamming Distance</h1>
    <div class="problem"><div class="content">
<title>CSES - Bracket Sequences I</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2064"/>
<div class="md"><p>Your task is to calculate the number of valid bracket sequences of length <span class="math math-inline">n</span>. For example, when <span class="math math-inline">n=6</span>, there are <span class="math math-inline">5</span> sequences:</p>
<ul>
<li><code>()()()</code></li>
<li><code>()(())</code></li>
<li><code>(())()</code></li>
<li><code>((()))</code></li>
<li><code>(()())</code></li>
</ul>
<h1 id="input">Input</h1>
<p>The only input line has an integer <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print the number of sequences modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>6
</pre>
<p>Output:</p>
<pre>5
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem202"></a>
    <h1>Problem 202: Beautiful Subgrids</h1>
    <div class="problem"><div class="content">
<title>CSES - Cut and Paste</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2072"/>
<div class="md"><p>Given a string, your task is to process operations where you cut a substring and paste it to the end of the string. What is the final string after all the operations?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the length of the string and the number of operations. The characters of the string are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>The next line has a string of length <span class="math math-inline">n</span> that consists of characters A–Z.</p>
<p>Finally, there are <span class="math math-inline">m</span> lines that describe the operations. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: you cut a substring from position <span class="math math-inline">a</span> to position <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>Print the final string after all the operations.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n, m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a \le b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>7 2
AYBABTU
3 5
3 5
</pre>
<p>Output:</p>
<pre>AYABTUB
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem203"></a>
    <h1>Problem 203: Reachable Nodes</h1>
    <div class="problem"><div class="content">
<title>CSES - Substring Reversals</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2073"/>
<div class="md"><p>Given a string, your task is to process operations where you reverse a substring of the string. What is the final string after all the operations?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the length of the string and the number of operations. The characters of the string are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>The next line has a string of length <span class="math math-inline">n</span> that consists of characters A–Z.</p>
<p>Finally, there are <span class="math math-inline">m</span> lines that describe the operations. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: you reverse a substring from position <span class="math math-inline">a</span> to position <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>Print the final string after all the operations.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n, m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a \le b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>7 2
AYBABTU
3 4
4 7
</pre>
<p>Output:</p>
<pre>AYAUTBB
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem204"></a>
    <h1>Problem 204: Reachability Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - Reversals and Sums</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2074"/>
<div class="md"><p>Given an array of <span class="math math-inline">n</span> integers, you have to process following operations:</p>
<ol>
<li>reverse a subarray</li>
<li>calculate the sum of values in a subarray</li>
</ol>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the size of the array and the number of operations. The array elements are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>The next line as <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the contents of the array.</p>
<p>Finally, there are <span class="math math-inline">m</span> lines that describe the operations. Each line has three integers <span class="math math-inline">t</span>, <span class="math math-inline">a</span> and <span class="math math-inline">b</span>. If <span class="math math-inline">t=1</span>, you should reverse a subarray from <span class="math math-inline">a</span> to <span class="math math-inline">b</span>. If <span class="math math-inline">t=2</span>, you should calculate the sum of values from <span class="math math-inline">a</span> to <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>Print the answer to each operation where <span class="math math-inline">t=2</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 10^5</span></li>
<li><span class="math math-inline">0 \le x_i \le 10^9</span></li>
<li><span class="math math-inline">1 \le a \le b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8 3
2 1 3 4 5 3 4 4
2 2 4
1 3 6
2 2 4
</pre>
<p>Output:</p>
<pre>8
9
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem205"></a>
    <h1>Problem 205: Cut and Paste</h1>
    <div class="problem"><div class="content">
<title>CSES - Reversal Sorting</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2075"/>
<div class="md"><p>You have an array that contains a permutation of integers <span class="math math-inline">1,2,\dots,n</span>. Your task is to sort the array in increasing order by reversing subarrays. You can construct any solution that has at most <span class="math math-inline">n</span> reversals.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the size of the array. The array elements are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the contents of the array.</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math math-inline">k</span>: the number of reversals.</p>
<p>After that, print <span class="math math-inline">k</span> lines that describe the reversals. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: you reverse a subarray from position <span class="math math-inline">a</span> to position <span class="math math-inline">b</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4
2 3 1 4
</pre>
<p>Output:</p>
<pre>2
1 3
2 3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem206"></a>
    <h1>Problem 206: Substring Reversals</h1>
    <div class="problem"><div class="content">
<title>CSES - Necessary Roads</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2076"/>
<div class="md"><p>There are <span class="math math-inline">n</span> cities and <span class="math math-inline">m</span> roads between them. There is a route between any two cities.</p>
<p>A road is called <em>necessary</em> if there is no route between some two cities after removing that road. Your task is to find all necessary roads.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of cities and roads. The cities are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>After this, there are <span class="math math-inline">m</span> lines that describe the roads. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is a road between cities <span class="math math-inline">a</span> and <span class="math math-inline">b</span>. There is at most one road between two cities, and every road connects two distinct cities.</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math math-inline">k</span>: the number of necessary roads. After that, print <span class="math math-inline">k</span> lines that describe the roads. You may print the roads in any order.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">2 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 5
1 2
1 4
2 4
3 5
4 5
</pre>
<p>Output:</p>
<pre>2
3 5
4 5
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem207"></a>
    <h1>Problem 207: Reversals and Sums</h1>
    <div class="problem"><div class="content">
<title>CSES - Necessary Cities</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2077"/>
<div class="md"><p>There are <span class="math math-inline">n</span> cities and <span class="math math-inline">m</span> roads between them. There is a route between any two cities.</p>
<p>A city is called <em>necessary</em> if there is no route between some other two cities after removing that city (and adjacent roads). Your task is to find all necessary cities.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of cities and roads. The cities are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>After this, there are <span class="math math-inline">m</span> lines that describe the roads. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is a road between cities <span class="math math-inline">a</span> and <span class="math math-inline">b</span>. There is at most one road between two cities, and every road connects two distinct cities.</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math math-inline">k</span>: the number of necessary cities. After that, print a list of <span class="math math-inline">k</span> cities. You may print the cities in any order.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">2 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 5
1 2
1 4
2 4
3 5
4 5
</pre>
<p>Output:</p>
<pre>2
4 5
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem208"></a>
    <h1>Problem 208: Necessary Roads</h1>
    <div class="problem"><div class="content">
<title>CSES - Eulerian Subgraphs</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2078"/>
<div class="md"><p>You are given an undirected graph that has <span class="math math-inline">n</span> nodes and <span class="math math-inline">m</span> edges.</p>
<p>We consider subgraphs that have all nodes of the original graph and some of its edges. A subgraph is called <em>Eulerian</em> if each node has even degree.</p>
<p>Your task is to count the number of Eulerian subgraphs modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of nodes and edges. The nodes are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>After this, there are <span class="math math-inline">m</span> lines that describe the edges. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>. There is at most one edge between two nodes, and each edge connects two distinct nodes.</p>
<h1 id="output">Output</h1>
<p>Print the number of Eulerian subgraphs modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">0 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 3
1 2
1 3
2 3
</pre>
<p>Output:</p>
<pre>2
</pre>
<p>Explanation: You can either keep or remove all edges, so there are two possible Eulerian subgraphs.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem209"></a>
    <h1>Problem 209: Necessary Cities</h1>
    <div class="problem"><div class="content">
<title>CSES - Finding a Centroid</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2079"/>
<div class="md"><p>Given a tree of <span class="math math-inline">n</span> nodes, your task is to find a <em>centroid</em>, i.e., a node such that when it is appointed the root of the tree, each subtree has at most <span class="math math-inline">\lfloor n/2 \rfloor</span> nodes.</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">n</span>: the number of nodes. The nodes are numbered <span class="math math-inline">1,2,…,n</span>.</p>
<p>Then there are <span class="math math-inline">n-1</span> lines describing the edges. Each line contains two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>Print one integer: a centroid node. If there are several possibilities, you can choose any of them.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
1 2
2 3
3 4
3 5
</pre>
<p>Output:</p>
<pre>3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem210"></a>
    <h1>Problem 210: Eulerian Subgraphs</h1>
    <div class="problem"><div class="content">
<title>CSES - Fixed-Length Paths I</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2080"/>
<div class="md"><p>Given a tree of <span class="math math-inline">n</span> nodes, your task is to count the number of distinct paths that consist of exactly <span class="math math-inline">k</span> edges.</p>
<h1 id="input">Input</h1>
<p>The first input line contains two integers <span class="math math-inline">n</span> and <span class="math math-inline">k</span>: the number of nodes and the path length. The nodes are numbered <span class="math math-inline">1,2,\ldots,n</span>.</p>
<p>Then there are <span class="math math-inline">n-1</span> lines describing the edges. Each line contains two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of paths.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le k \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 2
1 2
2 3
3 4
3 5
</pre>
<p>Output:</p>
<pre>4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem211"></a>
    <h1>Problem 211: Monster Game I</h1>
    <div class="problem"><div class="content">
<title>CSES - Fixed-Length Paths II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2081"/>
<div class="md"><p>Given a tree of <span class="math math-inline">n</span> nodes, your task is to count the number of distinct paths that have at least <span class="math math-inline">k_1</span> and at most <span class="math math-inline">k_2</span> edges.</p>
<h1 id="input">Input</h1>
<p>The first input line contains three integers <span class="math math-inline">n</span>, <span class="math math-inline">k_1</span> and <span class="math math-inline">k_2</span>: the number of nodes and the path lengths. The nodes are numbered <span class="math math-inline">1,2,\ldots,n</span>.</p>
<p>Then there are <span class="math math-inline">n-1</span> lines describing the edges. Each line contains two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of paths.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le k_1 \le k_2 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 2 3
1 2
2 3
3 4
3 5
</pre>
<p>Output:</p>
<pre>6
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem212"></a>
    <h1>Problem 212: Monster Game II</h1>
    <div class="problem"><div class="content">
<title>CSES - Monster Game I</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2084"/>
<div class="md"><p>You are playing a game that consists of <span class="math math-inline">n</span> levels. Each level has a monster. On levels <span class="math math-inline">1,2,\dots,n-1</span>, you can either kill or escape the monster. However, on level <span class="math math-inline">n</span> you must kill the final monster to win the game.</p>
<p>Killing a monster takes <span class="math math-inline">sf</span> time where <span class="math math-inline">s</span> is the monster's strength and <span class="math math-inline">f</span> is your skill factor (lower skill factor is better). After killing a monster, you get a new skill factor. What is the minimum total time in which you can win the game?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">x</span>: the number of levels and your initial skill factor.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">s_1,s_2,\dots,s_n</span>: each monster's strength.</p>
<p>The third line has <span class="math math-inline">n</span> integers <span class="math math-inline">f_1,f_2,\dots,f_n</span>: your new skill factor after killing a monster.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum total time to win the game.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x \le 10^6</span></li>
<li><span class="math math-inline">1 \le s_1 \le s_2 \le \dots \le s_n \le 10^6</span></li>
<li><span class="math math-inline">x \ge f_1 \ge f_2 \ge \dots \ge f_n \ge 1</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 100
20 30 30 50 90
90 60 20 20 10
</pre>
<p>Output:</p>
<pre>4800
</pre>
<p>Explanation: The best way to play is to kill the third and fifth monster.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem213"></a>
    <h1>Problem 213: Subarray Squares</h1>
    <div class="problem"><div class="content">
<title>CSES - Monster Game II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2085"/>
<div class="md"><p>You are playing a game that consists of <span class="math math-inline">n</span> levels. Each level has a monster. On levels <span class="math math-inline">1,2,\dots,n-1</span>, you can either kill or escape the monster. However, on level <span class="math math-inline">n</span> you must kill the final monster to win the game.</p>
<p>Killing a monster takes <span class="math math-inline">sf</span> time where <span class="math math-inline">s</span> is the monster's strength and <span class="math math-inline">f</span> is your skill factor. After killing a monster, you get a new skill factor  (lower skill factor is better). What is the minimum total time in which you can win the game?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">x</span>: the number of levels and your initial skill factor.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">s_1,s_2,\dots,s_n</span>: each monster's strength.</p>
<p>The third line has <span class="math math-inline">n</span> integers <span class="math math-inline">f_1,f_2,\dots,f_n</span>: your new skill factor after killing a monster.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum total time to win the game.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x \le 10^6</span></li>
<li><span class="math math-inline">1 \le s_i, f_i \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 100
50 20 30 90 30
60 20 20 10 90
</pre>
<p>Output:</p>
<pre>2600
</pre>
<p>Explanation: The best way to play is to kill the second and fifth monster.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem214"></a>
    <h1>Problem 214: Houses and Schools</h1>
    <div class="problem"><div class="content">
<title>CSES - Subarray Squares</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2086"/>
<div class="md"><p>Given an array of <span class="math math-inline">n</span> elements, your task is to divide into <span class="math math-inline">k</span> subarrays. The cost of each subarray is the square of the sum of the values in the subarray. What is the minimum total cost if you act optimally?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">k</span>: the array elements and the number of subarrays. The array elements are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the contents of the array.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum total cost.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le k \le n \le 3000</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8 3
2 3 1 2 2 3 4 1
</pre>
<p>Output:</p>
<pre>110
</pre>
<p>Explanation: An optimal solution is <span class="math math-inline">[2,3,1]</span>, <span class="math math-inline">[2,2,3]</span>, <span class="math math-inline">[4,1]</span>, whose cost is <span class="math math-inline">(2+3+1)^2+(2+2+3)^2+(4+1)^2=110</span>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem215"></a>
    <h1>Problem 215: Knuth Division</h1>
    <div class="problem"><div class="content">
<title>CSES - Houses and Schools</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2087"/>
<div class="md"><p>There are <span class="math math-inline">n</span> houses on a street, numbered <span class="math math-inline">1,2,\dots,n</span>. The distance of houses <span class="math math-inline">a</span> and <span class="math math-inline">b</span> is <span class="math math-inline">|a-b|</span>. You know the number of children in each house.</p>
<p>Your task is to establish <span class="math math-inline">k</span> schools in such a way that each school is in some house. Then, each child goes to the nearest school. What is the minimum total walking distance of the children if you act optimally?</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">k</span>: the number of houses and the number of schools. The houses are numbered <span class="math math-inline">1,2\dots,n</span>.</p>
<p>After this, there are <span class="math math-inline">n</span> integers <span class="math math-inline">c_1,c_2,\dots,c_n</span>: the number of children in each house.</p>
<h1 id="output">Output</h1>
<p>Print the minimum total distance.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le k \le n \le 3000</span></li>
<li><span class="math math-inline">1 \le c_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>6 2
2 7 1 4 6 4
</pre>
<p>Output:</p>
<pre>11
</pre>
<p>Explanation: Houses 2 and 5 will have schools.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem216"></a>
    <h1>Problem 216: Apples and Bananas</h1>
    <div class="problem"><div class="content">
<title>CSES - Knuth Division</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2088"/>
<div class="md"><p>Given an array of <span class="math math-inline">n</span> numbers, your task is to divide it into <span class="math math-inline">n</span> subarrays, each of which has a single element.</p>
<p>On each move, you may choose any subarray and split it into two subarrays. The cost of such a move is the sum of values in the chosen subarray.</p>
<p>What is the minimum total cost if you act optimally?</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the array size. The array elements are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the contents of the array.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum total cost.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 5000</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
2 7 3 2 5
</pre>
<p>Output:</p>
<pre>43
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem217"></a>
    <h1>Problem 217: One Bit Positions</h1>
    <div class="problem"><div class="content">
<title>CSES - New Roads Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2101"/>
<div class="md"><p>There are <span class="math math-inline">n</span> cities in Byteland but no roads between them. However, each day, a new road will be built. There will be a total of <span class="math math-inline">m</span> roads.</p>
<p>Your task is to process <span class="math math-inline">q</span> queries of the form: "after how many days can we travel from city <span class="math math-inline">a</span> to city <span class="math math-inline">b</span> for the first time?"</p>
<h1 id="input">Input</h1>
<p>The first input line has three integers <span class="math math-inline">n</span>, <span class="math math-inline">m</span> and <span class="math math-inline">q</span>: the number of cities, roads and queries. The cities are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>After this, there are <span class="math math-inline">m</span> lines that describe the roads in the order they are built. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there will be a road between cities <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines that describe the queries. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: we want to travel from city <span class="math math-inline">a</span> to city <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>For each query, print the number of days, or <span class="math math-inline">-1</span> if it is never possible.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n, m, q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 4 3
1 2
2 3
1 3
2 5
1 3
3 4
3 5
</pre>
<p>Output:</p>
<pre>2
-1
4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem218"></a>
    <h1>Problem 218: Signal Processing</h1>
    <div class="problem"><div class="content">
<title>CSES - Finding Patterns</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2102"/>
<div class="md"><p>Given a string and patterns, check for each pattern if it appears in the string.</p>
<h1 id="input">Input</h1>
<p>The first input line has a string of length <span class="math math-inline">n</span>.</p>
<p>The next input line has an integer <span class="math math-inline">k</span>: the number of patterns. Finally, there are <span class="math math-inline">k</span> lines that describe the patterns.</p>
<p>The string and the patterns consist of characters a–z.</p>
<h1 id="output">Output</h1>
<p>For each pattern, print "YES" if it appears in the string and "NO" otherwise.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le k \le 5 \cdot 10^5</span></li>
<li>the total length of the patterns is at most <span class="math math-inline">5 \cdot 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>aybabtu
3
bab
abc
ayba
</pre>
<p>Output:</p>
<pre>YES
NO
YES
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem219"></a>
    <h1>Problem 219: New Roads Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - Counting Patterns</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2103"/>
<div class="md"><p>Given a string and patterns, count for each pattern the number of positions where it appears in the string.</p>
<h1 id="input">Input</h1>
<p>The first input line has a string of length <span class="math math-inline">n</span>.</p>
<p>The next input line has an integer <span class="math math-inline">k</span>: the number of patterns. Finally, there are <span class="math math-inline">k</span> lines that describe the patterns.</p>
<p>The string and the patterns consist of characters a–z.</p>
<h1 id="output">Output</h1>
<p>For each pattern, print the number of positions.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le k \le 5 \cdot 10^5</span></li>
<li>the total length of the patterns is at most <span class="math math-inline">5 \cdot 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>aybabtu
3
bab
abc
a
</pre>
<p>Output:</p>
<pre>1
0
2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem220"></a>
    <h1>Problem 220: Dynamic Connectivity</h1>
    <div class="problem"><div class="content">
<title>CSES - Pattern Positions</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2104"/>
<div class="md"><p>Given a string and patterns, find for each pattern the first position (1-indexed) where it appears in the string.</p>
<h1 id="input">Input</h1>
<p>The first input line has a string of length <span class="math math-inline">n</span>.</p>
<p>The next input line has an integer <span class="math math-inline">k</span>: the number of patterns. Finally, there are <span class="math math-inline">k</span> lines that describe the patterns.</p>
<p>The string and the patterns consist of characters a–z.</p>
<h1 id="output">Output</h1>
<p>Print the first position for each pattern (or <span class="math math-inline">-1</span> if it does not appear at all).</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le k \le 5 \cdot 10^5</span></li>
<li>the total length of the patterns is at most <span class="math math-inline">5 \cdot 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>aybabtu
3
bab
abc
a
</pre>
<p>Output:</p>
<pre>3
-1
1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem221"></a>
    <h1>Problem 221: Parcel Delivery</h1>
    <div class="problem"><div class="content">
<title>CSES - Distinct Substrings</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2105"/>
<div class="md"><p>Count the number of distinct substrings that appear in a string.</p>
<h1 id="input">Input</h1>
<p>The only input line has a string of length <span class="math math-inline">n</span> that consists of characters a–z.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of substrings.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>abaa
</pre>
<p>Output:</p>
<pre>8
</pre>
<p>Explanation: the substrings are <code>a</code>, <code>b</code>, <code>aa</code>, <code>ab</code>, <code>ba</code>, <code>aba</code>, <code>baa</code> and <code>abaa</code>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem222"></a>
    <h1>Problem 222: Task Assignment</h1>
    <div class="problem"><div class="content">
<title>CSES - Repeating Substring</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2106"/>
<div class="md"><p>A repeating substring is a substring that occurs in two (or more) locations in the string. Your task is to find the longest repeating substring in a given string.</p>
<h1 id="input">Input</h1>
<p>The only input line has a string of length <span class="math math-inline">n</span> that consists of characters a–z.</p>
<h1 id="output">Output</h1>
<p>Print the longest repeating substring. If there are several possibilities, you can print any of them. If there is no repeating substring, print <span class="math math-inline">-1</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>cabababc
</pre>
<p>Output:</p>
<pre>abab
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem223"></a>
    <h1>Problem 223: Distinct Routes II</h1>
    <div class="problem"><div class="content">
<title>CSES - String Functions</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2107"/>
<div class="md"><p>We consider a string of <span class="math math-inline">n</span> characters, indexed <span class="math math-inline">1,2,\dots,n</span>. Your task is to calculate all values of the following functions:</p>
<ul>
<li><span class="math math-inline">z(i)</span> denotes the maximum length of a substring that begins at position <span class="math math-inline">i</span> and is a prefix of the string. In addition, <span class="math math-inline">z(1)=0</span>.</li>
<li><span class="math math-inline">\pi(i)</span> denotes the maximum length of a substring that ends at position <span class="math math-inline">i</span>, is a prefix of the string, and whose length is at most <span class="math math-inline">i-1</span>.</li>
</ul>
<p>Note that the function <span class="math math-inline">z</span> is used in the Z-algorithm, and the function <span class="math math-inline">\pi</span> is used in the KMP algorithm.</p>
<h1 id="input">Input</h1>
<p>The only input line has a string of length <span class="math math-inline">n</span>. Each character is between a–z.</p>
<h1 id="output">Output</h1>
<p>Print two lines: first the values of the <span class="math math-inline">z</span> function, and then the values of the <span class="math math-inline">\pi</span> function.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>abaabca
</pre>
<p>Output:</p>
<pre>0 0 1 2 0 0 1
0 0 1 1 2 0 1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem224"></a>
    <h1>Problem 224: Shortest Subsequence</h1>
    <div class="problem"><div class="content">
<title>CSES - Substring Order I</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2108"/>
<div class="md"><p>You are given a string of length <span class="math math-inline">n</span>. If all of its distinct substrings are ordered lexicographically, what is the <span class="math math-inline">k</span>th smallest of them?</p>
<h1 id="input">Input</h1>
<p>The first input line has a string of length <span class="math math-inline">n</span> that consists of characters a–z.</p>
<p>The second input line has an integer <span class="math math-inline">k</span>.</p>
<h1 id="output">Output</h1>
<p>Print the <span class="math math-inline">k</span>th smallest distinct substring in lexicographical order.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le k \le \frac{n(n+1)}{2}</span></li>
<li>It is guaranteed that <span class="math math-inline">k</span> does not exceed the number of distinct substrings.</li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>babaacbaab
10
</pre>
<p>Output:</p>
<pre>aba
</pre>
<p>Explanation: The 10 smallest distinct substrings in order are a, aa, aab, aac, aacb, aacba, aacbaa, aacbaab, ab, and aba.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem225"></a>
    <h1>Problem 225: Counting Bits</h1>
    <div class="problem"><div class="content">
<title>CSES - Substring Order II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2109"/>
<div class="md"><p>You are given a string of length <span class="math math-inline">n</span>. If all of its substrings (not necessarily distinct) are ordered lexicographically, what is the <span class="math math-inline">k</span>th smallest of them?</p>
<h1 id="input">Input</h1>
<p>The first input line has a string of length <span class="math math-inline">n</span> that consists of characters a–z.</p>
<p>The second input line has an integer <span class="math math-inline">k</span>.</p>
<h1 id="output">Output</h1>
<p>Print the <span class="math math-inline">k</span>th smallest substring in lexicographical order.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le k \le \frac{n(n+1)}{2}</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>baabaa
10
</pre>
<p>Output:</p>
<pre>ab
</pre>
<p>Explanation: The 10 smallest substrings in order are a, a, a, a, aa, aa, aab, aaba, aabaa, and ab.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem226"></a>
    <h1>Problem 226: Swap Game</h1>
    <div class="problem"><div class="content">
<title>CSES - Substring Distribution</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2110"/>
<div class="md"><p>You are given a string of length <span class="math math-inline">n</span>. For every integer between <span class="math math-inline">1 \ldots n</span> you need to print the number of distinct substrings of that length.</p>
<h1 id="input">Input</h1>
<p>The only input line has a string of length <span class="math math-inline">n</span> that consists of characters a–z.</p>
<h1 id="output">Output</h1>
<p>For each integer between <span class="math math-inline">1 \ldots n</span> print the number of distinct substrings of that length.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>abab
</pre>
<p>Output:</p>
<pre>2 2 2 1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem227"></a>
    <h1>Problem 227: Prüfer Code</h1>
    <div class="problem"><div class="content">
<title>CSES - Apples and Bananas</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2111"/>
<div class="md"><p>There are <span class="math math-inline">n</span> apples and <span class="math math-inline">m</span> bananas, and each of them has an integer weight between <span class="math math-inline">1 \ldots k</span>. Your task is to calculate, for each weight <span class="math math-inline">w</span> between <span class="math math-inline">2 \dots 2k</span>, the number of ways we can choose an apple and a banana whose combined weight is <span class="math math-inline">w</span>.</p>
<h1 id="input">Input</h1>
<p>The first input line contains three integers <span class="math math-inline">k</span>, <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number <span class="math math-inline">k</span>, the number of apples and the number of bananas.</p>
<p>The next line contains <span class="math math-inline">n</span> integers <span class="math math-inline">a_1,a_2,\ldots,a_n</span>: weight of each apple.</p>
<p>The last line contains <span class="math math-inline">m</span> integers <span class="math math-inline">b_1,b_2,\ldots,b_m</span>: weight of each banana.</p>
<h1 id="output">Output</h1>
<p>For each integer <span class="math math-inline">w</span> between <span class="math math-inline">2 \ldots 2k</span> print the number of ways to choose an apple and a banana whose combined weight is <span class="math math-inline">w</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le k,n,m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a_i \le k</span></li>
<li><span class="math math-inline">1 \le b_i \le k</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3 4
5 2 5
4 3 2 3
</pre>
<p>Output:</p>
<pre>0 0 1 2 1 2 4 2 0  
</pre>
<p>Explanation: For example for <span class="math math-inline">w</span> = <span class="math math-inline">8</span> there are <span class="math math-inline">4</span> different ways: we can pick an apple of weight <span class="math math-inline">5</span> in two different ways and a banana of weight <span class="math math-inline">3</span> in two different ways.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem228"></a>
    <h1>Problem 228: Acyclic Graph Edges</h1>
    <div class="problem"><div class="content">
<title>CSES - One Bit Positions</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2112"/>
<div class="md"><p>You are given a binary string of length <span class="math math-inline">n</span>. Your task is to calculate, for every <span class="math math-inline">k</span> between <span class="math math-inline">1 \ldots n-1</span>, the number of ways we can choose two positions <span class="math math-inline">i</span> and <span class="math math-inline">j</span> such that <span class="math math-inline">i-j=k</span> and there is a one-bit at both positions.</p>
<h1 id="input">Input</h1>
<p>The only input line has a string that consists only of characters <span class="math math-inline">0</span> and <span class="math math-inline">1</span>.</p>
<h1 id="output">Output</h1>
<p>For every distance <span class="math math-inline">k</span> between <span class="math math-inline">1\ldots n-1</span> print the number of ways we can choose two such positions.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">2 \le n \le 2 \cdot 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>1001011010
</pre>
<p>Output:</p>
<pre>1 2 3 0 2 1 0 1 0
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem229"></a>
    <h1>Problem 229: Strongly Connected Edges</h1>
    <div class="problem"><div class="content">
<title>CSES - Signal Processing</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2113"/>
<div class="md"><p>You are given two integer sequences: a signal and a mask. Your task is to process the signal by moving the mask through the signal from left to right. At each mask position calculate the sum of products of aligned signal and mask values in the part where the signal and the mask overlap.</p>
<h1 id="input">Input</h1>
<p>The first input line consists of two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the length of the signal and the length of the mask.</p>
<p>The next line consists of <span class="math math-inline">n</span> integers <span class="math math-inline">a_1,a_2,\ldots,a_n</span> defining the signal.</p>
<p>The last line consists of <span class="math math-inline">m</span> integers <span class="math math-inline">b_1,b_2,\ldots,b_m</span> defining the mask.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">n+m-1</span> integers: the sum of products of aligned values at each mask position from left to right.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a_i,b_i \le 100</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3
1 3 2 1 4
1 2 3
</pre>
<p>Output:</p>
<pre>3 11 13 10 16 9 4
</pre>
<p>Explanation: For example, at the second mask position the sum of aligned products is <span class="math math-inline">2 \cdot 1 + 3 \cdot 3 = 11</span>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem230"></a>
    <h1>Problem 230: Even Outdegree Edges</h1>
    <div class="problem"><div class="content">
<title>CSES - Bit Substrings</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2115"/>
<div class="md"><p>You are given a bit string of length <span class="math math-inline">n</span>. Your task is to calculate for each <span class="math math-inline">k</span> between <span class="math math-inline">0  \ldots n</span> the number of non-empty substrings that contain exactly <span class="math math-inline">k</span> ones.</p>
<p>For example, if the string is 101, there are:</p>
<ul>
<li>1 substring that contains 0 ones: 0</li>
<li>4 substrings that contain 1 one: 01, 1, 1, 10</li>
<li>1 substring that contains 2 ones: 101</li>
<li>0 substrings that contain 3 ones</li>
</ul>
<h1 id="input">Input</h1>
<p>The only input line contains a binary string of length <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">n+1</span> values as specified above.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>101
</pre>
<p>Output:</p>
<pre>1 4 1 0 
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem231"></a>
    <h1>Problem 231: Multiplication Table</h1>
    <div class="problem"><div class="content">
<title>CSES - Parcel Delivery</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2121"/>
<div class="md"><p>There are <span class="math math-inline">n</span> cities and <span class="math math-inline">m</span> routes through which parcels can be carried from one city to another city. For each route, you know the maximum number of parcels and the cost of a single parcel.</p>
<p>You want to send <span class="math math-inline">k</span> parcels from Syrjälä to Lehmälä. What is the cheapest way to do that?</p>
<h1 id="input">Input</h1>
<p>The first input line has three integers <span class="math math-inline">n</span>, <span class="math math-inline">m</span> and <span class="math math-inline">k</span>: the number of cities, routes and parcels. The cities are numbered <span class="math math-inline">1,2,\dots,n</span>. City <span class="math math-inline">1</span> is Syrjälä and city <span class="math math-inline">n</span> is Lehmälä.</p>
<p>After this, there are <span class="math math-inline">m</span> lines that describe the routes. Each line has four integers <span class="math math-inline">a</span>, <span class="math math-inline">b</span>, <span class="math math-inline">r</span> and <span class="math math-inline">c</span>: there is a route from city <span class="math math-inline">a</span> to city <span class="math math-inline">b</span>, at most <span class="math math-inline">r</span> parcels can be carried through the route, and the cost of each parcel is <span class="math math-inline">c</span>.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum total cost or <span class="math math-inline">-1</span> if there are no solutions.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">2 \le n \le 500</span></li>
<li><span class="math math-inline">1 \le m \le 1000</span></li>
<li><span class="math math-inline">1 \le k \le 100</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
<li><span class="math math-inline">1 \le r,c \le 1000</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 5 3
1 2 5 100
1 3 10 50
1 4 7 500
2 4 8 350
3 4 2 100
</pre>
<p>Output:</p>
<pre>750
</pre>
<p>Explanation: One parcel is delivered through route <span class="math math-inline">1 \rightarrow 2 \rightarrow 4</span> (cost <span class="math math-inline">1 \cdot 450=450</span>) and two parcels are delivered through route <span class="math math-inline">1 \rightarrow 3 \rightarrow 4</span> (cost <span class="math math-inline">2 \cdot 150=300</span>).</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem232"></a>
    <h1>Problem 232: Advertisement</h1>
    <div class="problem"><div class="content">
<title>CSES - Task Assignment</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2129"/>
<div class="md"><p>A company has <span class="math math-inline">n</span> employees and there are <span class="math math-inline">n</span> tasks that need to be done. We know for each employee the cost of carrying out each task. Every employee should be assigned to exactly one task. What is the minimum total cost if we assign the tasks optimally and how could they be assigned?</p>
<h1 id="input">Input</h1>
<p>The first input line has one integer <span class="math math-inline">n</span>: the number of employees and the number of tasks that need to be done.</p>
<p>After this, there are <span class="math math-inline">n</span> lines each consisting of <span class="math math-inline">n</span> integers. The <span class="math math-inline">i</span>th line consists of integers <span class="math math-inline">c_{i1},c_{i2},\ldots,c_{in}</span>: the cost of each task when it is assigned to the <span class="math math-inline">i</span>th employee.</p>
<h1 id="output">Output</h1>
<p>First print the minimum total cost.</p>
<p>Then print <span class="math math-inline">n</span> lines each consisting of two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: you assign the <span class="math math-inline">b</span>th task to the <span class="math math-inline">a</span>th employee.</p>
<p>If there are multiple solutions you can print any of them.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 200</span></li>
<li><span class="math math-inline">1 \le c_{ij} \le 1000</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4
17 8 16 9
7 15 12 19
6 9 10 11
14 7 13 10
</pre>
<p>Output:</p>
<pre>33
1 4
2 1
3 3
4 2
</pre>
<p>Explanation: The minimum total cost is <span class="math math-inline">33</span>. We can reach this by assigning employee 1 task 4, employee 2 task 1, employee 3 task 3 and employee 4 task 2. This will cost <span class="math math-inline">9 + 7 + 10 + 7 = 33</span>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem233"></a>
    <h1>Problem 233: Special Substrings</h1>
    <div class="problem"><div class="content">
<title>CSES - Distinct Routes II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2130"/>
<div class="md"><p>A game consists of <span class="math math-inline">n</span> rooms and <span class="math math-inline">m</span> teleporters. At the beginning of each day, you start in room <span class="math math-inline">1</span> and you have to reach room <span class="math math-inline">n</span>.</p>
<p>You can use each teleporter at most once during the game. You want to play the game for exactly <span class="math math-inline">k</span> days. Every time you use any teleporter you have to pay one coin. What is the minimum number of coins you have to pay during <span class="math math-inline">k</span> days if you play optimally?</p>
<h1 id="input">Input</h1>
<p>The first input line has three integers <span class="math math-inline">n</span>, <span class="math math-inline">m</span> and <span class="math math-inline">k</span>: the number of rooms, the number of teleporters and the number of days you play the game. The rooms are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>After this, there are <span class="math math-inline">m</span> lines describing the teleporters. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is a teleporter from room <span class="math math-inline">a</span> to room <span class="math math-inline">b</span>.</p>
<p>There are no two teleporters whose starting and ending room are the same.</p>
<h1 id="output">Output</h1>
<p>First print one integer: the minimum number of coins you have to pay if you play optimally. Then, print <span class="math math-inline">k</span> route descriptions according to the example. You can print any valid solution.</p>
<p>If it is not possible to play the game for <span class="math math-inline">k</span> days, print only -1.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">2 \le n \le 500</span></li>
<li><span class="math math-inline">1 \le m \le 1000</span></li>
<li><span class="math math-inline">1 \le k \le n-1</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8 10 2
1 2
1 3
2 5
2 4
3 5 
3 6
4 8
5 8
6 7 
7 8
</pre>
<p>Output:</p>
<pre>6
4
1 2 4 8 
4
1 3 5 8 
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem234"></a>
    <h1>Problem 234: Permutation Inversions</h1>
    <div class="problem"><div class="content">
<title>CSES - Grid Puzzle II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2131"/>
<div class="md"><p>There is an <span class="math math-inline">n \times n</span> grid whose each square has some number of coins in it.</p>
<p>You know for each row and column how many squares you must choose from that row or column. You get all coins from every square you choose. What is the maximum number of coins you can collect and how could you choose the squares so that the given conditions are satisfied?</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the size of the grid. The rows and columns are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">a_1,a_2,\ldots,a_n</span>: You must choose exactly <span class="math math-inline">a_i</span> squares from the <span class="math math-inline">i</span>th row.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">b_1,b_2,\ldots,b_n</span>: You must choose exactly <span class="math math-inline">b_j</span> squares from the <span class="math math-inline">j</span>th column.</p>
<p>Finally, there are <span class="math math-inline">n</span> lines describing the grid. You can assume that the sums of <span class="math math-inline">a_1,a_2,\ldots,a_n</span> and <span class="math math-inline">b_1,b_2,\ldots,b_n</span> are equal.</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math math-inline">k</span>: the maximum number of coins you can collect. After this print <span class="math math-inline">n</span> lines describing which squares you choose (<code>X</code> means that you choose a square, <code>.</code> means that you don't choose it).</p>
<p>If it is not possible to satisfy the conditions print only <span class="math math-inline">-1</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 50</span></li>
<li><span class="math math-inline">0 \le a_i \le n</span></li>
<li><span class="math math-inline">0 \le b_j \le n</span></li>
<li><span class="math math-inline">0 \le c_{ij} \le 1000</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
0 1 3 2 0
1 2 2 0 1
2 5 1 5 1
0 2 5 1 2
3 8 9 3 5
1 4 3 7 3
0 3 6 2 8
</pre>
<p>Output:</p>
<pre>32
.....
..X..
.XX.X
XX...
.....
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem235"></a>
    <h1>Problem 235: Maximum Xor Subarray</h1>
    <div class="problem"><div class="content">
<title>CSES - Increasing Array II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2132"/>
<div class="md"><p>You are given an array of <span class="math math-inline">n</span> integers. You want to modify the array so that it is increasing, i.e., every element is at least as large as the previous element.</p>
<p>On each move, you can increase or decrease the value of any element by one. What is the minimum number of moves required?</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">n</span>: the size of the array.</p>
<p>Then, the second line contains <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\ldots,x_n</span>: the contents of the array.</p>
<h1 id="output">Output</h1>
<p>Print the minimum number of moves.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
3 8 5 6 5
</pre>
<p>Output:</p>
<pre>4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem236"></a>
    <h1>Problem 236: Movie Festival Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - Dynamic Connectivity</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2133"/>
<div class="md"><p>Consider an undirected graph that consists of <span class="math math-inline">n</span> nodes and <span class="math math-inline">m</span> edges. There are two types of events that can happen:</p>
<ol>
<li>A new edge is created between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</li>
<li>An existing edge between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span> is removed.</li>
</ol>
<p>Your task is to report the number of components after every event.</p>
<h1 id="input">Input</h1>
<p>The first input line has three integers <span class="math math-inline">n</span>, <span class="math math-inline">m</span> and <span class="math math-inline">k</span>: the number of nodes, edges and events.</p>
<p>After this there are <span class="math math-inline">m</span> lines describing the edges. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>. There is at most one edge between any pair of nodes.</p>
<p>Then there are <span class="math math-inline">k</span> lines describing the events. Each line has the form "<span class="math math-inline">t</span> <span class="math math-inline">a</span> <span class="math math-inline">b</span>" where <span class="math math-inline">t</span> is 1 (create a new edge) or 2 (remove an edge). A new edge is always created between two nodes that do not already have an edge between them, and only existing edges can get removed.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">k+1</span> integers: first the number of components before the first event, and after this the new number of components after each event.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">2 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m,k \le 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3 3
1 4
2 3
3 5
1 2 5
2 3 5
1 1 2
</pre>
<p>Output:</p>
<pre>2 2 2 1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem237"></a>
    <h1>Problem 237: Chess Tournament</h1>
    <div class="problem"><div class="content">
<title>CSES - Path Queries II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2134"/>
<div class="md"><p>You are given a tree consisting of <span class="math math-inline">n</span> nodes. The nodes are numbered <span class="math math-inline">1,2,\ldots,n</span>. Each node has a value.</p>
<p>Your task is to process following types of queries:</p>
<ol>
<li>change the value of node <span class="math math-inline">s</span> to <span class="math math-inline">x</span></li>
<li>find the maximum value on the path between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</li>
</ol>
<h1 id="input">Input</h1>
<p>The first input line contains two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the number of nodes and queries. The nodes are numbered <span class="math math-inline">1,2,\ldots,n</span>.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">v_1,v_2,\ldots,v_n</span>: the value of each node.</p>
<p>Then there are <span class="math math-inline">n-1</span> lines describing the edges. Each line contains two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. Each query is either of the form "1 <span class="math math-inline">s</span> <span class="math math-inline">x</span>" or "2 <span class="math math-inline">a</span> <span class="math math-inline">b</span>".</p>
<h1 id="output">Output</h1>
<p>Print the answer to each query of type 2.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n, q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b, s \le n</span></li>
<li><span class="math math-inline">1 \le v_i, x \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3
2 4 1 3 3
1 2
1 3
2 4
2 5
2 3 5
1 2 2
2 3 5
</pre>
<p>Output:</p>
<pre>4 3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem238"></a>
    <h1>Problem 238: Tree Traversals</h1>
    <div class="problem"><div class="content">
<title>CSES - Hamming Distance</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2136"/>
<div class="md"><p>The Hamming distance between two strings <span class="math math-inline">a</span> and <span class="math math-inline">b</span> of equal length is the number of positions where the strings differ.</p>
<p>You are given <span class="math math-inline">n</span> bit strings, each of length <span class="math math-inline">k</span> and your task is to calculate the minimum Hamming distance between two strings.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">k</span>: the number of bit strings and their length.</p>
<p>Then there are <span class="math math-inline">n</span> lines each consisting of one bit string of length <span class="math math-inline">k</span>.</p>
<h1 id="output">Output</h1>
<p>Print the minimum Hamming distance between two strings.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">2 \le n \le 2 \cdot 10^4</span></li>
<li><span class="math math-inline">1 \le k \le 30</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 6
110111
001000
100001
101000
101110
</pre>
<p>Output:</p>
<pre>1
</pre>
<p>Explanation: The strings <code>101000</code> and <code>001000</code> differ only at the first position.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem239"></a>
    <h1>Problem 239: Network Renovation</h1>
    <div class="problem"><div class="content">
<title>CSES - Beautiful Subgrids</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2137"/>
<div class="md"><p>You are given an <span class="math math-inline">n \times n</span> grid whose each square is either black or white. A subgrid is called <em>beautiful</em> if its height and width is at least two and all of its corners are black. How many beautiful subgrids are there within the given grid?</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the size of the grid.</p>
<p>Then there are <span class="math math-inline">n</span> lines describing the grid: <code>1</code> means that a square is black and <code>0</code> means it is white.</p>
<h1 id="output">Output</h1>
<p>Print the number of beautiful subgrids.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 3000</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
00010
11111
00110
11001
00010
</pre>
<p>Output:</p>
<pre>4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem240"></a>
    <h1>Problem 240: Graph Girth</h1>
    <div class="problem"><div class="content">
<title>CSES - Reachable Nodes</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2138"/>
<div class="md"><p>A directed acyclic graph consists of <span class="math math-inline">n</span> nodes and <span class="math math-inline">m</span> edges. The nodes are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>Calculate for each node the number of nodes you can reach from that node (including the node itself).</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of nodes and edges.</p>
<p>Then there are <span class="math math-inline">m</span> lines describing the edges. Each line has two distinct integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge from node <span class="math math-inline">a</span> to node <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">n</span> integers: for each node the number of reachable nodes.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 5 \cdot 10^4</span></li>
<li><span class="math math-inline">1 \le m \le 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 6
1 2
1 3
1 4
2 3
3 5
4 5
</pre>
<p>Output:</p>
<pre>5 3 2 2 1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem241"></a>
    <h1>Problem 241: Intersection Points</h1>
    <div class="problem"><div class="content">
<title>CSES - Reachability Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2143"/>
<div class="md"><p>A directed graph consists of <span class="math math-inline">n</span> nodes and <span class="math math-inline">m</span> edges. The edges are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>Your task is to answer <span class="math math-inline">q</span> queries of the form "can you reach node <span class="math math-inline">b</span> from node <span class="math math-inline">a</span>?"</p>
<h1 id="input">Input</h1>
<p>The first input line has three integers <span class="math math-inline">n</span>, <span class="math math-inline">m</span> and <span class="math math-inline">q</span>: the number of nodes, edges and queries.</p>
<p>Then there are <span class="math math-inline">m</span> lines describing the edges. Each line has two distinct integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge from node <span class="math math-inline">a</span> to node <span class="math math-inline">b</span>.</p>
<p>Finally there are <span class="math math-inline">q</span> lines describing the queries. Each line consists of two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: "can you reach node <span class="math math-inline">b</span> from node <span class="math math-inline">a</span>?"</p>
<h1 id="output">Output</h1>
<p>Print the answer for each query: either "YES" or "NO".</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 5 \cdot 10^4</span></li>
<li><span class="math math-inline">1 \le m,q \le 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 4 3
1 2
2 3
3 1
4 3
1 3
1 4
4 1
</pre>
<p>Output:</p>
<pre>YES
NO
YES
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem242"></a>
    <h1>Problem 242: Inverse Inversions</h1>
    <div class="problem"><div class="content">
<title>CSES - Josephus Problem I</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2162"/>
<div class="md"><p>Consider a game where there are <span class="math math-inline">n</span> children (numbered <span class="math math-inline">1,2,\dots,n</span>) in a circle. During the game, every other child is removed from the circle until there are no children left. In which order will the children be removed?</p>
<h1 id="input">Input</h1>
<p>The only input line has an integer <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">n</span> integers: the removal order.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>7
</pre>
<p>Output:</p>
<pre>2 4 6 1 5 3 7
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem243"></a>
    <h1>Problem 243: Monotone Subsequences</h1>
    <div class="problem"><div class="content">
<title>CSES - Josephus Problem II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2163"/>
<div class="md"><p>Consider a game where there are <span class="math math-inline">n</span> children (numbered <span class="math math-inline">1,2,\dots,n</span>) in a circle. During the game, repeatedly <span class="math math-inline">k</span> children are skipped and one child is removed from the circle. In which order will the children be removed?</p>
<h1 id="input">Input</h1>
<p>The only input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">k</span>.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">n</span> integers: the removal order.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">0 \le k \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>7 2
</pre>
<p>Output:</p>
<pre>3 6 2 7 5 1 4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem244"></a>
    <h1>Problem 244: String Reorder</h1>
    <div class="problem"><div class="content">
<title>CSES - Josephus Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2164"/>
<div class="md"><p>Consider a game where there are <span class="math math-inline">n</span> children (numbered <span class="math math-inline">1,2,\dots,n</span>) in a circle. During the game, every second child is removed from the circle, until there are no children left.</p>
<p>Your task is to process <span class="math math-inline">q</span> queries of the form: "when there are <span class="math math-inline">n</span> children, who is the <span class="math math-inline">k</span>th child that will be removed?"</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">q</span>: the number of queries.</p>
<p>After this, there are <span class="math math-inline">q</span> lines that describe the queries. Each line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">k</span>: the number of children and the position of the child.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">q</span> integers: the answer for each query.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le q \le 10^5</span></li>
<li><span class="math math-inline">1 \le k \le n \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4
7 1
7 3
2 2
1337 1313
</pre>
<p>Output:</p>
<pre>2
6
1
1107
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem245"></a>
    <h1>Problem 245: Stack Weights</h1>
    <div class="problem"><div class="content">
<title>CSES - Tower of Hanoi</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2165"/>
<div class="md"><p>The Tower of Hanoi game consists of three stacks (left, middle and right) and <span class="math math-inline">n</span> round disks of different sizes. Initially, the left stack has all the disks, in increasing order of size from top to bottom.</p>
<p>The goal is to move all the disks to the right stack using the middle stack. On each move you can move the uppermost disk from a stack to another stack. In addition, it is not allowed to place a larger disk on a smaller disk.</p>
<p>Your task is to find a solution that minimizes the number of moves.</p>
<h1 id="input">Input</h1>
<p>The only input line has an integer <span class="math math-inline">n</span>: the number of disks.</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math math-inline">k</span>: the minimum number of moves.</p>
<p>After this, print <span class="math math-inline">k</span> lines that describe the moves. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: you move a disk from stack <span class="math math-inline">a</span> to stack <span class="math math-inline">b</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 16</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>2
</pre>
<p>Output:</p>
<pre>3
1 2
1 3
2 3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem246"></a>
    <h1>Problem 246: Pyramid Array</h1>
    <div class="problem"><div class="content">
<title>CSES - Prefix Sum Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2166"/>
<div class="md"><p>Given an array of <span class="math math-inline">n</span> integers, your task is to process <span class="math math-inline">q</span> queries of the following types:</p>
<ol>
<li>update the value at position <span class="math math-inline">k</span> to <span class="math math-inline">u</span></li>
<li>what is the maximum prefix sum in range <span class="math math-inline">[a,b]</span>?</li>
</ol>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the number of values and queries.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the array values.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines describing the queries. Each line has three integers: either "<span class="math math-inline">1</span> <span class="math math-inline">k</span> <span class="math math-inline">u</span>" or "<span class="math math-inline">2</span> <span class="math math-inline">a</span> <span class="math math-inline">b</span>".</p>
<h1 id="output">Output</h1>
<p>Print the result of each query of type 2.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">-10^9 \le x_i, u \le 10^9</span></li>
<li><span class="math math-inline">1 \le k \le n</span></li>
<li><span class="math math-inline">1 \le a \le b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8 4
1 2 -1 3 1 -5 1 4
2 2 6
1 4 -2
2 2 6
2 3 4
</pre>
<p>Output:</p>
<pre>5
2
0
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem247"></a>
    <h1>Problem 247: Increasing Subsequence II</h1>
    <div class="problem"><div class="content">
<title>CSES - Nested Ranges Check</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2168"/>
<div class="md"><p>Given <span class="math math-inline">n</span> ranges, your task is to determine for each range if it contains some other range and if some other range contains it.</p>
<p>Range <span class="math math-inline">[a,b]</span> contains range <span class="math math-inline">[c,d]</span> if <span class="math math-inline">a \le c</span> and <span class="math math-inline">d \le b</span>.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of ranges.</p>
<p>After this, there are <span class="math math-inline">n</span> lines that describe the ranges. Each line has two integers <span class="math math-inline">x</span> and <span class="math math-inline">y</span>: the range is <span class="math math-inline">[x,y]</span>.</p>
<p>You may assume that no range appears more than once in the input.</p>
<h1 id="output">Output</h1>
<p>First print a line that describes for each range (in the input order) if it contains some other range (1) or not (0).</p>
<p>Then print a line that describes for each range (in the input order) if some other range contains it (1) or not (0).</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x &lt; y \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4
1 6
2 4
4 8
3 6
</pre>
<p>Output:</p>
<pre>1 0 0 0
0 1 0 1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem248"></a>
    <h1>Problem 248: String Removals</h1>
    <div class="problem"><div class="content">
<title>CSES - Nested Ranges Count</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2169"/>
<div class="md"><p>Given <span class="math math-inline">n</span> ranges, your task is to count for each range how many other ranges it contains and how many other ranges contain it.</p>
<p>Range <span class="math math-inline">[a,b]</span> contains range <span class="math math-inline">[c,d]</span> if <span class="math math-inline">a \le c</span> and <span class="math math-inline">d \le b</span>.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of ranges.</p>
<p>After this, there are <span class="math math-inline">n</span> lines that describe the ranges. Each line has two integers <span class="math math-inline">x</span> and <span class="math math-inline">y</span>: the range is <span class="math math-inline">[x,y]</span>.</p>
<p>You may assume that no range appears more than once in the input.</p>
<h1 id="output">Output</h1>
<p>First print a line that describes for each range (in the input order) how many other ranges it contains.</p>
<p>Then print a line that describes for each range (in the input order) how many other ranges contain it.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x &lt; y \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4
1 6
2 4
4 8
3 6
</pre>
<p>Output:</p>
<pre>2 0 0 0
0 1 0 1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem249"></a>
    <h1>Problem 249: Bit Inversions</h1>
    <div class="problem"><div class="content">
<title>CSES - Removing Digits II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2174"/>
<div class="md"><p>You are given an integer <span class="math math-inline">n</span>. On each step, you may subtract from it any one-digit number that appears in it.</p>
<p>How many steps are required to make the number equal to <span class="math math-inline">0</span>?</p>
<h1 id="input">Input</h1>
<p>The only input line has an integer <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum number of steps.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^{18}</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>27
</pre>
<p>Output:</p>
<pre>5
</pre>
<p>Explanation: An optimal solution is <span class="math math-inline">27 \rightarrow 20 \rightarrow 18 \rightarrow 10 \rightarrow 9 \rightarrow 0</span>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem250"></a>
    <h1>Problem 250: Xor Pyramid</h1>
    <div class="problem"><div class="content">
<title>CSES - Counting Bishops</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2176"/>
<div class="md"><p>Your task is to count the number of ways <span class="math math-inline">k</span> bishops can be placed on an <span class="math math-inline">n \times n</span> chessboard so that no two bishops attack each other.</p>
<p>Two bishops attack each other if they are on the same diagonal.</p>
<h1 id="input">Input</h1>
<p>The only input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">k</span>: the board size and the number of bishops.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of ways modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 500</span></li>
<li><span class="math math-inline">1 \le k \le n^2</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 4
</pre>
<p>Output:</p>
<pre>2728
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem251"></a>
    <h1>Problem 251: Writing Numbers</h1>
    <div class="problem"><div class="content">
<title>CSES - Strongly Connected Edges</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2177"/>
<div class="md"><p>Given an undirected graph, your task is to choose a direction for each edge so that the resulting directed graph is strongly connected.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of nodes and edges. The nodes are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>After this, there are <span class="math math-inline">m</span> lines describing the edges. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<p>You may assume that the graph is simple, i.e., there are at most one edge between two nodes and every edge connects two distinct nodes.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">m</span> lines describing the directions of the edges. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge from node <span class="math math-inline">a</span> to node <span class="math math-inline">b</span>. You can print any valid solution.</p>
<p>If there are no solutions, only print <code>IMPOSSIBLE</code>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3 3
1 2
1 3
2 3
</pre>
<p>Output:</p>
<pre>1 2
2 3
3 1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem252"></a>
    <h1>Problem 252: String Transform</h1>
    <div class="problem"><div class="content">
<title>CSES - Even Outdegree Edges</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2179"/>
<div class="md"><p>Given an undirected graph, your task is to choose a direction for each edge so that in the resulting directed graph each node has an even outdegree. The outdegree of a node is the number of edges coming out of that node.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of nodes and edges. The nodes are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>After this, there are <span class="math math-inline">m</span> lines describing the edges. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge between nodes <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<p>You may assume that the graph is simple, i.e., there is at most one edge between any two nodes and every edge connects two distinct nodes.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">m</span> lines describing the directions of the edges. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: there is an edge from node <span class="math math-inline">a</span> to node <span class="math math-inline">b</span>. You can print any valid solution.</p>
<p>If there are no solutions, only print <code>IMPOSSIBLE</code>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 4
1 2
2 3
3 4
1 4
</pre>
<p>Output:</p>
<pre>1 2
3 2
3 4
1 4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem253"></a>
    <h1>Problem 253: Letter Pair Move Game</h1>
    <div class="problem"><div class="content">
<title>CSES - Coin Arrangement</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2180"/>
<div class="md"><p>There is a <span class="math math-inline">2 \times n</span> grid whose each cell contains some number of coins. The total number of coins is <span class="math math-inline">2n</span>.</p>
<p>Your task is to arrange the coins so that each cell contains exactly one coin. On each move you can choose any coin and move it one step left, right, up or down.</p>
<p>What is the minimum number of moves if you act optimally?</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the width of the grid.</p>
<p>After this, there are two lines that describe the grid. Each line has <span class="math math-inline">n</span> integers: the number of coins in each cell.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the minimum number of moves.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4
0 1 0 1
2 0 1 3
</pre>
<p>Output:</p>
<pre>5
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem254"></a>
    <h1>Problem 254: Maximum Building I</h1>
    <div class="problem"><div class="content">
<title>CSES - Counting Tilings</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2181"/>
<div class="md"><p>Your task is to count the number of ways you can fill an <span class="math math-inline">n \times m</span> grid using <span class="math math-inline">1 \times 2</span> and <span class="math math-inline">2 \times 1</span> tiles.</p>
<h1 id="input">Input</h1>
<p>The only input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of ways modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10</span></li>
<li><span class="math math-inline">1 \le m \le 1000</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 7
</pre>
<p>Output:</p>
<pre>781
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem255"></a>
    <h1>Problem 255: Sorting Methods</h1>
    <div class="problem"><div class="content">
<title>CSES - Divisor Analysis</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2182"/>
<div class="md"><p>Given an integer, your task is to find the number, sum and product of its divisors. As an example, let us consider the number <span class="math math-inline">12</span>:</p>
<ul>
<li>the number of divisors is <span class="math math-inline">6</span> (they are <span class="math math-inline">1</span>, <span class="math math-inline">2</span>, <span class="math math-inline">3</span>, <span class="math math-inline">4</span>, <span class="math math-inline">6</span>, <span class="math math-inline">12</span>)</li>
<li>the sum of divisors is <span class="math math-inline">1+2+3+4+6+12=28</span></li>
<li>the product of divisors is <span class="math math-inline">1 \cdot 2 \cdot 3 \cdot 4 \cdot 6 \cdot 12 = 1728</span></li>
</ul>
<p>Since the input number may be large, it is given as a prime factorization.</p>
<h1 id="input">Input</h1>
<p>The first line has an integer <span class="math math-inline">n</span>: the number of parts in the prime factorization.</p>
<p>After this, there are <span class="math math-inline">n</span> lines that describe the factorization. Each line has two numbers <span class="math math-inline">x</span> and <span class="math math-inline">k</span> where <span class="math math-inline">x</span> is a prime and <span class="math math-inline">k</span> is its power.</p>
<h1 id="output">Output</h1>
<p>Print three integers modulo <span class="math math-inline">10^9+7</span>: the number, sum and product of the divisors.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">2 \le x \le 10^6</span></li>
<li>each <span class="math math-inline">x</span> is a distinct prime</li>
<li><span class="math math-inline">1 \le k \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>2
2 2
3 1
</pre>
<p>Output:</p>
<pre>6 28 1728
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem256"></a>
    <h1>Problem 256: Cyclic Array</h1>
    <div class="problem"><div class="content">
<title>CSES - Missing Coin Sum</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2183"/>
<div class="md"><p>You have <span class="math math-inline">n</span> coins with positive integer values. What is the smallest sum you cannot create using a subset of the coins?</p>
<h1 id="input">Input</h1>
<p>The first line has an integer <span class="math math-inline">n</span>: the number of coins.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the value of each coin.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the smallest coin sum.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
2 9 1 2 7
</pre>
<p>Output:</p>
<pre>6
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem257"></a>
    <h1>Problem 257: List of Sums</h1>
    <div class="problem"><div class="content">
<title>CSES - Missing Coin Sum Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2184"/>
<div class="md"><p>You have <span class="math math-inline">n</span> coins with positive integer values. The coins are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>Your task is to process <span class="math math-inline">q</span> queries of the form: "if you can use coins <span class="math math-inline">a \dots b</span>, what is the smallest sum you cannot produce?"</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the number of coins and queries.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the value of each coin.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines that describe the queries. Each line has two values <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: you can use coins <span class="math math-inline">a \dots b</span>.</p>
<h1 id="output">Output</h1>
<p>Print the answer for each query.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n, q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
<li><span class="math math-inline">1 \le a \le b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3
2 9 1 2 7
2 4
4 4
1 5
</pre>
<p>Output:</p>
<pre>4
1
6
</pre>
<p>Explanation: First you can use coins <span class="math math-inline">[9,1,2]</span>, then coins <span class="math math-inline">[2]</span> and finally coins <span class="math math-inline">[2,9,1,2,7]</span>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem258"></a>
    <h1>Problem 258: Increasing Array II</h1>
    <div class="problem"><div class="content">
<title>CSES - Prime Multiples</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2185"/>
<div class="md"><p>You are given <span class="math math-inline">k</span> distinct prime numbers <span class="math math-inline">a_1,a_2,\ldots,a_k</span> and an integer <span class="math math-inline">n</span>.</p>
<p>Your task is to calculate how many of the first <span class="math math-inline">n</span> positive integers are divisible by at least one of the given prime numbers.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">k</span>.</p>
<p>The second line has <span class="math math-inline">k</span> prime numbers <span class="math math-inline">a_1,a_2,\ldots,a_k</span>.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number integers within the interval <span class="math math-inline">1,2,\ldots,n</span> that are divisible by at least one of the prime numbers.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^{18}</span></li>
<li><span class="math math-inline">1 \le k \le 20</span></li>
<li><span class="math math-inline">2 \le a_i \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>20 2
2 5
</pre>
<p>Output:</p>
<pre>12
</pre>
<p>Explanation: the <span class="math math-inline">12</span> numbers are <span class="math math-inline">2,4,5,6,8,10,12,14,15,16,18,20</span>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem259"></a>
    <h1>Problem 259: Food Division</h1>
    <div class="problem"><div class="content">
<title>CSES - Special Substrings</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2186"/>
<div class="md"><p>A substring is called <em>special</em> if every character that appears in the string appears the same number of times in the substring.</p>
<p>Your task is to count the number of special substrings in a given string.</p>
<h1 id="input">Input</h1>
<p>The only input line has a string of length <span class="math math-inline">n</span>. Every character is between a...z.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of special substrings.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>abccabab
</pre>
<p>Output:</p>
<pre>5
</pre>
<p>Explanation: The special substrings are <code>abc</code>, <code>cab</code>, <code>abccab</code>, <code>bccaba</code> and <code>ccabab</code>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem260"></a>
    <h1>Problem 260: Bit Problem</h1>
    <div class="problem"><div class="content">
<title>CSES - Bracket Sequences II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2187"/>
<div class="md"><p>Your task is to calculate the number of valid bracket sequences of length <span class="math math-inline">n</span> when a <em>prefix</em> of the sequence is given.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>.</p>
<p>The second line has a string of <span class="math math-inline">k</span> characters: the prefix of the sequence.</p>
<h1 id="output">Output</h1>
<p>Print the number of sequences modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le k \le n \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>6
(()
</pre>
<p>Output:</p>
<pre>2
</pre>
<p>Explanation: There are two possible sequences: <code>(())()</code> and <code>(()())</code>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem261"></a>
    <h1>Problem 261: Swap Round Sorting</h1>
    <div class="problem"><div class="content">
<title>CSES - Point Location Test</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2189"/>
<div class="md"><p>There is a line that goes through the points <span class="math math-inline">p_1=(x_1,y_1)</span> and <span class="math math-inline">p_2=(x_2,y_2)</span>. There is also a point <span class="math math-inline">p_3=(x_3,y_3)</span>.</p>
<p>Your task is to determine whether <span class="math math-inline">p_3</span> is located on the left or right side of the line or if it touches the line when we are looking from <span class="math math-inline">p_1</span> to <span class="math math-inline">p_2</span>.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">t</span>: the number of tests.</p>
<p>After this, there are <span class="math math-inline">t</span> lines that describe the tests. Each line has six integers: <span class="math math-inline">x_1</span>, <span class="math math-inline">y_1</span>, <span class="math math-inline">x_2</span>, <span class="math math-inline">y_2</span>, <span class="math math-inline">x_3</span> and <span class="math math-inline">y_3</span>.</p>
<h1 id="output">Output</h1>
<p>For each test, print "LEFT", "RIGHT" or "TOUCH".</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le t \le 10^5</span></li>
<li><span class="math math-inline">-10^9 \le x_1, y_1, x_2, y_2, x_3, y_3 \le 10^9</span></li>
<li><span class="math math-inline">x_1 \neq x_2</span> or <span class="math math-inline">y_1 \neq y_2</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
1 1 5 3 2 3
1 1 5 3 4 1
1 1 5 3 3 2
</pre>
<p>Output:</p>
<pre>LEFT
RIGHT
TOUCH
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem262"></a>
    <h1>Problem 262: Binary Subsequences</h1>
    <div class="problem"><div class="content">
<title>CSES - Line Segment Intersection</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2190"/>
<div class="md"><p>There are two line segments: the first goes through the points <span class="math math-inline">(x_1,y_1)</span> and <span class="math math-inline">(x_2,y_2)</span>, and the second goes through the points <span class="math math-inline">(x_3,y_3)</span> and <span class="math math-inline">(x_4,y_4)</span>.</p>
<p>Your task is to determine if the line segments intersect, i.e., they have at least one common point.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">t</span>: the number of tests.</p>
<p>After this, there are <span class="math math-inline">t</span> lines that describe the tests. Each line has eight integers <span class="math math-inline">x_1</span>, <span class="math math-inline">y_1</span>, <span class="math math-inline">x_2</span>, <span class="math math-inline">y_2</span>, <span class="math math-inline">x_3</span>, <span class="math math-inline">y_3</span>, <span class="math math-inline">x_4</span> and <span class="math math-inline">y_4</span>.</p>
<h1 id="output">Output</h1>
<p>For each test, print "YES" if the line segments intersect and "NO" otherwise.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le t \le 10^5</span></li>
<li><span class="math math-inline">-10^9 \le x_1, y_1, x_2, y_2, x_3, y_3, x_4, y_4 \le 10^9</span></li>
<li><span class="math math-inline">(x_1,y_1) \neq (x_2,y_2)</span></li>
<li><span class="math math-inline">(x_3,y_3) \neq (x_4,y_4)</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
1 1 5 3 1 2 4 3
1 1 5 3 1 1 4 3
1 1 5 3 2 3 4 1
1 1 5 3 2 4 4 1
1 1 5 3 3 2 7 4
</pre>
<p>Output:</p>
<pre>NO
YES
YES
YES
YES
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem263"></a>
    <h1>Problem 263: Tree Isomorphism I</h1>
    <div class="problem"><div class="content">
<title>CSES - Polygon Area</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2191"/>
<div class="md"><p>Your task is to calculate the area of a given polygon.</p>
<p>The polygon consists of <span class="math math-inline">n</span> vertices <span class="math math-inline">(x_1,y_1),(x_2,y_2),\dots,(x_n,y_n)</span>. The vertices <span class="math math-inline">(x_i,y_i)</span> and <span class="math math-inline">(x_{i+1},y_{i+1})</span> are adjacent for <span class="math math-inline">i=1,2,\dots,n-1</span>, and the vertices <span class="math math-inline">(x_1,y_1)</span> and <span class="math math-inline">(x_n,y_n)</span> are also adjacent.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of vertices.</p>
<p>After this, there are <span class="math math-inline">n</span> lines that describe the vertices. The <span class="math math-inline">i</span>th such line has two integers <span class="math math-inline">x_i</span> and <span class="math math-inline">y_i</span>.</p>
<p>You may assume that the polygon is simple, i.e., it does not intersect itself.</p>
<h1 id="output">Output</h1>
<p>Print one integer: <span class="math math-inline">2a</span> where the area of the polygon is <span class="math math-inline">a</span> (this ensures that the result is an integer).</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">3 \le n \le 1000</span></li>
<li><span class="math math-inline">-10^9 \le x_i, y_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4
1 1
4 2
3 5
1 4
</pre>
<p>Output:</p>
<pre>16
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem264"></a>
    <h1>Problem 264: Counting Sequences</h1>
    <div class="problem"><div class="content">
<title>CSES - Point in Polygon</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2192"/>
<div class="md"><p>You are given a polygon of <span class="math math-inline">n</span> vertices and a list of <span class="math math-inline">m</span> points. Your task is to determine for each point if it is inside, outside or on the boundary of the polygon.</p>
<p>The polygon consists of <span class="math math-inline">n</span> vertices <span class="math math-inline">(x_1,y_1),(x_2,y_2),\dots,(x_n,y_n)</span>. The vertices <span class="math math-inline">(x_i,y_i)</span> and <span class="math math-inline">(x_{i+1},y_{i+1})</span> are adjacent for <span class="math math-inline">i=1,2,\dots,n-1</span>, and the vertices <span class="math math-inline">(x_1,y_1)</span> and <span class="math math-inline">(x_n,y_n)</span> are also adjacent.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of vertices in the polygon and the number of points.</p>
<p>After this, there are <span class="math math-inline">n</span> lines that describe the polygon. The <span class="math math-inline">i</span>th such line has two integers <span class="math math-inline">x_i</span> and <span class="math math-inline">y_i</span>.</p>
<p>You may assume that the polygon is simple, i.e., it does not intersect itself.</p>
<p>Finally, there are <span class="math math-inline">m</span> lines that describe the points. Each line has two integers <span class="math math-inline">x</span> and <span class="math math-inline">y</span>.</p>
<h1 id="output">Output</h1>
<p>For each point, print "INSIDE", "OUTSIDE" or "BOUNDARY".</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">3 \le n,m \le 1000</span></li>
<li><span class="math math-inline">1 \le m \le 1000</span></li>
<li><span class="math math-inline">-10^9 \le x_i, y_i \le 10^9</span></li>
<li><span class="math math-inline">-10^9 \le x, y \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 3
1 1
4 2
3 5
1 4
2 3
3 1
1 3
</pre>
<p>Output:</p>
<pre>INSIDE
OUTSIDE
BOUNDARY
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem265"></a>
    <h1>Problem 265: Critical Cities</h1>
    <div class="problem"><div class="content">
<title>CSES - Polygon Lattice Points</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2193"/>
<div class="md"><p>Given a polygon, your task is to calculate the number of lattice points inside the polygon and on its boundary. A lattice point is a point whose coordinates are integers.</p>
<p>The polygon consists of <span class="math math-inline">n</span> vertices <span class="math math-inline">(x_1,y_1),(x_2,y_2),\dots,(x_n,y_n)</span>. The vertices <span class="math math-inline">(x_i,y_i)</span> and <span class="math math-inline">(x_{i+1},y_{i+1})</span> are adjacent for <span class="math math-inline">i=1,2,\dots,n-1</span>, and the vertices <span class="math math-inline">(x_1,y_1)</span> and <span class="math math-inline">(x_n,y_n)</span> are also adjacent.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of vertices.</p>
<p>After this, there are <span class="math math-inline">n</span> lines that describe the vertices. The <span class="math math-inline">i</span>th such line has two integers <span class="math math-inline">x_i</span> and <span class="math math-inline">y_i</span>.</p>
<p>You may assume that the polygon is simple, i.e., it does not intersect itself.</p>
<h1 id="output">Output</h1>
<p>Print two integers: the number of lattice points inside the polygon and on its boundary.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">3 \le n \le 10^5</span></li>
<li><span class="math math-inline">-10^9 \le x_i, y_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4
1 1
5 3
3 5
1 4
</pre>
<p>Output:</p>
<pre>6 8
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem266"></a>
    <h1>Problem 266: School Excursion</h1>
    <div class="problem"><div class="content">
<title>CSES - Minimum Euclidean Distance</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2194"/>
<div class="md"><p>Given a set of points in the two-dimensional plane, your task is to find the minimum Euclidean distance between two distinct points.</p>
<p>The Euclidean distance of points <span class="math math-inline">(x_1,y_1)</span> and <span class="math math-inline">(x_2,y_2)</span> is <span class="math math-inline">\sqrt{(x_1-x_2)^2+(y_1-y_2)^2}</span>.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of points.</p>
<p>After this, there are <span class="math math-inline">n</span> lines that describe the points. Each line has two integers <span class="math math-inline">x</span> and <span class="math math-inline">y</span>. You may assume that each point is distinct.</p>
<h1 id="output">Output</h1>
<p>Print one integer: <span class="math math-inline">d^2</span> where <span class="math math-inline">d</span> is the minimum Euclidean distance (this ensures that the result is an integer).</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">2 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">-10^9 \le x,y \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4
2 1
4 4
1 2
6 3
</pre>
<p>Output:</p>
<pre>2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem267"></a>
    <h1>Problem 267: Coin Grid</h1>
    <div class="problem"><div class="content">
<title>CSES - Convex Hull</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2195"/>
<div class="md"><p>Given a set of <span class="math math-inline">n</span> points in the two-dimensional plane, your task is to determine the convex hull of the points.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of points.</p>
<p>After this, there are <span class="math math-inline">n</span> lines that describe the points. Each line has two integers <span class="math math-inline">x</span> and <span class="math math-inline">y</span>: the coordinates of a point.</p>
<p>You may assume that each point is distinct, and the area of the hull is positive.</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math math-inline">k</span>: the number of points in the convex hull.</p>
<p>After this, print <span class="math math-inline">k</span> lines that describe the points. You can print the points in any order. Print all points that lie on the convex hull.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">3 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">-10^9 \le x, y \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>6
2 1
2 5
3 3
4 3
4 4
6 3
</pre>
<p>Output:</p>
<pre>4
2 1
2 5
4 4
6 3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem268"></a>
    <h1>Problem 268: Robot Path</h1>
    <div class="problem"><div class="content">
<title>CSES - Gray Code</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2205"/>
<div class="md"><p>A Gray code is a list of all <span class="math math-inline">2^n</span> bit strings of length <span class="math math-inline">n</span>, where any two successive strings differ in exactly one bit (i.e., their Hamming distance is one).</p>
<p>Your task is to create a Gray code for a given length <span class="math math-inline">n</span>.</p>
<h1 id="input">Input</h1>
<p>The only input line has an integer <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">2^n</span> lines that describe the Gray code. You can print any valid solution.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 16</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>2
</pre>
<p>Output:</p>
<pre>00
01
11
10
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem269"></a>
    <h1>Problem 269: Programmers and Artists</h1>
    <div class="problem"><div class="content">
<title>CSES - Pizzeria Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2206"/>
<div class="md"><p>There are <span class="math math-inline">n</span> buildings on a street, numbered <span class="math math-inline">1,2,\dots,n</span>. Each building has a pizzeria and an apartment.</p>
<p>The pizza price in building <span class="math math-inline">k</span> is <span class="math math-inline">p_k</span>. If you order a pizza from building <span class="math math-inline">a</span> to building <span class="math math-inline">b</span>, its price (with delivery) is <span class="math math-inline">p_a+|a-b|</span>.</p>
<p>Your task is to process two types of queries:</p>
<ol>
<li>The pizza price <span class="math math-inline">p_k</span> in building <span class="math math-inline">k</span> becomes <span class="math math-inline">x</span>.</li>
<li>You are in building <span class="math math-inline">k</span> and want to order a pizza. What is the minimum price?</li>
</ol>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the number of buildings and queries.</p>
<p>The second line has <span class="math math-inline">n</span> integers <span class="math math-inline">p_1,p_2,\dots,p_n</span>: the initial pizza price in each building.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines that describe the queries. Each line is either "1 <span class="math math-inline">k</span> <span class="math math-inline">x</span>" or "2 <span class="math math-inline">k</span>".</p>
<h1 id="output">Output</h1>
<p>Print the answer for each query of type 2.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,q \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le p_i, x \le 10^9</span></li>
<li><span class="math math-inline">1 \le k \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>6 3
8 6 4 5 7 5
2 2
1 5 1
2 2
</pre>
<p>Output:</p>
<pre>5
4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem270"></a>
    <h1>Problem 270: Course Schedule II</h1>
    <div class="problem"><div class="content">
<title>CSES - Grundy's Game</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2207"/>
<div class="md"><p>There is a heap of <span class="math math-inline">n</span> coins and two players who move alternately. On each move, a player chooses a heap and divides into two nonempty heaps that have a different number of coins. The player who makes the last move wins the game.</p>
<p>Your task is to find out who wins if both players play optimally.</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">t</span>: the number of tests.</p>
<p>After this, there are <span class="math math-inline">t</span> lines that describe the tests. Each line has an integer <span class="math math-inline">n</span>: the number of coins in the initial heap.</p>
<h1 id="output">Output</h1>
<p>For each test case, print "first" if the first player wins the game and "second" if the second player wins the game.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le t \le 10^5</span></li>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
6
7
8
</pre>
<p>Output:</p>
<pre>first
second
first
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem271"></a>
    <h1>Problem 271: Removing Digits II</h1>
    <div class="problem"><div class="content">
<title>CSES - Another Game</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2208"/>
<div class="md"><p>There are <span class="math math-inline">n</span> heaps of coins and two players who move alternately. On each move, a player selects some of the nonempty heaps and removes one coin from each heap. The player who removes the last coin wins the game.</p>
<p>Your task is to find out who wins if both players play optimally.</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">t</span>: the number of tests. After this, <span class="math math-inline">t</span> test cases are described:</p>
<p>The first line contains an integer <span class="math math-inline">n</span>: the number of heaps.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\ldots,x_n</span>: the number of coins in each heap.</p>
<h1 id="output">Output</h1>
<p>For each test case, print "first" if the first player wins the game and "second" if the second player wins the game.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le t \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
<li>the sum of all <span class="math math-inline">n</span> is at most <span class="math math-inline">2 \cdot 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
3
1 2 3
2
2 2
4
5 5 4 5
</pre>
<p>Output:</p>
<pre>first
second
first
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem272"></a>
    <h1>Problem 272: Coin Arrangement</h1>
    <div class="problem"><div class="content">
<title>CSES - Counting Necklaces</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2209"/>
<div class="md"><p>Your task is to count the number of different necklaces that consist of <span class="math math-inline">n</span> pearls and each pearl has <span class="math math-inline">m</span> possible colors.</p>
<p>Two necklaces are considered to be different if it is not possible to rotate one of them so that they look the same.</p>
<h1 id="input">Input</h1>
<p>The only input line has two numbers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the number of pearls and colors.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of different necklaces modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,m \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 3
</pre>
<p>Output:</p>
<pre>24
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem273"></a>
    <h1>Problem 273: Counting Bishops</h1>
    <div class="problem"><div class="content">
<title>CSES - Counting Grids</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2210"/>
<div class="md"><p>Your task is to count the number of different <span class="math math-inline">n \times n</span> grids whose each square is black or white.</p>
<p>Two grids are considered to be different if it is not possible to rotate one of them so that they look the same.</p>
<h1 id="input">Input</h1>
<p>The only input line has an integer <span class="math math-inline">n</span>: the size of the grid.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of grids modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4
</pre>
<p>Output:</p>
<pre>16456
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem274"></a>
    <h1>Problem 274: Grid Puzzle I</h1>
    <div class="problem"><div class="content">
<title>CSES - Inverse Inversions</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2214"/>
<div class="md"><p>Your task is to create a permutation of numbers <span class="math math-inline">1,2,\dots,n</span> that has exactly <span class="math math-inline">k</span> inversions.</p>
<p>An inversion is a pair <span class="math math-inline">(a,b)</span> where <span class="math math-inline">a&lt;b</span> and <span class="math math-inline">p_a&gt;p_b</span> where <span class="math math-inline">p_i</span> denotes the number at position <span class="math math-inline">i</span> in the permutation.</p>
<h1 id="input">Input</h1>
<p>The only input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">k</span>.</p>
<h1 id="output">Output</h1>
<p>Print a line that contains the permutation. You can print any valid solution.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
<li><span class="math math-inline">0 \le k \le \frac{n(n-1)}{2}</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 4
</pre>
<p>Output:</p>
<pre>1 5 2 4 3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem275"></a>
    <h1>Problem 275: Grid Puzzle II</h1>
    <div class="problem"><div class="content">
<title>CSES - Monotone Subsequences</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2215"/>
<div class="md"><p>Your task is to create a permutation of numbers <span class="math math-inline">1,2,\dots,n</span> whose longest monotone subsequence has exactly <span class="math math-inline">k</span> elements.</p>
<p>A monotone subsequence is either increasing or decreasing. For example, some monotone subsequences in <span class="math math-inline">[2,1,4,5,3]</span> are <span class="math math-inline">[2,4,5]</span> and <span class="math math-inline">[4,3]</span>.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">t</span>: the number of tests.</p>
<p>After this, there are <span class="math math-inline">t</span> lines. Each line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">k</span>.</p>
<h1 id="output">Output</h1>
<p>For each test, print a line that contains the permutation. You can print any valid solution. If there are no solutions, print <code>IMPOSSIBLE</code>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le t \le 1000</span></li>
<li><span class="math math-inline">1 \le k \le n \le 100</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
5 3
5 2
7 7
</pre>
<p>Output:</p>
<pre>2 1 4 5 3
IMPOSSIBLE
1 2 3 4 5 6 7
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem276"></a>
    <h1>Problem 276: Empty String</h1>
    <div class="problem"><div class="content">
<title>CSES - Collecting Numbers</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2216"/>
<div class="md"><p>You are given an array that contains each number between <span class="math math-inline">1 \dots n</span> exactly once. Your task is to collect the numbers from <span class="math math-inline">1</span> to <span class="math math-inline">n</span> in increasing order.</p>
<p>On each round, you go through the array from left to right and collect as many numbers as possible. What will be the total number of rounds?</p>
<h1 id="input">Input</h1>
<p>The first line has an integer <span class="math math-inline">n</span>: the array size.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the numbers in the array.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of rounds.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
4 2 1 5 3
</pre>
<p>Output:</p>
<pre>3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem277"></a>
    <h1>Problem 277: Grid Paths</h1>
    <div class="problem"><div class="content">
<title>CSES - Collecting Numbers II</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2217"/>
<div class="md"><p>You are given an array that contains each number between <span class="math math-inline">1 \dots n</span> exactly once. Your task is to collect the numbers from <span class="math math-inline">1</span> to <span class="math math-inline">n</span> in increasing order.</p>
<p>On each round, you go through the array from left to right and collect as many numbers as possible.</p>
<p>Given <span class="math math-inline">m</span> operations that swap two numbers in the array, your task is to report the number of rounds after each operation.</p>
<h1 id="input">Input</h1>
<p>The first line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the array size and the number of operations.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the numbers in the array.</p>
<p>Finally, there are <span class="math math-inline">m</span> lines that describe the operations. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: the numbers at positions <span class="math math-inline">a</span> and <span class="math math-inline">b</span> are swapped.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">m</span> integers: the number of rounds after each swap.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n, m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a,b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3
4 2 1 5 3
2 3
1 5
2 3
</pre>
<p>Output:</p>
<pre>2
3
4
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem278"></a>
    <h1>Problem 278: Bit Substrings</h1>
    <div class="problem"><div class="content">
<title>CSES - Counting Numbers</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2220"/>
<div class="md"><p>Your task is to count the number of integers between <span class="math math-inline">a</span> and <span class="math math-inline">b</span> where no two adjacent digits are the same.</p>
<h1 id="input">Input</h1>
<p>The only input line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the answer to the problem.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">0 \le a \le b \le 10^{18}</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>123 321
</pre>
<p>Output:</p>
<pre>171
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem279"></a>
    <h1>Problem 279: Reversal Sorting</h1>
    <div class="problem"><div class="content">
<title>CSES - Counting Sequences</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2228"/>
<div class="md"><p>Your task is to count the number of sequences of length <span class="math math-inline">n</span> where each element is an integer between <span class="math math-inline">1 \dots k</span> and each integer between <span class="math math-inline">1 \dots k</span> appears at least once in the sequence.</p>
<p>For example, when <span class="math math-inline">n=6</span> and <span class="math math-inline">k=4</span>, some valid sequences are <span class="math math-inline">[1,3,1,4,3,2]</span> and <span class="math math-inline">[2,2,1,3,4,2]</span>.</p>
<h1 id="input">Input</h1>
<p>The only input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">k</span>.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of sequences modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le k \le n \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>6 4
</pre>
<p>Output:</p>
<pre>1560
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem280"></a>
    <h1>Problem 280: Counting Reorders</h1>
    <div class="problem"><div class="content">
<title>CSES - Permutation Inversions</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2229"/>
<div class="md"><p>Your task is to count the number of permutations of <span class="math math-inline">1,2,\dots,n</span> that have exactly <span class="math math-inline">k</span> inversions (i.e., pairs of elements in the wrong order).</p>
<p>For example, when <span class="math math-inline">n=4</span> and <span class="math math-inline">k=3</span>, there are <span class="math math-inline">6</span> such permutations:</p>
<ul>
<li><span class="math math-inline">[1,4,3,2]</span></li>
<li><span class="math math-inline">[2,3,4,1]</span></li>
<li><span class="math math-inline">[2,4,1,3]</span></li>
<li><span class="math math-inline">[3,1,4,2]</span></li>
<li><span class="math math-inline">[3,2,1,4]</span></li>
<li><span class="math math-inline">[4,1,2,3]</span></li>
</ul>
<h1 id="input">Input</h1>
<p>The only input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">k</span>.</p>
<h1 id="output">Output</h1>
<p>Print the answer modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 500</span></li>
<li><span class="math math-inline">0 \le k \le \frac{n(n-1)}{2}</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4 3
</pre>
<p>Output:</p>
<pre>6
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem281"></a>
    <h1>Problem 281: Book Shop II</h1>
    <div class="problem"><div class="content">
<title>CSES - Two Stacks Sorting</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2402"/>
<div class="md"><p>You are given an input list that consists of <span class="math math-inline">n</span> numbers. Each integer between <span class="math math-inline">1</span> and <span class="math math-inline">n</span> appears exactly once in the list.</p>
<p>Your task is to create a sorted output list using two stacks. On each move you can do one of the following:</p>
<ul>
<li>Move the first number from the input list to a stack</li>
<li>Move a number from a stack to the end of the output list</li>
</ul>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>.</p>
<p>The second line has <span class="math math-inline">n</span> integers: the contents of the input list.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">n</span> integers: for each number the stack where it is moved (<span class="math math-inline">1</span> or <span class="math math-inline">2</span>).</p>
<p>You can print any valid solution. If there are no solutions, print <code>IMPOSSIBLE</code>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
2 3 1 5 4
</pre>
<p>Output:</p>
<pre>1 2 1 1 2
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem282"></a>
    <h1>Problem 282: Network Breakdown</h1>
    <div class="problem"><div class="content">
<title>CSES - Counting Towers</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2413"/>
<div class="md"><p>Your task is to build a tower whose width is <span class="math math-inline">2</span> and height is <span class="math math-inline">n</span>. You have an unlimited supply of blocks whose width and height are integers.</p>
<p>For example, here are some possible solutions for <span class="math math-inline">n=6</span>:
<center><img alt="" class="invertible" height="" src="/file/a2fc04205fb57157bd28c9a6041601fc284681929941470fdfb15fcd4a14b4f2" width="300"/></center>
Given <span class="math math-inline">n</span>, how many different towers can you build? Mirrored and rotated towers are counted separately if they look different.</p>
<h1 id="input">Input</h1>
<p>The first input line contains an integer <span class="math math-inline">t</span>: the number of tests.</p>
<p>After this, there are <span class="math math-inline">t</span> lines, and each line contains an integer <span class="math math-inline">n</span>: the height of the tower.</p>
<h1 id="output">Output</h1>
<p>For each test, print the number of towers modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le t \le 100</span></li>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
2
6
1337
</pre>
<p>Output:</p>
<pre>8
2864
640403945
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem283"></a>
    <h1>Problem 283: Visiting Cities</h1>
    <div class="problem"><div class="content">
<title>CSES - List of Sums</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2414"/>
<div class="md"><p>List <span class="math math-inline">A</span> consists of <span class="math math-inline">n</span> positive integers, and list <span class="math math-inline">B</span> contains the sum of each element pair of list <span class="math math-inline">A</span>.</p>
<p>For example, if <span class="math math-inline">A=[1,2,3]</span>, then <span class="math math-inline">B=[3,4,5]</span>, and if <span class="math math-inline">A=[1,3,3,3]</span>, then <span class="math math-inline">B=[4,4,4,6,6,6]</span>.</p>
<p>Given list <span class="math math-inline">B</span>, your task is to reconstruct list <span class="math math-inline">A</span>.</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the size of list <span class="math math-inline">A</span>.</p>
<p>The next line has <span class="math math-inline">\frac{n(n-1)}{2}</span> integers: the contents of list <span class="math math-inline">B</span>.</p>
<p>You can assume that there is a list <span class="math math-inline">A</span> that corresponds to the input, and each value in <span class="math math-inline">A</span> is between <span class="math math-inline">1 \dots k</span>.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">n</span> integers: the contents of list <span class="math math-inline">A</span>.</p>
<p>You can print the values in any order. If there are more than one solution, you can print any of them.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">3 \le n \le 100</span></li>
<li><span class="math math-inline">1 \le k \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>4
4 4 4 6 6 6
</pre>
<p>Output:</p>
<pre>1 3 3 3
</pre>
<p>Explanation: In this case list <span class="math math-inline">A</span> can be either <span class="math math-inline">[1,3,3,3]</span> or <span class="math math-inline">[2,2,2,4]</span> and both solutions are accepted.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem284"></a>
    <h1>Problem 284: Missing Coin Sum Queries</h1>
    <div class="problem"><div class="content">
<title>CSES - Functional Graph Distribution</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2415"/>
<div class="md"><p>A <em>functional graph</em> is a directed graph where each node has outdegree <span class="math math-inline">1</span>. For example, here is a functional graph that has <span class="math math-inline">9</span> nodes and <span class="math math-inline">2</span> components:
<center><img alt="" class="invertible" height="" src="/file/39a5e727e368197cdce7593736c5cfd1abf75b6439c0823e27c671ff10662377" width="300"/></center>
Given <span class="math math-inline">n</span>, your task is to calculate for each <span class="math math-inline">k=1 \dots n</span> the number of functional graphs that have <span class="math math-inline">n</span> nodes and <span class="math math-inline">k</span> components.</p>
<h1 id="input">Input</h1>
<p>The only input line has an integer <span class="math math-inline">n</span>: the number of nodes.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">n</span> lines: for each <span class="math math-inline">k=1 \dots n</span> the number of graphs modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 5000</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
</pre>
<p>Output:</p>
<pre>17
9
1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem285"></a>
    <h1>Problem 285: Number Grid</h1>
    <div class="problem"><div class="content">
<title>CSES - Increasing Array Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2416"/>
<div class="md"><p>You are given an array that consists of <span class="math math-inline">n</span> integers. The array elements are indexed <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>You can modify the array using the following operation: choose an array element and increase its value by one.</p>
<p>Your task is to process <span class="math math-inline">q</span> queries of the form: when we consider a subarray from position <span class="math math-inline">a</span> to position <span class="math math-inline">b</span>, what is the minimum number of operations after which the subarray is increasing?</p>
<p>An array is increasing if each element is greater than or equal with the previous element.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">q</span>: the size of the array and the number of queries.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the contents of the array.</p>
<p>Finally, there are <span class="math math-inline">q</span> lines that describe the queries. Each line has two integers <span class="math math-inline">a</span> and <span class="math math-inline">b</span>: the starting and ending position of a subarray.</p>
<h1 id="output">Output</h1>
<p>For each query, print the minimum number of operations.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n,q \le 2\cdot10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
<li><span class="math math-inline">1 \le a \le b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 3
2 10 4 2 5
3 5
2 2
1 4
</pre>
<p>Output:</p>
<pre>2
0
14
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem286"></a>
    <h1>Problem 286: Maximum Building II</h1>
    <div class="problem"><div class="content">
<title>CSES - Counting Coprime Pairs</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2417"/>
<div class="md"><p>Given a list of <span class="math math-inline">n</span> positive integers, your task is to count the number of pairs of integers that are coprime (i.e., their greatest common divisor is one).</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of elements.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the contents of the list.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the answer for the task.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8
5 4 20 1 16 17 5 15
</pre>
<p>Output:</p>
<pre>19
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem287"></a>
    <h1>Problem 287: Filling Trominos</h1>
    <div class="problem"><div class="content">
<title>CSES - Grid Path Construction</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2418"/>
<div class="md"><p>Given an <span class="math math-inline">n \times m</span> grid and two squares <span class="math math-inline">a=(y_1,x_1)</span> and <span class="math math-inline">b=(y_2,x_2)</span>, create a path from <span class="math math-inline">a</span> to <span class="math math-inline">b</span> that visits each square exactly once.</p>
<p>For example, here is a path from <span class="math math-inline">a=(1,3)</span> to <span class="math math-inline">b=(3,6)</span> in a <span class="math math-inline">4 \times 7</span> grid:
<center><img alt="" class="invertible" src="/file/944079e41a17eca6debb54a7d4da8f9124232206a1d80256432e8a2715c00055"/></center></p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">t</span>: the number of tests.</p>
<p>After this, there are <span class="math math-inline">t</span> lines that describe the tests. Each line has six integers <span class="math math-inline">n</span>, <span class="math math-inline">m</span>, <span class="math math-inline">y_1</span>, <span class="math math-inline">x_1</span>, <span class="math math-inline">y_2</span> and <span class="math math-inline">x_2</span>.</p>
<p>In all tests <span class="math math-inline">1 \le y_1,y_2 \le n</span> and <span class="math math-inline">1 \le x_1,x_2 \le m</span>. In addition, <span class="math math-inline">y_1 \neq y_2</span> or <span class="math math-inline">x_1 \neq x_2</span>.</p>
<h1 id="output">Output</h1>
<p>Print YES, if it is possible to construct a path, and NO otherwise.</p>
<p>If there is a path, also print its description which consists of characters <code>U</code> (up), <code>D</code> (down), <code>L</code> (left) and <code>R</code> (right). If there are several paths, you can print any of them.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le t \le 100</span></li>
<li><span class="math math-inline">1 \le n \le 50</span></li>
<li><span class="math math-inline">1 \le m \le 50</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
1 3 1 1 1 3
1 3 1 2 1 3
2 2 1 1 2 2
2 2 1 1 2 1
4 7 1 3 3 6
</pre>
<p>Output:</p>
<pre>YES
RR
NO
NO
YES
RDL
YES
RRRRDDDLLLLLLUUURDDRURDRURD
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem288"></a>
    <h1>Problem 288: Stick Divisions</h1>
    <div class="problem"><div class="content">
<title>CSES - Xor Pyramid</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2419"/>
<div class="md"><p>Consider a xor pyramid where each number is the xor of lower-left and lower-right numbers. Here is an example pyramid:
<center><img alt="" class="invertible" height="" src="/file/382652cc16953396bbaeeabf0e98daec74a4bda09afb8db8da0e67870205fc76" width="250"/></center>
Given the bottom row of the pyramid, your task is to find the topmost number.</p>
<h1 id="input">Input</h1>
<p>The first line has an integer <span class="math math-inline">n</span>: the size of the pyramid.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">a_1,a_2,\dots,a_n</span>: the bottom row of the pyramid.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the topmost number.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le a_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>8
2 10 5 12 9 5 1 5
</pre>
<p>Output:</p>
<pre>9
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem289"></a>
    <h1>Problem 289: Coding Company</h1>
    <div class="problem"><div class="content">
<title>CSES - Palindrome Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2420"/>
<div class="md"><p>You are given a string that consists of <span class="math math-inline">n</span> characters between a–z. The positions of the string are indexed <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>Your task is to process <span class="math math-inline">m</span> operations of the following types:</p>
<ol>
<li>Change the character at position <span class="math math-inline">k</span> to <span class="math math-inline">x</span></li>
<li>Check if the substring from position <span class="math math-inline">a</span> to position <span class="math math-inline">b</span> is a palindrome</li>
</ol>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>: the length of the string and the number of operations.</p>
<p>The next line has a string that consists of <span class="math math-inline">n</span> characters.</p>
<p>Finally, there are <span class="math math-inline">m</span> lines that describe the operations. Each line is of the form "1 <span class="math math-inline">k</span> <span class="math math-inline">x</span>" or "2 <span class="math math-inline">a</span> <span class="math math-inline">b</span>".</p>
<h1 id="output">Output</h1>
<p>For each operation 2, print YES if the substring is a palindrome and NO otherwise.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n, m \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le k \le n</span></li>
<li><span class="math math-inline">1 \le a \le b \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>7 5
aybabtu
2 3 5
1 3 x
2 3 5
1 5 x
2 3 5
</pre>
<p>Output:</p>
<pre>YES
NO
YES
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem290"></a>
    <h1>Problem 290: Flight Route Requests</h1>
    <div class="problem"><div class="content">
<title>CSES - Counting Reorders</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2421"/>
<div class="md"><p>Calculate the number of ways you can reorder the characters of a string so that no two adjacent characters are the same.</p>
<p>For example, the answer for <code>aabc</code> is <span class="math math-inline">6</span>, because the possible orders are <code>abac</code>, <code>abca</code>, <code>acab</code>, <code>acba</code>, <code>baca</code>, and <code>caba</code>.</p>
<h1 id="input">Input</h1>
<p>The only input line has a string that consists of <span class="math math-inline">n</span> characters between <code>a</code>–<code>z</code>.</p>
<h1 id="output">Output</h1>
<p>Print an integer: the answer modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 5000</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>aabc
</pre>
<p>Output:</p>
<pre>6
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem291"></a>
    <h1>Problem 291: Two Stacks Sorting</h1>
    <div class="problem"><div class="content">
<title>CSES - Multiplication Table</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2422"/>
<div class="md"><p>Find the middle element when the numbers in an <span class="math math-inline">n \times n</span> multiplication table are sorted in increasing order. It is assumed that <span class="math math-inline">n</span> is odd.</p>
<p>For example, the <span class="math math-inline">3 \times 3</span> multiplication table is as follows:
<span class="math math-display">
\begin{matrix}
1 &amp; 2 &amp; 3 \\
2 &amp; 4 &amp; 6 \\
3 &amp; 6 &amp; 9 \\
\end{matrix}
</span>
The numbers in increasing order are <span class="math math-inline">[1,2,2,3,3,4,6,6,9]</span>, so the answer is <span class="math math-inline">3</span>.</p>
<h1 id="input">Input</h1>
<p>The only input line has an integer <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the answer to the task.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n &lt; 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
</pre>
<p>Output:</p>
<pre>3
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem292"></a>
    <h1>Problem 292: Tree Isomorphism II</h1>
    <div class="problem"><div class="content">
<title>CSES - Filling Trominos</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2423"/>
<div class="md"><p>Your task is to fill an <span class="math math-inline">n \times m</span> grid using L-trominos (three squares that have an L-shape). For example, here is one way to fill a <span class="math math-inline">4 \times 6</span> grid:
<center><img alt="" class="invertible" src="/file/da3ce928fcf66fd793d582a1a5ad7f7f9cc37e68aa2aadacee90f99bc4271692"/></center></p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">t</span>: the number of tests.</p>
<p>After that, there are <span class="math math-inline">t</span> lines that describe the tests. Each line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">m</span>.</p>
<h1 id="output">Output</h1>
<p>For each test, print YES if there is a solution, and NO otherwise.</p>
<p>If there is a solution, also print <span class="math math-inline">n</span> lines that each contain <span class="math math-inline">m</span> letters between A–Z. Adjacent squares must have the same letter exactly when they belong to the same tromino. You can print any valid solution.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le t \le 100</span></li>
<li><span class="math math-inline">1 \le n,m \le 100</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>2
4 6
4 7
</pre>
<p>Output:</p>
<pre>YES
AADDBB
ACCDEB
BCAEEC
BBAACC
NO
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem293"></a>
    <h1>Problem 293: Forbidden Cities</h1>
    <div class="problem"><div class="content">
<title>CSES - Stack Weights</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2425"/>
<div class="md"><p>You have <span class="math math-inline">n</span> coins, each of which has a distinct weight.</p>
<p>There are two stacks which are initially empty. On each step you move one coin to a stack. You never remove a coin from a stack.</p>
<p>After each move, your task is to determine which stack is heavier (if we can be sure that either stack is heavier).</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the number of coins. The coins are numbered <span class="math math-inline">1,2,\dots,n</span>. You know that coin <span class="math math-inline">i</span> is always heavier than coin <span class="math math-inline">i-1</span>, but you don't know their exact weights.</p>
<p>After this, there are <span class="math math-inline">n</span> lines that describe the moves. Each line has two integers <span class="math math-inline">c</span> and <span class="math math-inline">s</span>: move coin <span class="math math-inline">c</span> to stack <span class="math math-inline">s</span> (1 = left, 2 = right).</p>
<h1 id="output">Output</h1>
<p>After each move, print <code>&lt;</code> if the right stack is heavier, <code>&gt;</code> if the left stack is heavier, and <code>?</code> if we can't know which stack is heavier.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
2 1
3 2
1 1
</pre>
<p>Output:</p>
<pre>&gt;
&lt;
?
</pre>
<p>Explanation: After the last move, if the coins are <span class="math math-inline">[2,3,4]</span>, the left stack is heavier, but if the coins are <span class="math math-inline">[1,2,5]</span>, the right stack is heavier.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem294"></a>
    <h1>Problem 294: Area of Rectangles</h1>
    <div class="problem"><div class="content">
<title>CSES - Programmers and Artists</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2426"/>
<div class="md"><p>A company wants to hire <span class="math math-inline">a</span> programmers and <span class="math math-inline">b</span> artists.</p>
<p>There are a total of <span class="math math-inline">n</span> applicants, and each applicant can become either a programmer or an artist. You know each applicant's programming and artistic skills.</p>
<p>Your task is to select the new employees so that the sum of their skills is maximum.</p>
<h1 id="input">Input</h1>
<p>The first input line has three integers <span class="math math-inline">a</span>, <span class="math math-inline">b</span> and <span class="math math-inline">n</span>: the required number of programmers and artists, and the total number of applicants.</p>
<p>After this, there are <span class="math math-inline">n</span> lines that describe the applicants. Each line has two integers <span class="math math-inline">x</span> and <span class="math math-inline">y</span>: the applicant's programming and artistic skills.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the maximum sum of skills.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">0 \le a,b \le n</span></li>
<li><span class="math math-inline">a+b \le n</span></li>
<li><span class="math math-inline">1 \le x,y \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>2 1 4
3 7
9 8
1 5
4 2
</pre>
<p>Output:</p>
<pre>20
</pre>
<p>Explanation: An optimal solution is to hire two programmers with skills <span class="math math-inline">9</span> and <span class="math math-inline">4</span> and one artist with skill <span class="math math-inline">7</span>. The sum of the skills is <span class="math math-inline">9+4+7=20</span>.</p>
</div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem295"></a>
    <h1>Problem 295: Grid Completion</h1>
    <div class="problem"><div class="content">
<title>CSES - Letter Pair Move Game</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2427"/>
<div class="md"><p>There are <span class="math math-inline">2n</span> boxes in a line. Two adjacent boxes are empty, and all other boxes have a letter "A" or "B". Both letters appear in exactly <span class="math math-inline">n-1</span> boxes.</p>
<p>Your task is to move the letters so that all letters "A" appear before any letter "B". On each turn you can choose any two adjacent boxes that have a letter and move the letters to the two adjacent empty boxes, preserving their order.</p>
<p>It can be proven that either there is a solution that consists of at most <span class="math math-inline">10n</span> turns or there are no solutions.</p>
<h1 id="input">Input</h1>
<p>The first line has an integer <span class="math math-inline">n</span>: there are <span class="math math-inline">2n</span> boxes.</p>
<p>The second line has a string of <span class="math math-inline">2n</span> characters which describes the starting position. Each character is "A", "B" or "." (empty box).</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math math-inline">k</span>: the number of turns. After this, print <span class="math math-inline">k</span> lines that describe the moves. You can print any solution, as long as <span class="math math-inline">k \le 1000</span>.</p>
<p>If there are no solutions, print only "-1".</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 100</span></li>
</ul>
<h1 id="example1">Example 1</h1>
<p>Input:</p>
<pre>3
AB..BA
</pre>
<p>Output:</p>
<pre>2
ABBA..
A..ABB
</pre><h1 id="example2">Example 2</h1>
<p>Input:</p>
<pre>3
ABAB..
</pre>
<p>Output:</p>
<pre>-1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem296"></a>
    <h1>Problem 296: Creating Offices</h1>
    <div class="problem"><div class="content">
<title>CSES - Subarray Distinct Values</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2428"/>
<div class="md"><p>Given an array of <span class="math math-inline">n</span> integers, your task is to calculate the number of subarrays that have at most <span class="math math-inline">k</span> distinct values.</p>
<h1 id="input">Input</h1>
<p>The first input line has two integers <span class="math math-inline">n</span> and <span class="math math-inline">k</span>.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">x_1,x_2,\dots,x_n</span>: the contents of the array.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of subarrays.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le k \le n \le 2 \cdot 10^5</span></li>
<li><span class="math math-inline">1 \le x_i \le 10^9</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5 2
1 2 3 1 1
</pre>
<p>Output:</p>
<pre>10
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem297"></a>
    <h1>Problem 297: Permutations II</h1>
    <div class="problem"><div class="content">
<title>CSES - Grid Completion</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2429"/>
<div class="md"><p>Your task is to create an <span class="math math-inline">n \times n</span> grid whose each row and column has exactly one A and B. Some of the characters have already been placed. In how many ways can you complete the grid?</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the size of the grid.</p>
<p>After this, there are <span class="math math-inline">n</span> lines that describe the grid. Each line has <span class="math math-inline">n</span> characters: <code>.</code> means an empty square, and <code>A</code> and <code>B</code> show the characters already placed.</p>
<p>You can assume that every row and column has at most one A and B.</p>
<h1 id="output">Output</h1>
<p>Print one integer: the number of ways modulo <span class="math math-inline">10^9+7</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">2 \le n \le 500</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
.....
..AB.
.....
B....
...A.
</pre>
<p>Output:</p>
<pre>16
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem298"></a>
    <h1>Problem 298: Functional Graph Distribution</h1>
    <div class="problem"><div class="content">
<title>CSES - Binary Subsequences</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2430"/>
<div class="md"><p>Your task is to find a minimum length bit string that has exactly <span class="math math-inline">n</span> distinct subsequences.</p>
<p>For example, a correct solution for <span class="math math-inline">n=6</span> is <code>101</code> whose distinct subsequences are <code>0</code>, <code>1</code>, <code>01</code>, <code>10</code>, <code>11</code> and <code>101</code>.</p>
<h1 id="input">Input</h1>
<p>The only input line has an integer <span class="math math-inline">n</span>.</p>
<h1 id="output">Output</h1>
<p>Print one bit string: a solution to the task. You can print any valid solution.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 10^6</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>6
</pre>
<p>Output:</p>
<pre>101
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem299"></a>
    <h1>Problem 299: New Flight Routes</h1>
    <div class="problem"><div class="content">
<title>CSES - Digit Queries</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2431"/>
<div class="md"><p>Consider an infinite string that consists of all positive integers in increasing order:</p>
<p>12345678910111213141516171819202122232425...</p>
<p>Your task is to process <span class="math math-inline">q</span> queries of the form: what is the digit at position <span class="math math-inline">k</span> in the string?</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">q</span>: the number of queries.</p>
<p>After this, there are <span class="math math-inline">q</span> lines that describe the queries. Each line has an integer <span class="math math-inline">k</span>: a <span class="math math-inline">1</span>-indexed position in the string.</p>
<h1 id="output">Output</h1>
<p>For each query, print the corresponding digit.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le q \le 1000</span></li>
<li><span class="math math-inline">1 \le k \le 10^{18}</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>3
7
19
12
</pre>
<p>Output:</p>
<pre>7
4
1
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
    <a name="problem300"></a>
    <h1>Problem 300: Grid Path Construction</h1>
    <div class="problem"><div class="content">
<title>CSES - Grid Puzzle I</title><link href="/lib/katex/katex.min.css" rel="stylesheet"/>
<script defer="" src="/lib/katex/katex.min.js"></script>
<script defer="" src="/lib/katex/contrib/copy-tex.min.js"></script>
<script defer="" src="/lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("math-display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input name="course" type="hidden" value="problemset"/>
<input name="task" type="hidden" value="2432"/>
<div class="md"><p>There is an <span class="math math-inline">n \times n</span> grid, and your task is to choose from each row and column some number of squares. How can you do that?</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math math-inline">n</span>: the size of the grid. The rows and columns are numbered <span class="math math-inline">1,2,\dots,n</span>.</p>
<p>The next line has <span class="math math-inline">n</span> integers <span class="math math-inline">a_1,a_2,\ldots,a_n</span>: You must choose exactly <span class="math math-inline">a_i</span> squares from the <span class="math math-inline">i</span>th row.</p>
<p>The las line has <span class="math math-inline">n</span> integers <span class="math math-inline">b_1,b_2,\ldots,b_n</span>: You must choose exactly <span class="math math-inline">b_j</span> squares from the <span class="math math-inline">j</span>th column.</p>
<h1 id="output">Output</h1>
<p>Print <span class="math math-inline">n</span> lines describing which squares you choose (<code>X</code> means that you choose a square, <code>.</code> means that you don't choose it). You can print any valid solution.</p>
<p>If it is not possible to satisfy the conditions print only <span class="math math-inline">-1</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math math-inline">1 \le n \le 50</span></li>
<li><span class="math math-inline">0 \le a_i \le n</span></li>
<li><span class="math math-inline">0 \le b_j \le n</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
0 1 3 2 0
1 2 2 0 1
</pre>
<p>Output:</p>
<pre>.....
..X..
.XX.X
XX...
.....
</pre></div> </div></div>

    <p class="solution-space">(Write your solution here...)</p>

    <!-- Blank back page -->
    <div class="blank-page"></div>
    <div style="page-break-after: always;"></div>
    
</body>
</html>
